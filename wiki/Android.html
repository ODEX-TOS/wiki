<!--
    title: Android
    description: Migration of Android from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:58:55.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Android</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../wiki/Android_tethering.html" title="Android tethering">Android tethering</a></li>
<li><a href="../wiki/Android_Debug_Bridge.html" title="Android Debug Bridge">Android Debug Bridge</a></li>
</ul>
</div>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Transferring_files"><span >1</span> <span >Transferring files</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#App_development"><span >2</span> <span >App development</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Android_Studio"><span >2.1</span> <span >Android Studio</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#SDK_packages"><span >2.2</span> <span >SDK packages</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Android_Emulator"><span >2.2.1</span> <span >Android Emulator</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Other_SDK_packages_in_the_AUR"><span >2.2.2</span> <span >Other SDK packages in the AUR</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Making_/opt/android-sdk_group-writeable"><span >2.2.3</span> <span >Making /opt/android-sdk group-writeable</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8">
<a href="#Other_IDEs"><span >2.3</span> <span >Other IDEs</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#Netbeans"><span >2.3.1</span> <span >Netbeans</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10">
<a href="#Other_Tools"><span >2.4</span> <span >Other Tools</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="#Marvin"><span >2.4.1</span> <span >Marvin</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Building"><span >3</span> <span >Building</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Required_packages"><span >3.1</span> <span >Required packages</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Java_Development_Kit"><span >3.2</span> <span >Java Development Kit</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Setting_up_the_build_environment"><span >3.3</span> <span >Setting up the build environment</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Downloading_the_source_code"><span >3.4</span> <span >Downloading the source code</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Building_the_code"><span >3.5</span> <span >Building the code</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Testing_the_build"><span >3.6</span> <span >Testing the build</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Creating_a_flashable_Image"><span >3.7</span> <span >Creating a flashable Image</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20">
<a href="#Flashing"><span >4</span> <span >Flashing</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#Fastboot"><span >4.1</span> <span >Fastboot</span></a></li>
<li class="toclevel-2 tocsection-22">
<a href="#Samsung_devices"><span >4.2</span> <span >Samsung devices</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#Heimdall"><span >4.2.1</span> <span >Heimdall</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Odin_(Virtualbox)"><span >4.2.2</span> <span >Odin (Virtualbox)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-25">
<a href="#Troubleshooting"><span >5</span> <span >Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#Android_Studio:_Android_Virtual_Devices_show_'failed_to_load'."><span >5.1</span> <span >Android Studio: Android Virtual Devices show 'failed to load'.</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Android_Studio:_'failed_to_create_the_SD_card'"><span >5.2</span> <span >Android Studio: 'failed to create the SD card'</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Eclipse:_During_Debugging_%22Source_not_found%22"><span >5.3</span> <span >Eclipse: During Debugging "Source not found"</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#ValueError:_unsupported_pickle_protocol"><span >5.4</span> <span >ValueError: unsupported pickle protocol</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#libGL_error:_failed_to_load_driver:_swrast_OR_AVD_doesn't_load_and_no_error_message_displayed"><span >5.5</span> <span >libGL error: failed to load driver: swrast OR AVD doesn't load and no error message displayed</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#sh:_glxinfo:_command_not_found"><span >5.6</span> <span >sh: glxinfo: command not found</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Android_Emulator:_no_keyboard_input_in_xfwm4"><span >5.7</span> <span >Android Emulator: no keyboard input in xfwm4</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Android_Emulator:_Segmentation_fault_(core_dumped)"><span >5.8</span> <span >Android Emulator: Segmentation fault (core dumped)</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#adb:_sideload_connection_failed:_insufficient_permissions_for_device"><span >5.9</span> <span >adb: sideload connection failed: insufficient permissions for device</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Transferring_files">Transferring files</span></h2>
<p>There are various ways to transfer files between a computer and an Android device:
</p>
<ul>
<li>USB cable
<ul>
<li>
<a href="../wiki/Media_Transfer_Protocol.html" title="Media Transfer Protocol">Media Transfer Protocol</a> for modern Android devices</li>
<li>
<a href="https://en.wikipedia.org/wiki/USB_Mass_Storage"  title="wikipedia:USB Mass Storage">USB mass storage</a> for older devices</li>
<li><a href="../wiki/Android_Debug_Bridge.html" title="Android Debug Bridge">Android Debug Bridge</a></li>
</ul>
</li>
<li>special USB sticks / regular USB stick with adapter</li>
<li><a href="../wiki/Bluetooth.html" title="Bluetooth">Bluetooth</a></li>
<li>TOS Linux software with Android counterparts
<ul>
<li>client or server for protocols that can be used to transfer files (eg. <a href="../wiki/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a>, <a href="../wiki/Category:File_Transfer_Protocol.html" class="mw-redirect" title="FTP">FTP</a>, <a href="../wiki/Samba.html" title="Samba">Samba</a> or HTTP)</li>
<li>
<a href="../wiki/KDE.html#KDE_Connect" class="mw-redirect" title="KDE Connect">KDE Connect</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=kdeconnect">kdeconnect</a></span>) – integrates your Android device with the KDE desktop (featuring synced notifications &amp; clipboard, multimedia control, and file/URL sharing).</li>
<li><a href="../wiki/List_of_applications/Internet.html#Cloud_synchronization_clients" class="mw-redirect" title="Cloud synchronization clients">cloud synchronization clients</a></li>
<li><a href="../wiki/Syncthing.html" title="Syncthing">Syncthing</a></li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/sendanywhere/">sendanywhere</a></span><sup><small>AUR</small></sup> – cross-platform file sharing</li>
</ul>
</li>
</ul>
<h2><span class="mw-headline" id="App_development">App development</span></h2>
<p>The officially supported way to build Android apps is to use <a href="#Android_Studio">#Android Studio</a>.<a rel="nofollow"  href="https://developer.android.com/training/basics/firstapp/creating-project">[1]</a>
</p>
<h3><span class="mw-headline" id="Android_Studio">Android Studio</span></h3>
<p><a rel="nofollow"  href="https://developer.android.com/studio/index.html">Android Studio</a> is the official Android development environment based on <a href="https://en.wikipedia.org/wiki/IntelliJ_IDEA"  title="wikipedia:IntelliJ IDEA">IntelliJ IDEA</a>. It provides integrated Android developer tools for development and debugging.
</p>
<p>You can <a href="../wiki/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> it with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-studio/">android-studio</a></span><sup><small>AUR</small></sup> package.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Make sure you properly <a href="../wiki/Java.html#Change_default_Java_environment" title="Java">set the Java environment</a> otherwise android-studio will not start.</li>
<li>If Android Studio shows up as a blank window try <a href="../wiki/Environment_variables.html" class="mw-redirect" title="Export">exporting</a> <code>_JAVA_AWT_WM_NONREPARENTING=1</code>, see <a rel="nofollow"  href="https://code.google.com/p/android/issues/detail?id=57675">issue #57675</a>.</li>
</ul>
</div>
<p>The Android Studio Setup Wizard installs the required <a href="#SDK_packages">#SDK packages</a> and places the SDK by default in <code>~/Android/Sdk</code>.
</p>
<p>To build apps from the command-line (using e.g. <code>./gradlew assembleDebug</code>) set the <a rel="nofollow"  href="https://developer.android.com/studio/command-line/variables#android_sdk_root">ANDROID_SDK_ROOT</a> <a href="../wiki/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> to your SDK location.
</p>
<h3><span class="mw-headline" id="SDK_packages">SDK packages</span></h3>
<p>Android SDK packages can be installed directly from upstream using <a href="#Android_Studio">#Android Studio</a>'s <a rel="nofollow"  href="https://developer.android.com/studio/intro/update#sdk-manager">SDK Manager</a> or the <a rel="nofollow"  href="https://developer.android.com/studio/command-line/sdkmanager">sdkmanager</a> command line tool (part of the Android SDK Tools). Some Android SDK packages are also available as <a href="../wiki/TOS_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> packages, they generally install to <code>/opt/android-sdk/</code>.
</p>
<p>The <a rel="nofollow"  href="https://developer.android.com/studio/intro/update#recommended">required SDK packages</a> are:
</p>
<table >
<tbody>
<tr>
<th>Android SDK Package</th>
<th>SDK-style path</th>
<th>AUR package</th>
<th>AUR dummy</th>
<th>CLI tools
</th>
</tr>
<tr>
<td><a rel="nofollow"  href="https://developer.android.com/studio/releases/sdk-tools">SDK Tools</a></td>
<td>tools</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk/">android-sdk</a></span><sup><small>AUR</small></sup>
</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk-dummy/">android-sdk-dummy</a></span><sup><small>AUR</small></sup>
</td>
<td>sdkmanager, apkanalizer, avdmanager, mksdcard, proguard
</td>
</tr>
<tr>
<td><a rel="nofollow"  href="https://developer.android.com/studio/releases/build-tools">SDK Build-Tools</a></td>
<td>build-tools;<i>version</i>
</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk-build-tools/">android-sdk-build-tools</a></span><sup><small>AUR</small></sup>
</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk-build-tools-dummy/">android-sdk-build-tools-dummy</a></span><sup><small>AUR</small></sup>
</td>
<td>apksigner, zipalign
</td>
</tr>
<tr>
<td><a rel="nofollow"  href="https://developer.android.com/studio/releases/platform-tools">SDK Platform-Tools</a></td>
<td>platform-tools</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk-platform-tools/">android-sdk-platform-tools</a></span><sup><small>AUR</small></sup>
</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk-platform-tools-dummy/">android-sdk-platform-tools-dummy</a></span><sup><small>AUR</small></sup>
</td>
<td>
<a href="../wiki/Android_Debug_Bridge.html" class="mw-redirect" title="Adb">adb</a>, <a href="#Fastboot">#fastboot</a> and systrace
</td>
</tr>
<tr>
<td><a rel="nofollow"  href="https://developer.android.com/studio/releases/platforms">SDK Platform</a></td>
<td>platforms;android-<i>level</i>
</td>
<td>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-platform/">android-platform</a></span><sup><small>AUR</small></sup>, <a rel="nofollow"  href="https://aur.archlinux.org/packages/?K=android-platform-">older versions</a>
</td>
<td>unnecessary
</td>
</tr>
</tbody>
</table>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=android-tools">android-tools</a></span> package provides <a href="../wiki/Android_Debug_Bridge.html" class="mw-redirect" title="Adb">adb</a>, <a href="#Fastboot">#fastboot</a>, <code>e2fsdroid</code> and <code>mke2fs.android</code> from the SDK Platform-Tools along with <code>mkbootimg</code> and <code>ext2simg</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  
<ul>
<li>Since the Android SDK contains 32-bit binaries, you must enable the <a href="../wiki/Official_repositories.html#multilib" class="mw-redirect" title="Multilib">multilib</a> repository. Otherwise you will get <code>error: target not found: lib32-*</code> error messages.</li>
<li>If you choose to directly install SDK packages from upstream, install the AUR packages of the <i>AUR dummy</i> column to pull in the required dependencies.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Android_Emulator">Android Emulator</span></h4>
<p>The <a rel="nofollow"  href="https://developer.android.com/studio/run/emulator">Android Emulator</a> is available as the <code>emulator</code> SDK package, the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-emulator/">android-emulator</a></span><sup><small>AUR</small></sup> package, and there's also a dummy package for it: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-emulator-dummy/">android-emulator-dummy</a></span><sup><small>AUR</small></sup>.
</p>
<p>To run the Android Emulator you need an Intel or ARM System Image. You can install them through the AUR<a rel="nofollow"  href="https://aur.archlinux.org/packages/?K=android-+system+image">[2]</a>, with the sdkmanager or using Android Studio's <a rel="nofollow"  href="https://developer.android.com/studio/run/managing-avds">AVD Manager</a>.
</p>
<h4><span class="mw-headline" id="Other_SDK_packages_in_the_AUR">Other SDK packages in the AUR</span></h4>
<p>The <a rel="nofollow"  href="https://developer.android.com/topic/libraries/support-library/">Android Support Library</a> is now available online from <a rel="nofollow"  href="https://developer.android.com/studio/build/dependencies#google-maven">Google's Maven repository</a>.
You can also install it offline through the <code>extras;android;m2repository</code> SDK package (also available as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-support-repository/">android-support-repository</a></span><sup><small>AUR</small></sup>).
</p>
<h4>
<span id="Making_.2Fopt.2Fandroid-sdk_group-writeable"></span><span class="mw-headline" id="Making_/opt/android-sdk_group-writeable">Making /opt/android-sdk group-writeable</span>
</h4>
<p>The AUR packages install the SDK in <code>/opt/android-sdk/</code>. This directory has root <a href="../wiki/File_permissions_and_attributes.html" class="mw-redirect" title="Permissions">permissions</a>, so keep in mind to run sdk manager as root. If you intend to use it as a regular user, create the android-sdk users group, add your user.
</p>
<pre># groupadd android-sdk
# gpasswd -a &lt;user&gt; android-sdk
</pre>
<p>Set an access control list to let members of the newly created group write into the android-sdk folder. As running sdkmanager can also create new files, set the ACL as default ACL. the X in the default group entry means "allow execution if executable by the owner (or anyone else)"
</p>
<pre># setfacl -R -m g:android-sdk:rwx /opt/android-sdk
# setfacl -d -m g:android-sdk:rwX /opt/android-sdk  
</pre>
<p>Re-login or as &lt;user&gt; log your terminal in to the newly created group:
</p>
<pre>$ newgrp android-sdk
</pre>
<h3><span class="mw-headline" id="Other_IDEs">Other IDEs</span></h3>
<p>Android Studio is the official Android development environment based on IntelliJ IDEA. Alternatively, you can use <a href="../wiki/Netbeans.html" title="Netbeans">Netbeans</a> with the NBAndroid-V2. All are described below.
</p>
<h4><span class="mw-headline" id="Netbeans">Netbeans</span></h4>
<p>If you prefer using <a href="../wiki/Netbeans.html" title="Netbeans">Netbeans</a> as your IDE and want to develop Android applications, use <a rel="nofollow"  href="https://github.com/NBANDROIDTEAM/NBANDROID-V2">NBAndroid-V2</a> .
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-sdk/">android-sdk</a></span><sup><small>AUR</small></sup> package and follow the instructions from the <a rel="nofollow"  href="https://github.com/NBANDROIDTEAM/NBANDROID-V2/blob/master/README.md">NBANDROID README</a>.
</p>
<h3><span class="mw-headline" id="Other_Tools">Other Tools</span></h3>
<h4><span class="mw-headline" id="Marvin">Marvin</span></h4>
<p>Marvin is a tool which helps beginners set up an Android development environment. Installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/marvin_dsc/">marvin_dsc</a></span><sup><small>AUR</small></sup> helps you set up the following things: JDK, Android SDK, IDE(s), and AVD.
</p>
<h2><span class="mw-headline" id="Building">Building</span></h2>
<p>Please note that these instructions are based on the <a rel="nofollow"  href="https://source.android.com/source/building">official AOSP build instructions</a>. Other Android-derived systems such as LineageOS will often require extra steps.
</p>
<h3><span class="mw-headline" id="Required_packages">Required packages</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Before doing the following steps, the <a href="../wiki/Official_repositories.html#multilib" class="mw-redirect" title="Multilib">multilib</a> repository must be enabled in <code>/etc/pacman.conf</code>.</div>
<p>As of 2020/April, to build either AOSP 10 or LineageOS 17.1 you need (possibly a subset of):
</p>
<ul><li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/groups/x86_64/base-devel/">base-devel</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/groups/x86_64/multilib-devel/">multilib-devel</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gcc">gcc</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=repo">repo</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=git">git</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnupg">gnupg</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gperf">gperf</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=sdl">sdl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=wxgtk2">wxgtk2</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=squashfs-tools">squashfs-tools</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=curl">curl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ncurses">ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=zlib">zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=schedtool">schedtool</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=perl-switch">perl-switch</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=zip">zip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=unzip">unzip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libxslt">libxslt</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bc">bc</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=rsync">rsync</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ccache">ccache</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-zlib">lib32-zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-ncurses">lib32-ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-readline">lib32-readline</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/ncurses5-compat-libs/">ncurses5-compat-libs</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-ncurses5-compat-libs/">lib32-ncurses5-compat-libs</a></span><sup><small>AUR</small></sup>
</li></ul>
<p>and a TTF font installed, e.g. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ttf-dejavu">ttf-dejavu</a></span>.
In particualr, no Python2 or Java are required, as they are provided by AOSP/Lineage.
What follows below is only relevant to obsolete Android versions.
</p>
<p><br>
</p>
<p>To build any version of Android, you need to install these packages:
</p>
<ul><li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-gcc-libs">lib32-gcc-libs</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=git">git</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnupg">gnupg</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=flex">flex</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bison">bison</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gperf">gperf</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=sdl">sdl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=wxgtk2">wxgtk2</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=squashfs-tools">squashfs-tools</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=curl">curl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ncurses">ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=zlib">zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=schedtool">schedtool</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=perl-switch">perl-switch</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=zip">zip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=unzip">unzip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libxslt">libxslt</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=python2-virtualenv">python2-virtualenv</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bc">bc</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=rsync">rsync</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/ncurses5-compat-libs/">ncurses5-compat-libs</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-zlib">lib32-zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-ncurses">lib32-ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-readline">lib32-readline</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-ncurses5-compat-libs/">lib32-ncurses5-compat-libs</a></span><sup><small>AUR</small></sup>
</li></ul>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/aosp-devel/">aosp-devel</a></span><sup><small>AUR</small></sup> metapackage provides them all for simple installation.
</p>
<p>Additionally, LineageOS requires the following packages: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/xml2/">xml2</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lzop">lzop</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pngcrush">pngcrush</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=imagemagick">imagemagick</a></span>
</p>
<p>They can be installed with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lineageos-devel/">lineageos-devel</a></span><sup><small>AUR</small></sup> metapackage.
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> The note below is not clear and probably incomplete. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Android">Talk:Android#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Installing both <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=maven">maven</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gradle">gradle</a></span> to build LineageOS may result in a build speed improvement as the build process will prefer the system's</div>
<h3><span class="mw-headline" id="Java_Development_Kit">Java Development Kit</span></h3>
<p>The <a rel="nofollow"  href="https://source.android.com/source/requirements">required JDK version</a> depends on the Android version you are building:
</p>
<ul>
<li>For Android 9 (Pie) and up, Java is included with the Android source and no separate installation is needed.</li>
<li>For Android 7 and 8 (Nougat and Oreo), OpenJDK 8 is required, which is available with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=jdk8-openjdk">jdk8-openjdk</a></span> package.</li>
<li>For Android 5 and 6 (Lollipop and Marshmallow), OpenJDK 7 is required, which is available with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=jdk7-openjdk">jdk7-openjdk</a></span> package.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> For older Android versions, where Java is not included, Java is expected to be in <code>/usr/lib/jvm/java-<i>version</i>-openjdk-amd64</code>.
<p>Set JAVA_HOME to avoid this requirement and match the TOS Linux installation path.
Example:
</p>
<pre>$ export JAVA_HOME=/usr/lib/jvm/java-<i>version</i>-openjdk
</pre>
This change will be valid only for the current terminal session.</div>
<h3><span class="mw-headline" id="Setting_up_the_build_environment">Setting up the build environment</span></h3>
<p><a href="../wiki/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=repo">repo</a></span> package. 
</p>
<p>Create a directory to build.
</p>
<pre>$ mkdir ~/android
$ cd ~/android
</pre>
<p>The Android build process expects <code>python</code> to be python2. Prepend it to the <code>PATH</code>:
</p>
<pre>$ mkdir bin
$ ln -s /bin/python2 bin/python
$ export PATH=$PWD/bin:$PATH
</pre>
<p>Alternatively, create a python2 virtual environment and activate it:
</p>
<pre>$ virtualenv2 --system-site-packages venv
$ source venv/bin/activate
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>This activation is only active for the current terminal session. The virtual env will be kept in the <code>venv</code> folder.</li>
<li>Passing "--system-site-packages" to virtualenv2 points your virtual environment to your installed python2.7 modules. This should give you all python modules you need for the build, assuming you've installed the required dependencies such as python2-mako.</li>
<li>If during the build you still receive errors pertaining to missing python modules a quick and dirty fix might be to symlink /usr/lib/python2.7/* to ~/android/venv/lib/python2.7/ (Change ~/android to reflect your build directory if different than above).</li>
</ul>
<p>Example:
</p>
<pre>$ ln -s /usr/lib/python2.7/* ~/android/venv/lib/python2.7/
</pre>
<p>or (assuming build directory Data/Android_Build):
</p>
<pre>$ ln -s /usr/lib/python2.7/* /Data/Android_Build/venv/lib/python2.7/
</pre>
</div>
<h3><span class="mw-headline" id="Downloading_the_source_code">Downloading the source code</span></h3>
<p>This will clone the repositories. You <b>only</b> need to do this the first time you build Android, or if you want to switch branches.
</p>
<ul><li>The <code>repo</code> has a <code>-j</code> switch that operates similarly to the one used with <code>make</code>. Since it controls the number of simultaneous downloads, you should adjust the value depending on downstream network bandwidth.</li></ul>
<ul><li>You will need to specify a <b>branch</b> (<a rel="nofollow"  href="https://android.googlesource.com/platform/manifest/+refs">list of branches</a>) to check out with the <code>-b</code> switch. If you leave the switch out, you will get the so-called <b>master branch</b>.</li></ul>
<pre>$ repo init -u https://android.googlesource.com/platform/manifest -b master
$ repo sync -j4
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> To further decrease sync times, you can utilize the -c switch with the repo command as such:
<pre>$ repo sync -j8 -c
</pre>
<p>The <code>-c</code> switch will only sync the branch which is specified in the manifest, which in turn is determined by the branch specified with the <code>-b</code> switch, or the default branch set by the repository maintainer.
</p>
</div>
<p>Wait a long time. Just the uncompiled source code, along with the <code>.repo</code> and <code>.git</code> directories that are used to keep track of it, are very large. As of Android 10, at least 250 GB of free disk space is <a rel="nofollow"  href="https://source.android.com/setup/build/requirements">required</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you want to update your local copy of the Android source, at a later time, simply enter the build directory, load the Virtualenv, and re-sync:
<pre>$ repo sync
</pre>
</div>
<h3><span class="mw-headline" id="Building_the_code">Building the code</span></h3>
<p>This should do what you need for AOSP:
</p>
<pre>$ source build/envsetup.sh
$ lunch full-eng
$ make -j4
</pre>
<p>If you run <b>lunch</b> without arguments, it will ask what build you want to create. Use -j with a number between one and two times number of cores/threads.
</p>
<p>The build takes a very long time.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Make sure you have enough RAM. Android will use the <code>/tmp</code> directory heavily. By default the size of the partition the <code>/tmp</code> folder is mounted on is half the size of your RAM. If it fills up, the build will fail. 4GB of RAM or more is recommended. Alternatively, you can get rid of the tmpfs from <a href="../wiki/Fstab.html" title="Fstab">fstab</a> all together.</li>
<li>From the <a rel="nofollow"  href="https://source.android.com/source/building#build-the-code">Android Building and Running guide</a>:</li>
</ul>
<p>"GNU make can handle parallel tasks with a <code>-jN</code> argument, and it's common to use a number of tasks N that's between 1 and 2 times the number of hardware threads on the computer being used for the build. E.g. on a dual-E5520 machine (2 CPUs, 4 cores per CPU, 2 threads per core), the fastest builds are made with commands between <code>make -j16</code> and <code>make -j32</code>."
</p>
</div>
<h3><span class="mw-headline" id="Testing_the_build">Testing the build</span></h3>
<p>When finished, run/test the final image(s).
</p>
<pre>$ emulator
</pre>
<h3><span class="mw-headline" id="Creating_a_flashable_Image">Creating a flashable Image</span></h3>
<p>To create an image that can be flashed it is necessary to:
</p>
<pre>make -j8 updatepackage
</pre>
<p>This will create a zip image under <code><b>out/target/product/hammerhead</b></code> (hammerhead being the device name) that can be flashed.
</p>
<h2><span class="mw-headline" id="Flashing">Flashing</span></h2>
<p>In some cases, you want to return to the stock Android after flashing custom ROMs to your Android mobile device. For flashing instructions of your device, please use <a rel="nofollow"  href="http://forum.xda-developers.com/">XDA forums</a>.
</p>
<h3><span class="mw-headline" id="Fastboot">Fastboot</span></h3>
<p>Fastboot (as well as <a href="../wiki/Android_Debug_Bridge.html" class="mw-redirect" title="ADB">ADB</a>) is included in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=android-tools">android-tools</a></span> package.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Restoring firmwares using <code>fastboot</code> can be quite tricky, but you might want to browse <a rel="nofollow"  href="http://www.xda-developers.com/">XDA developers forums</a> for a stock firmware, which is mostly a <code>*.zip</code> file, but inside of it, comes with the firmware files and <code>flash-all.sh</code> script. For example, <a rel="nofollow"  href="https://developers.google.com/android/nexus/images">Google Nexus</a> firmwares include <code>flash-all.sh</code> script or another example could be for OnePlus One - <a rel="nofollow"  href="http://forum.xda-developers.com/oneplus-one/general/guide-return-opo-to-100-stock-t2826541">XDA thread</a>, where you can find firmwares with included <code>flash-all.sh</code> script.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you get a <code>no permissions</code> error or execution just hangs with <code>&lt; waiting for any device &gt;</code> then you need to run <code>fastboot</code> as the root user. Alternatively you can install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=android-udev">android-udev</a></span> or the AUR package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/android-udev-git/">android-udev-git</a></span><sup><small>AUR</small></sup> and reconnect your device.</div>
<h3><span class="mw-headline" id="Samsung_devices">Samsung devices</span></h3>
<p>Samsung devices can't be flashed using <b>Fastboot</b> tool. Alternatives are only <b>Heimdall</b> and <b>Odin</b> (by using Windows and VirtualBox).
</p>
<h4><span class="mw-headline" id="Heimdall">Heimdall</span></h4>
<p><a rel="nofollow"  href="http://glassechidna.com.au/heimdall/">Heimdall</a> is a cross-platform open-source tool suite used to flash firmware (also known as ROMs) onto Samsung mobile devices and is also known as an alternative to <a rel="nofollow"  href="http://odindownload.com/">Odin</a>. It can be installed as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=heimdall">heimdall</a></span>.
</p>
<p>The flashing instructions can be found on Heimdall's <a rel="nofollow"  href="https://gitlab.com/BenjaminDobell/Heimdall/tree/master/Linux">GitLab repository</a> or on <a rel="nofollow"  href="http://forum.xda-developers.com/showthread.php?t=1922461">XDA forums</a>.
</p>
<h4>
<span id="Odin_.28Virtualbox.29"></span><span class="mw-headline" id="Odin_(Virtualbox)">Odin (Virtualbox)</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This section only covers preparation and <b>not</b> flashing instructions. Search <a rel="nofollow"  href="http://www.xda-developers.com">XDA developers forums</a> to find flashing instructions for a specific device. For example, <a rel="nofollow"  href="https://forum.xda-developers.com/showthread.php?t=2265477">Samsung Galaxy S4</a>.</div>
<p>It is also possible to restore <a rel="nofollow"  href="http://www.sammobile.com/firmwares/">firmware (Android)</a> on the Samsung devices using <a rel="nofollow"  href="http://odindownload.com/">Odin</a>, but inside the <a href="../wiki/VirtualBox.html" title="VirtualBox">VirtualBox</a>.
</p>
<p>TOS Linux (host) preparation:
</p>
<ol>
<li>Install <a href="../wiki/VirtualBox.html" title="VirtualBox">VirtualBox</a> together with its <a href="../wiki/VirtualBox.html#Extension_pack" title="VirtualBox">extension pack</a> and <a href="../wiki/VirtualBox.html#Guest_additions_disc" title="VirtualBox">guest additions</a>.</li>
<li>Install your preferred, but compatible with Odin, Windows operating system (with VirtualBox guest additions) into a virtual hard drive using VirtualBox.</li>
<li>Open VirtualBox settings of your Windows operating system, navigate to <i>USB</i>, then tick (or make sure it is ticked) <b>Enable USB 2.0 (EHCI) Controller</b>.</li>
<li>At VirtualBox running Windows operating system, click in the menu bar <i>Devices &gt; USB Devices</i>, then click on your Samsung mobile device from the list, which is connected to your computer via USB.</li>
</ol>
<p>Windows (guest) preparation:
</p>
<ol>
<li>Install <a rel="nofollow"  href="http://androidxda.com/download-samsung-usb-drivers">Samsung drivers</a>.</li>
<li>Install <a rel="nofollow"  href="http://odindownload.com/">Odin</a>.</li>
<li>Download required <a rel="nofollow"  href="http://www.sammobile.com/firmwares/">Samsung firmware (Android)</a> for your smartphone model.</li>
</ol>
<p>Check if configuration is working:
</p>
<ol>
<li>Turn your device into Download mode and connect to your Linux machine.</li>
<li>In virtual machine toolbar, select <i>Devices &gt; USB &gt; ...Samsung...</i> device.</li>
<li>Open Odin. The white box (a big one at the bottom-left side) named <b>Message</b>, should print a line similar to this:</li>
</ol>
<pre>&lt;ID:0/003&gt; Added!!
</pre>
<p>which means that your device is visible to Odin &amp; Windows operating system and is ready to be flashed.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Android_Studio:_Android_Virtual_Devices_show_.27failed_to_load.27."></span><span class="mw-headline" id="Android_Studio:_Android_Virtual_Devices_show_'failed_to_load'.">Android Studio: Android Virtual Devices show 'failed to load'.</span>
</h3>
<p>Make sure you've exported the variable <code>ANDROID_HOME</code> as explained in <a href="#Android_Studio">#Android Studio</a>.
</p>
<h3>
<span id="Android_Studio:_.27failed_to_create_the_SD_card.27"></span><span class="mw-headline" id="Android_Studio:_'failed_to_create_the_SD_card'">Android Studio: 'failed to create the SD card'</span>
</h3>
<p>If you try to run an AVD (Android Virtual Device) under x86_64 TOS and get the error above, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-gcc-libs">lib32-gcc-libs</a></span> package from the <a href="../wiki/Official_repositories.html#multilib" class="mw-redirect" title="Multilib">multilib</a> repository.
</p>
<h3>
<span id="Eclipse:_During_Debugging_.22Source_not_found.22"></span><span class="mw-headline" id='Eclipse:_During_Debugging_"Source_not_found"'>Eclipse: During Debugging "Source not found"</span>
</h3>
<p>Most probably the debugger wants to step into the Java code. As the source code of Android does not come with the Android SDK, this leads to an error. The best solution is to use step filters to not jump into the Java source code. Step filters are not activated by default. To activate them: <i>Window &gt; Preferences &gt; Java &gt; Debug &gt; Step Filtering</i>.
Consider to select them all. If appropriate you can add the android.* package. See the forum post for more information: <a rel="nofollow"  href="http://www.eclipsezone.com/eclipse/forums/t83338.rhtml">http://www.eclipsezone.com/eclipse/forums/t83338.rhtml</a>
</p>
<h3><span class="mw-headline" id="ValueError:_unsupported_pickle_protocol">ValueError: unsupported pickle protocol</span></h3>
<p>One fix is to issue:
</p>
<pre>$ rm ~/.repopickle_.gitconfig
</pre>
<p>If that does not work, then try this:
</p>
<pre>$ find /path/to/android-root -name .repopickle_config -delete
</pre>
<h3>
<span id="libGL_error:_failed_to_load_driver:_swrast_OR_AVD_doesn.27t_load_and_no_error_message_displayed"></span><span class="mw-headline" id="libGL_error:_failed_to_load_driver:_swrast_OR_AVD_doesn't_load_and_no_error_message_displayed">libGL error: failed to load driver: swrast OR AVD doesn't load and no error message displayed</span>
</h3>
<p>Sometimes, beginning to load an AVD will cause an error message similar to this to be displayed, or the loading process will appear to finish but no AVD will load and no error message will be displayed.
</p>
<p>The AVD loads an incorrect version of libstdc++, you can remove the folder libstdc++ from <code>~/.android-sdk/emulator/lib64</code> (for 64-bit) or <code>~/.android-sdk/emulator/lib</code> (for 32-bit) , e.g.:
</p>
<pre>$ rm -r ~/.android-sdk/emulator/lib64/libstdc++
</pre>
<p>Note that in versions before Android Studio 3.0, this directory was in a different location:
</p>
<pre>$ rm -r ~/Android/Sdk/emulator/lib64/libstdc++
</pre>
<p>Alternatively you can set and export ANDROID_EMULATOR_USE_SYSTEM_LIBS in ~/.profile as:
</p>
<pre>export ANDROID_EMULATOR_USE_SYSTEM_LIBS=1
</pre>
<p>Reference: <a rel="nofollow"  href="https://developer.android.com/studio/command-line/variables.html#studio_jdk">Android Studio user guide</a>
</p>
<p>Fix for the .desktop file might be achieved by using env command, prefixing the Exec line <a href="../wiki/Desktop_entries.html#Modify_environment_variables" title="Desktop entries">Desktop entries#Modify environment variables</a>
</p>
<pre>env ANDROID_EMULATOR_USE_SYSTEM_LIBS=1
</pre>
<h3><span class="mw-headline" id="sh:_glxinfo:_command_not_found">sh: glxinfo: command not found</span></h3>
<p>Here's the full error:
</p>
<pre>Cannot launch AVD in emulator.
Output:
sh: glxinfo: command not found
sh: glxinfo: command not found
libGL error: unable to load driver: swrast_dri.so
libGL error: failed to load driver: swrast
X Error of failed request:  BadValue (integer parameter out of range for operation)
  Major opcode of failed request:  154 (GLX)
  Minor opcode of failed request:  24 (X_GLXCreateNewContext)
  Value in failed request:  0x0
  Serial number of failed request:  32
  Current serial number in output stream:  33
QObject::~QObject: Timers cannot be stopped from another thread
</pre>
<p>You can try to install glxinfo (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mesa-demos">mesa-demos</a></span>) but if your computer has enough power you could simply use software to render graphics.  To do so, go to <i>Tools &gt; Android &gt; AVD Manager</i>, edit the <i>AVD</i> (click the pencil icon), then select <i>Software - GLES 2.0</i> for <i>Emulated Performance &gt; Graphics</i>.
</p>
<h3><span class="mw-headline" id="Android_Emulator:_no_keyboard_input_in_xfwm4">Android Emulator: no keyboard input in xfwm4</span></h3>
<p>In xfwm4, the vertical toolbar buttons window that is on the right of the emulator takes focus from the emulator and consumes keyboard events.
(<a rel="nofollow"  href="https://issuetracker.google.com/issues/37094173">bug report</a>)
</p>
<p>You can use the workaround described in <a rel="nofollow"  href="https://stackoverflow.com/a/42720450/1366471">this Stack Overflow answer</a>:
</p>
<ol>
<li>Open the xfwm4 settings.</li>
<li>Switch to the Focus tab.</li>
<li>Change the Focus Model to "Focus follow mouse".</li>
<li>Disable <i>Automatically raise windows when they receive focus</i> option below.</li>
</ol>
<h3>
<span id="Android_Emulator:_Segmentation_fault_.28core_dumped.29"></span><span class="mw-headline" id="Android_Emulator:_Segmentation_fault_(core_dumped)">Android Emulator: Segmentation fault (core dumped)</span>
</h3>
<p>If using <a href="../wiki/Nouveau.html" title="Nouveau">Nouveau</a> drivers try to disable gpu hardware acceleration.
</p>
<p>In some devices it can only be done by editing <code>$HOME/.avd/&lt;device_name&gt;.avd/config.ini</code>. (<a rel="nofollow"  href="https://stackoverflow.com/a/58376934/1064760">details</a>)
</p>
<ol>
<li>Set <code>hw.gpu.enabled=no</code>
</li>
<li>Set <code>hw.gpu.mode=off</code>
</li>
</ol>
<h3><span class="mw-headline" id="adb:_sideload_connection_failed:_insufficient_permissions_for_device">adb: sideload connection failed: insufficient permissions for device</span></h3>
<p>If you get the error:
</p>
<pre>adb: sideload connection failed: insufficient permissions for device
See <a rel="nofollow"  href="http://developer.android.com/tools/device.html">[3]</a> for more information
adb: trying pre-KitKat sideload method...
adb: pre-KitKat sideload connection failed: insufficient permissions for device
See <a rel="nofollow"  href="http://developer.android.com/tools/device.html">[4]</a> for more information
</pre>
<p>you might solve it by restarting the adb server:
</p>
<pre> $ adb kill-server
 # adb start-server
</pre>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../wiki/Category:Android.html" title="Category:Android">Android</a></li>
<li><a href="../wiki/Category:Development.html" title="Category:Development">Development</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../wiki/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Android&amp;oldid=615165">https://wiki.archlinux.org/index.php?title=Android&amp;oldid=615165</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 23 May 2020, at 06:10.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../wiki/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../wiki/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../wiki/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



