<!--
    title: Lenovo_ThinkPad_T480
    description: Migration of Lenovo_ThinkPad_T480 from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:44:33.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Lenovo ThinkPad T480</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table  style="float: right;">
<tbody>
<tr>
<td><b>Device</b></td>
<td>
<b>Status</b>
</td>
</tr>
<tr>
<td><a href="../Intel_graphics.html" title="Intel graphics">Intel graphics</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../Network_configuration/Wireless.html" class="mw-redirect" title="Wireless">Wireless</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../Advanced_Linux_Sound_TOSitecture.html" class="mw-redirect" title="ALSA">ALSA</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../TrackPoint.html" title="TrackPoint">TrackPoint</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../Laptop.html#Touchpad" class="mw-redirect" title="Touchpad">Touchpad</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../Webcam_setup.html" class="mw-redirect" title="Webcam">Webcam</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../Bluetooth.html" title="Bluetooth">Bluetooth</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../ThinkPad_mobile_Internet.html" title="ThinkPad mobile Internet">Mobile internet</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes¹
</td>
</tr>
<tr>
<td>Fingerprint Sensor</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No²
</td>
</tr>
<tr>
<td colspan="2" style="font-size: 70%; border: none;">
<ol>
<li> No working Linux driver for Fibocom L850-GL. See <a rel="nofollow"  href="https://forums.lenovo.com/t5/Linux-Discussion/X1C-gen-6-Fibocom-L850-GL-Ubuntu-18-04/m-p/4078413">this thread</a> and <a rel="nofollow"  href="https://forums.lenovo.com/t5/Linux-Discussion/Linux-support-for-WWAN-LTE-L850-GL-on-T580-T480/td-p/4067969">this thread</a> for more info.</li>
<li>No working Linux driver so far for Synaptics 06cb:009a. See <a rel="nofollow"  href="https://github.com/nmikhailov/Validity90">here</a> and <a rel="nofollow"  href="https://forums.lenovo.com/t5/Other-Linux-Discussions/Linux-on-T495/m-p/4474320/highlight/true#M13440">here</a>.</li>
</ol>
</td>
</tr>
</tbody>
</table>
<p>This article covers the installation and configuration of TOS Linux on a Lenovo T480 laptop. Everything seems to work pretty much out the box.
</p>
<p>For a general overview of laptop-related articles and recommendations, see <a href="../Laptop.html" title="Laptop">Laptop</a>.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hardware"><span >1</span> <span >Hardware</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Suspend_/_Hibernation"><span >2</span> <span >Suspend / Hibernation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#TrackPoint_and_Touchpad"><span >3</span> <span >TrackPoint and Touchpad</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Power_management/Throttling_issues"><span >4</span> <span >Power management/Throttling issues</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#UEFI/Firmware_Updates"><span >5</span> <span >UEFI/Firmware Updates</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#UEFI_and_GRUB"><span >6</span> <span >UEFI and GRUB</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#Screen_backlight"><span >7</span> <span >Screen backlight</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Encryption_and_keyboard"><span >8</span> <span >Encryption and keyboard</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#Special_buttons"><span >9</span> <span >Special buttons</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Hardware">Hardware</span></h2>
<p>Using kernel 4.16.8-1-ARCH
</p>
<pre>Version: ThinkPad T480
SKU Number: LENOVO_MT_20L5_BU_Think_FM_ThinkPad T480
Product Name: 20L5CTO1WW
</pre>
<p><code>lspci</code> returns something like:
</p>
<pre>00:00.0 Host bridge: Intel Corporation Xeon E3-1200 v6/7th Gen Core Processor Host Bridge/DRAM Registers (rev 08)
00:02.0 VGA compatible controller: Intel Corporation UHD Graphics 620 (rev 07)
00:04.0 Signal processing controller: Intel Corporation Xeon E3-1200 v5/E3-1500 v5/6th Gen Core Processor Thermal Subsystem (rev 08)
00:08.0 System peripheral: Intel Corporation Xeon E3-1200 v5/v6 / E3-1500 v5 / 6th/7th Gen Core Processor Gaussian Mixture Model
00:14.0 USB controller: Intel Corporation Sunrise Point-LP USB 3.0 xHCI Controller (rev 21)
00:14.2 Signal processing controller: Intel Corporation Sunrise Point-LP Thermal subsystem (rev 21)
00:15.0 Signal processing controller: Intel Corporation Sunrise Point-LP Serial IO I2C Controller #0 (rev 21)
00:16.0 Communication controller: Intel Corporation Sunrise Point-LP CSME HECI #1 (rev 21)
00:1c.0 PCI bridge: Intel Corporation Sunrise Point-LP PCI Express Root Port #1 (rev f1)
00:1c.6 PCI bridge: Intel Corporation Sunrise Point-LP PCI Express Root Port #7 (rev f1)
00:1d.0 PCI bridge: Intel Corporation Sunrise Point-LP PCI Express Root Port #9 (rev f1)
00:1d.2 PCI bridge: Intel Corporation Device 9d1a (rev f1)
00:1f.0 ISA bridge: Intel Corporation Device 9d4e (rev 21)
00:1f.2 Memory controller: Intel Corporation Sunrise Point-LP PMC (rev 21)
00:1f.3 Audio device: Intel Corporation Sunrise Point-LP HD Audio (rev 21)
00:1f.4 SMBus: Intel Corporation Sunrise Point-LP SMBus (rev 21)
00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (4) I219-V (rev 21)
03:00.0 Network controller: Intel Corporation Wireless 8265 / 8275 (rev 78)
3d:00.0 Non-Volatile memory controller: Lenovo Device 0003
</pre>
<p><code>lsusb</code> returns something like:
</p>
<pre>Bus 002 Device 005: ID 0bda:0316 Realtek Semiconductor Corp. 
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 004: ID 06cb:009a Synaptics, Inc. 
Bus 001 Device 003: ID 04f2:b604 Chicony Electronics Co., Ltd 
Bus 001 Device 002: ID 8087:0a2b Intel Corp. 
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</pre>
<p>and for Product Name: <code>20L50007GE</code> something like:
</p>
<pre>Bus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 002: ID 0bda:0316 Realtek Semiconductor Corp. 
Bus 001 Device 006: ID 06cb:009a Synaptics, Inc. 
Bus 001 Device 005: ID 13d3:56a6 IMC Networks 
Bus 001 Device 004: ID 8087:0a2b Intel Corp. 
Bus 001 Device 003: ID 2cb7:0210  
Bus 001 Device 002: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
</pre>
<p>ID <code>2cb7:0210</code> is the 4G modem Fibocom L830-EB.
Noted that devices come with 4G modem Fibocom L850-GL may not work.
</p>
<h2>
<span id="Suspend_.2F_Hibernation"></span><span class="mw-headline" id="Suspend_/_Hibernation">Suspend / Hibernation</span>
</h2>
<p>Suspend and Hibernation work out of the box. The T480 does not have the same issues as the <a href="../Lenovo_ThinkPad_X1_Carbon_(Gen_6).html#Suspend_issues" title="Lenovo ThinkPad X1 Carbon (Gen 6)">X1 Carbon Gen 6</a>
</p>
<h2><span class="mw-headline" id="TrackPoint_and_Touchpad">TrackPoint and Touchpad</span></h2>
<p>TrackPoint and Touchpad work out of the box and do not seem to have the same issues as the <a href="../Lenovo_ThinkPad_X1_Carbon_(Gen_6).html#TrackPoint_and_Touchpad_issues" title="Lenovo ThinkPad X1 Carbon (Gen 6)">X1 Carbon Gen 6</a>.
</p>
<p>However one could benefit from having greatly increased event reporting frequency by enabling
<code>psmouse</code> <a href="../Kernel_module.html" title="Kernel module">kernel module</a> option <code>synaptics_intertouch=1</code>.
</p>
<p>This can be done for example by editing <code>/etc/modprobe.d/psmouse.conf</code>:
</p>
<pre> options psmouse synaptics_intertouch=1
</pre>
<p>For two-finger scrolling activity this gives a boost from 40 Hz to 135 Hz on average which
is more than threefold increase. This boost greatly contributes to the <a href="../Desktop_environment.html" title="Desktop environment">Desktop environment</a>
scrolling performance and smoothness.
</p>
<p>(<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/evhz-git/">evhz-git</a></span><sup><small>AUR</small></sup>) may be of use to find out how frequently Touchpad reports events. For example
after enabling said option:
</p>
<pre> # evhz
 Press CTRL-C to exit.
 ...
 ^C
 Average for Synaptics TM3276-022:   137Hz
</pre>
<h2>
<span id="Power_management.2FThrottling_issues"></span><span class="mw-headline" id="Power_management/Throttling_issues">Power management/Throttling issues</span>
</h2>
<p>Due to missing Intel Dynamic Platform and Thermal Framework <i>(DPTF)</i> support for Linux, a feature which should detect whether the laptop is used on a desk or on the lap so it can throttle the CPU in the latter case to reduce the temperature is not working and the CPU is always throttled. An Lenovo employee explained the situation and the solution Lenovo is building in a <a rel="nofollow"  href="https://forums.lenovo.com/t5/Other-Linux-Discussions/X1C6-T480s-low-cTDP-and-trip-temperature-in-Linux/m-p/4534535/highlight/true#M13642">PDF posted in their forum</a>. The firmware and EFI fixes have been <a rel="nofollow"  href="https://forums.lenovo.com/t5/Other-Linux-Discussions/X1C6-T480s-low-cTDP-and-trip-temperature-in-Linux/m-p/4535310/highlight/true#M13653">released for a different model</a> and Lenovo has recognized that the T480 is affected, so there is hope the T480 will get the fix too.
</p>
<p>An interim fix is <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=throttled">throttled</a></span> (<a rel="nofollow"  href="https://github.com/erpalma/throttled">Github</a>).
</p>
<p>Also see
</p>
<ul>
<li>X1 Carbon Gen 6 <a href="../Lenovo_ThinkPad_X1_Carbon_(Gen_6).html#Power_management.2FThrottling_issues" title="Lenovo ThinkPad X1 Carbon (Gen 6)">Power management/Throttling issues</a>
</li>
<li>ThinkPad T480s <a href="../Lenovo_ThinkPad_T480s.html#Thermal_Throttling" title="Lenovo ThinkPad T480s">Thermal Throttling Fix</a>
</li>
</ul>
<h2>
<span id="UEFI.2FFirmware_Updates"></span><span class="mw-headline" id="UEFI/Firmware_Updates">UEFI/Firmware Updates</span>
</h2>
<p>Lenovo provides firmware updates for this device through the <i>Linux Vendor Firmware Service</i> (LVFS).
</p>
<p>Available updates and changelogs can be found on the <a rel="nofollow"  href="https://fwupd.org/lvfs/search?value=Thinkpad+T480">LVFS website</a>. These include security patches for the Intel Management Engine and the system firmware.
</p>
<p>The updates can be installed using <a href="../Fwupd.html" title="Fwupd">fwupd</a>.
</p>
<h2><span class="mw-headline" id="UEFI_and_GRUB">UEFI and GRUB</span></h2>
<p>Lenovo T480 is tied in with Microsoft and will only boot to Windows EFI file or default EFI fallback file. Verified on firmware version 1.14.
</p>
<p>When GRUB is used, it is needed to rename the GRUB .efi to one of these specific file names. Please remember to repeat these steps (or use a pacman hook) when the GRUB package was updated.
</p>
<p>1. Mount the device containing the <code>/EFI</code> directory.
</p>
<pre> mount /dev/sdXY /mnt # replace XY with the letter &amp; number of the TOS EFI system partition
</pre>
<p>2. Windows .efi file
</p>
<pre> mkdir -p /mnt/EFI/Microsoft/Boot
 cp /mnt/EFI/grub/grubx64.efi /mnt/EFI/Microsoft/Boot/bootmgfw.efi
</pre>
<p>3. EFI fallback .efi file (as defined in the EFI standard.)
</p>
<pre> mkdir -p /mnt/EFI/BOOT
 cp /mnt/EFI/grub/grub64.efi /mnt/EFI/BOOT/bootx64.efi
</pre>
<p><br>
Source: <a rel="nofollow"  href="http://www.rodsbooks.com/efi-bootloaders/installation.html#alternative-naming">http://www.rodsbooks.com/efi-bootloaders/installation.html#alternative-naming</a>
</p>
<p>Alternatively, systemd-boot can be used as a bootloader. systemd-boot already configures the EFI fallback file name as a default, so no further measures are required after installation.
</p>
<h2><span class="mw-headline" id="Screen_backlight">Screen backlight</span></h2>
<p>Without the intel driver (xf86-video-intel), neither xbacklight or xrandr brightness control are working.
</p>
<p>However, the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=acpilight">acpilight</a></span> provides a drop-in replacement for xbacklight. Apart from installing the package (which conflicts with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xorg-xbacklight">xorg-xbacklight</a></span>), you have to add your user to the <code>video</code> group and add the following udev rule:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/90-backlight.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEM=="backlight", ACTION=="add", \
  RUN+="/bin/chgrp video /sys/class/backlight/%k/brightness", \
  RUN+="/bin/chmod g+w /sys/class/backlight/%k/brightness"


SUBSYSTEM=="leds", ACTION=="add", KERNEL=="*::kbd_backlight", \
  RUN+="/bin/chgrp video /sys/class/leds/%k/brightness", \
  RUN+="/bin/chmod g+w /sys/class/leds/%k/brightness"
</pre>
<p>This allows you to control the backlight with xbacklight command provided by acpilight, as well as control the various LEDs on your T480.
</p>
<h2><span class="mw-headline" id="Encryption_and_keyboard">Encryption and keyboard</span></h2>
<p>Assuming encrypted installation, during boot process you are prompted to enter password to decrypt disk. In some cases you may not be able to enter password, because at this time keyboard driver is not loaded yet.
</p>
<p>To fix this simply put <code>atkbd</code> module into <code>MODULES</code> in <a href="../Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a> config file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  MODULES = (... atkbd)
</pre>
<p>And generate new ramdisk environment:
</p>
<pre> # mkinitcpio -p linux
</pre>
<h2><span class="mw-headline" id="Special_buttons">Special buttons</span></h2>
<p>Some special buttons are not supported by X server due to keycode number limit.
</p>
<table  style="text-align:center">

<tbody>
<tr>
<th>Key combination</th>
<th>Scancode</th>
<th>Keycode
</th>
</tr>
<tr>
<td><code>Fn+F11</code></td>
<td><code>0x49</code></td>
<td>
<code>374</code> <code>KEY_KEYBOARD</code>
</td>
</tr>
<tr>
<td><code>Fn+F12</code></td>
<td><code>0x45</code></td>
<td>
<code>364</code> <code>KEY_FAVORITES</code>
</td>
</tr>
</tbody>
</table>
<p>You can remap unsupported keys using <a href="../Map_scancodes_to_keycodes.html" title="Map scancodes to keycodes">udev hwdb</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/hwdb.d/90-thinkpad-keyboard.hwdb</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">evdev:name:ThinkPad Extra Buttons:dmi:bvn*:bvr*:bd*:svnLENOVO*:pn*
 KEYBOARD_KEY_45=prog1
 KEYBOARD_KEY_49=prog2
</pre>
<p>Update hwdb after editing the rule.
</p>
<pre># udevadm hwdb --update
# udevadm trigger --sysname-match="event*"
</pre>
<p>Their names will be "XF86Launch2" (KEY_KEYBOARD) and "XF86Launch1" (KEY_FAVORITES)
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div></div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_T480&amp;oldid=598288">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_T480&amp;oldid=598288</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 21 February 2020, at 19:13.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



