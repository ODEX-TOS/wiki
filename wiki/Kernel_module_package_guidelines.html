<!--
    title: Kernel_module_package_guidelines
    description: Migration of Kernel_module_package_guidelines from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:44:33.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Kernel module package guidelines</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div  style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../TOS_package_guidelines.html" title="TOS package guidelines">TOS package guidelines</a></b>
<hr>
<p><a href="../32-bit_package_guidelines.html" title="32-bit package guidelines">32-bit</a> – <a href="../CLR_package_guidelines.html" title="CLR package guidelines">CLR</a> – <a href="../CMake_package_guidelines.html" title="CMake package guidelines">CMake</a> – <a href="../Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines">Cross</a> – <a href="../Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../Electron_package_guidelines.html" title="Electron package guidelines">Electron</a> – <a href="../Font_package_guidelines.html" class="mw-redirect" title="Font packaging guidelines">Font</a> – <a href="../Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <a href="../GNOME_package_guidelines.html" title="GNOME package guidelines">GNOME</a> – <a href="../Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a class="mw-selflink selflink">Kernel</a> – <a href="../Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a href="../MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../Node.js_package_guidelines.html" title="Node.js package guidelines">Node.js</a> – <a href="../Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../Python_package_guidelines.html" title="Python package guidelines">Python</a> – <a href="../R_package_guidelines.html" title="R package guidelines">R</a> – <a href="../Ruby_Gem_package_guidelines.html" title="Ruby Gem package guidelines">Ruby</a> – <a href="../Rust_package_guidelines.html" title="Rust package guidelines">Rust</a> – <a href="../VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../Wine_package_guidelines.html" title="Wine package guidelines">Wine</a>
</p>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Kernel_module_package_guidelines">Talk:Kernel module package guidelines#</a>)</div>
</div>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Package_separation"><span >1</span> <span >Package separation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Guidelines"><span >1.1</span> <span >Guidelines</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Rationale"><span >1.2</span> <span >Rationale</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#File_placement"><span >2</span> <span >File placement</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Package_separation">Package separation</span></h2>
<p>Packages that contain <a href="../Kernel_module.html" class="mw-redirect" title="Kernel modules">kernel modules</a> should be treated specially, to support users who wish to have more than one kernel installed on a system.
</p>
<p>When packaging software containing a kernel module and other non-module supporting files/utilities, it is important to separate the kernel modules from the supporting files.
</p>
<h3><span class="mw-headline" id="Guidelines">Guidelines</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Linux switched to a different version scheme. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Kernel_module_package_guidelines">Talk:Kernel module package guidelines#</a>)</div>
</div>
<p>When packaging such software (using the <a href="../NVIDIA.html" title="NVIDIA">NVIDIA</a> drivers as an example) the convention is:
</p>
<ul>
<li>create an <code>nvidia</code> package containing just the kernel modules built for the vanilla kernel</li>
<li>create an <code>nvidia-utils</code> package containing the supporting files</li>
<li>make sure <code>nvidia</code> depends on <code>nvidia-utils</code> (unless there's a good reason not to do so)</li>
<li>for another kernel like <code>kernel26-mm</code>, create <code>nvidia-mm</code> containing the kernel modules built against that kernel which provides nvidia and also depends on <code>nvidia-utils</code>
</li>
<li>make sure <code>nvidia</code> depends on the current major kernel version, for example:</li>
</ul>
<pre>depends=('kernel26&gt;=2.6.24-2' 'kernel26&lt;2.6.25-0' 'nvidia-utils')
</pre>
<p>Note that it is <code>2.6.24-2</code>, not <code>-1</code> in above example - this is because there was a configuration change to important kernel subsystem that required all modules to be rebuilt. You should always change depends version in such cases, otherwise some people with out-of-sync kernel and module version will report that module is broken.
</p>
<h3><span class="mw-headline" id="Rationale">Rationale</span></h3>
<p>While kernel modules built for different kernels always live in different directories and can peacefully coexist, the supporting files are expected to be found in one location. If one package contained module and supporting files, you would be unable to install the modules for more than one kernel because the supporting files in the packages would cause pacman file conflicts.
</p>
<p>The separation of modules and accompanying files allows multiple kernel module packages to be installed for multiple kernels on the same system while sharing the supporting files among them in the expected location.
</p>
<h2><span class="mw-headline" id="File_placement">File placement</span></h2>
<p>If a package includes a kernel module that is meant to override an existing module of the same name, such module should be placed in the <code>/lib/modules/2.6.xx-ARCH/updates</code> directory.  When <b>depmod</b> is run, modules in this directory will take precedence.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../Category:TOS_package_guidelines.html" title="Category:TOS package guidelines">TOS package guidelines</a></li>
<li><a href="../Category:Kernel.html" title="Category:Kernel">Kernel</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Kernel_module_package_guidelines&amp;oldid=610343">https://wiki.archlinux.org/index.php?title=Kernel_module_package_guidelines&amp;oldid=610343</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 3 May 2020, at 14:23.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



