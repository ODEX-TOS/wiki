<!--
    title: GPD_Pocket
    description: Migration of GPD_Pocket from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:44:33.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">GPD Pocket</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p>Notes for the <a rel="nofollow"  href="https://www.indiegogo.com/projects/gpd-pocket-7-0-umpc-laptop-ubuntu-or-win-10-os-laptop--2#/">GPD Pocket</a>.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Specs"><span >1</span> <span >Specs</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Installation"><span >2</span> <span >Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Automatic"><span >2.1</span> <span >Automatic</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Manual"><span >2.2</span> <span >Manual</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#Configuration"><span >3</span> <span >Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Automatic_2"><span >3.1</span> <span >Automatic</span></a></li>
<li class="toclevel-2 tocsection-7">
<a href="#Manual_2"><span >3.2</span> <span >Manual</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#WiFi"><span >3.2.1</span> <span >WiFi</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Backlight_and_KMS"><span >3.2.2</span> <span >Backlight and KMS</span></a></li>
<li class="toclevel-3 tocsection-10">
<a href="#Wayland"><span >3.2.3</span> <span >Wayland</span></a>
<ul>
<li class="toclevel-4 tocsection-11"><a href="#Basic_Configuration"><span >3.2.3.1</span> <span >Basic Configuration</span></a></li>
<li class="toclevel-4 tocsection-12"><a href="#Right_Click_Emulation"><span >3.2.3.2</span> <span >Right Click Emulation</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-13">
<a href="#Xorg"><span >3.2.4</span> <span >Xorg</span></a>
<ul>
<li class="toclevel-4 tocsection-14"><a href="#Basic_Configuration_2"><span >3.2.4.1</span> <span >Basic Configuration</span></a></li>
<li class="toclevel-4 tocsection-15"><a href="#Gnome_and_GDM"><span >3.2.4.2</span> <span >Gnome and GDM</span></a></li>
<li class="toclevel-4 tocsection-16"><a href="#KDE"><span >3.2.4.3</span> <span >KDE</span></a></li>
<li class="toclevel-4 tocsection-17"><a href="#Right_Click_Emulation_2"><span >3.2.4.4</span> <span >Right Click Emulation</span></a></li>
<li class="toclevel-4 tocsection-18"><a href="#SDDM"><span >3.2.4.5</span> <span >SDDM</span></a></li>
<li class="toclevel-4 tocsection-19"><a href="#Touchscreen_Gestures"><span >3.2.4.6</span> <span >Touchscreen Gestures</span></a></li>
<li class="toclevel-4 tocsection-20"><a href="#Making_use_of_%E5%8D%8A/%E5%85%A8_key_on_Pocket_2"><span >3.2.4.7</span> <span >Making use of 半/全 key on Pocket 2</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-21"><a href="#Fan"><span >3.2.5</span> <span >Fan</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Power_Saving"><span >3.2.6</span> <span >Power Saving</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#PulseAudio"><span >3.2.7</span> <span >PulseAudio</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Charge_control"><span >3.2.8</span> <span >Charge control</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-25">
<a href="#Known_Issues"><span >4</span> <span >Known Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-26"><a href="#USB-C_Power_source_status"><span >4.1</span> <span >USB-C Power source status</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#systemd-gpt-auto-generator_failed_to_dissect"><span >4.2</span> <span >systemd-gpt-auto-generator failed to dissect</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28"><a href="#See_also"><span >5</span> <span >See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Specs">Specs</span></h2>
<ul>
<li>Display: 7inch IPS 1920x1200</li>
<li>CPU: Intel Atom X7-Z8750</li>
<li>RAM: 8GB LPDDR3-1600</li>
<li>Storage: 128GB eMMC SSD (non-replaceable)</li>
<li>Battery: 7000mAh</li>
<li>WiFi: Broadcom 4356 802.11ac</li>
<li>Bluetooth: Broadcom 2045</li>
<li>Audio: Realtek ALC5645</li>
<li>Ports: 1 x USB 3 type A, 1 x MicroHDMI, 1 x USB 3 type C, 1 x 3.5mm Headphone Jack</li>
</ul>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Automatic">Automatic</span></h3>
<p>You can download a pre-patched ISO from <a rel="nofollow"  href="https://github.com/sigboe/GPD-TOSISO/releases">here</a>.
</p>
<h3><span class="mw-headline" id="Manual">Manual</span></h3>
<p>Because WiFi is not working with the default configuration, you have to fix WiFi first<sup>(see <a href="#WiFi">#WiFi</a>)</sup>, or use a supported USB Ethernet/WiFi dongle.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Automatic_2">Automatic</span></h3>
<p>During install append the following to /etc/pacman.conf:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
[gpd-pocket-arch]
SigLevel = Never
Server = https://github.com/joshskidmore/gpd-pocket-arch/raw/master
...
</pre>
<p>Install the changes necessary for the GPD Pocket to run TOS properly. Install <code>gpd-pocket-support</code>.
</p>
<p>Because the patch for alsa-lib is an optional dependency, it must be installed manually to get audio to work. Install <code> gpd-pocket-alsa-lib</code>.
</p>
<h3><span class="mw-headline" id="Manual_2">Manual</span></h3>
<h4><span class="mw-headline" id="WiFi">WiFi</span></h4>
<p>Install the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/gpd-pocket-support-bcm4356-git/">gpd-pocket-support-bcm4356-git</a></span><sup><small>AUR</small></sup> and reload the WiFi kernel module:
</p>
<pre># modprobe -r brcmfmac
# modprobe brcmfmac
</pre>
<h4><span class="mw-headline" id="Backlight_and_KMS">Backlight and KMS</span></h4>
<p>In order to enable backlight control with early KMS change <code>/etc/mkinitcpio.conf</code> to match the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
MODULES=(pwm_lpss pwm_lpss_platform i915)
...</pre>
<h4><span class="mw-headline" id="Wayland">Wayland</span></h4>
<h5><span class="mw-headline" id="Basic_Configuration">Basic Configuration</span></h5>
<p>Create <code>/etc/udev/rules.d/99-goodix-touch.rules</code> to rotate the touchscreen, and fill it with:
</p>
<pre>ACTION=="add|change", KERNEL=="event[0-9]*", ATTRS{name}=="Goodix Capacitive TouchScreen", ENV{LIBINPUT_CALIBRATION_MATRIX}="0 1 0 -1 0 1"
</pre>
<h5><span class="mw-headline" id="Right_Click_Emulation">Right Click Emulation</span></h5>
<p>Unlike Xorg, under which right click emulation can be enabled by the standard Xorg configuration files, under Wayland, such configuration is supposed to be exposed by the compositor, and unfortunately, some compositors (e.g. GNOME Wayland) does not expose these configurations properly. However, the regarding functionality is still available in <code>libinput</code>. Since these compositors normally loads <code>/etc/profile.d</code>, <code>LD_PRELOAD</code> can be used to hook into <code>libinput</code> and force apply these configurations.
</p>
<p>A sample implementation of this approach is available <a rel="nofollow"  href="https://github.com/PeterCxy/scroll-emulation">here</a>.
</p>
<h4><span class="mw-headline" id="Xorg">Xorg</span></h4>
<h5><span class="mw-headline" id="Basic_Configuration_2">Basic Configuration</span></h5>
<p>Create <code>/etc/X11/xorg.conf.d/30-monitor.conf</code> to rotate the monitor:
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The Identifier may be different depending on your display driver of choice (either <code>DSI-1</code> <sup>(modesetting)</sup> or <code>DSI1</code> <sup>(xf86-video-intel)</sup>)</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/30-monitor.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Monitor"
  Identifier "DSI-1"
  Option     "Rotate" "right"
EndSection
</pre>
<h5><span class="mw-headline" id="Gnome_and_GDM">Gnome and GDM</span></h5>
<p>Edit <code>~/.config/monitors.xml</code> (this file might not be present by default):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/monitors.xml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;monitors version="2"&gt;
  &lt;configuration&gt;
    &lt;logicalmonitor&gt;
      &lt;x&gt;0&lt;/x&gt;
      &lt;y&gt;0&lt;/y&gt;
      &lt;scale&gt;2&lt;/scale&gt;
      &lt;primary&gt;yes&lt;/primary&gt;
      &lt;transform&gt;
        &lt;rotation&gt;right&lt;/rotation&gt;
        &lt;flipped&gt;no&lt;/flipped&gt;
      &lt;/transform&gt;
      &lt;monitor&gt;
        &lt;monitorspec&gt;
          &lt;connector&gt;DSI-1&lt;/connector&gt;
          &lt;vendor&gt;unknown&lt;/vendor&gt;
          &lt;product&gt;unknown&lt;/product&gt;
          &lt;serial&gt;unknown&lt;/serial&gt;
        &lt;/monitorspec&gt;
        &lt;mode&gt;
          &lt;width&gt;1200&lt;/width&gt;
          &lt;height&gt;1920&lt;/height&gt;
          &lt;rate&gt;60.384620666503906&lt;/rate&gt;
        &lt;/mode&gt;
      &lt;/monitor&gt;
    &lt;/logicalmonitor&gt;
  &lt;/configuration&gt;
&lt;/monitors&gt;</pre>
<p>This sets the correct rotation (<code>&lt;rotation&gt;right&lt;/rotation&gt;</code>) and a scale factor of 2 (<code>&lt;scale&gt;2&lt;/scale&gt;</code>). For fractional scaling, see <a href="../HiDPI.html#GNOME" title="HiDPI">HiDPI#GNOME</a>.
</p>
<p>For <a href="../GDM.html" title="GDM">GDM</a>, copy the above <code>~/.config/monitors.xml</code> to <code>/var/lib/gdm/.config/monitors.xml</code> to set the correct rotation.
</p>
<h5><span class="mw-headline" id="KDE">KDE</span></h5>
<p>In <i>System Settings &gt; Display and Monitor</i> change <i>Orientation</i> to <i>90° Clockwise</i>, and <i>Scale Display</i> to a comfortable size.
</p>
<h5><span class="mw-headline" id="Right_Click_Emulation_2">Right Click Emulation</span></h5>
<p>Create <code>/etc/X11/xorg.conf.d/50-trackpoint.conf</code> to scroll while holding right click:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/50-trackpoint.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "InputClass"
  Identifier      "GPD trackpoint"
  MatchProduct    "SINO WEALTH Gaming Keyboard"
  MatchIsPointer  "on"
  Driver          "libinput"
  Option          "MiddleEmulation" "1"
  Option          "ScrollButton" "3"
  Option          "ScrollMethod" "button"
EndSection
</pre>
<h5><span class="mw-headline" id="SDDM">SDDM</span></h5>
<p>Change DPI to be readable, append the following lines to <code>/usr/share/sddm/scripts/Xsetup</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/sddm/scripts/Xsetup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Set DPI  
xrandr --dpi 168"  
</pre>
<h5><span class="mw-headline" id="Touchscreen_Gestures">Touchscreen Gestures</span></h5>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/touchegg/">touchegg</a></span><sup><small>AUR</small></sup>, then edit the following line in <code>/usr/share/touchegg/touchegg.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/touchegg/touchegg.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
&lt;action type="SCROLL"&gt;SPEED=7:INVERTED=true&lt;/action&gt;
...</pre>
<p>Create <code>/etc/X11/xinit/xinitrc.d/01_touchegg</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xinit/xinitrc.d/01_touchegg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
#!/bin/bash

# starts touchegg application
PREFIX="$HOME/.config/touchegg/.run"
mkdir -p "$PREFIX"
PIDFILE="$PREFIX/touchegg.$USER$DISPLAY.pid"
LOCK="$PREFIX/touchegg.$USER$DISPLAY.lock"

start_touchegg() {
        (
                flock -n 9 || exit 1
                touchegg 2&gt;/dev/null &gt;/dev/null &amp;
                PID=$!
                echo "$!" &gt;"$PIDFILE"
                wait $PID
        ) 9&gt;"$LOCK"
}

start_touchegg &amp;
</pre>
<p>Set the permissions on <code>/etc/X11/xinit/xinitrc.d/01_touchegg</code>
</p>
<pre># chmod 0755 /etc/X11/xinit/xinitrc.d/01_touchegg
</pre>
<h5>
<span id="Making_use_of_.E5.8D.8A.2F.E5.85.A8_key_on_Pocket_2"></span><span class="mw-headline" id="Making_use_of_半/全_key_on_Pocket_2">Making use of 半/全 key on Pocket 2</span>
</h5>
<p>Out of the box the <code>半/全</code> key is configured to send the <code>`</code> symbol and keycode 49, making it a duplicated of a regular <code>`/~</code> key.
In order to be able to map it to something more useful go to the <a rel="nofollow"  href="https://www.gpd.hk/gpdp2firmware">GPD2 Firmware</a> and download "GPD Pocket 2 Keyboard Firmware (Japan)". This must be flashed with the Windows 10 OS supplied with the device. It is advised to have a USB mouse, since the keyboard and mouse will be disabled during the update.
</p>
<p>After the update is done <code>半/全</code> will send keycode 49 and <code>`</code> symbol, while the dedicated <code>`/~</code> key will send keycode 132. In order to fix this create a file <code>~/.Xmodmap</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.Xmodmap</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">keycode  132 = grave asciitilde
keycode  49  = XF86Launch1 NoSymbol</pre>
<p>Test it immediately 
</p>
<pre>$ xmodmap ~/.Xmodmap
</pre>
<p>For more information read <a href="../Xmodmap.html" title="Xmodmap">xmodmap</a>
</p>
<h4><span class="mw-headline" id="Fan">Fan</span></h4>
<p>With the latest kernel your fan should work out of the box.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are having issues with your fan not functioning as intended - try the following:</div>
<pre># modprobe -r gpd-pocket-fan
# modprobe gpd-pocket-fan temp_limits=40000,40001,40002
</pre>
<p>Once this has been completed - you should hear your fan start up at 40c - if you hear a clicking sound - power off the device, remove the back panel and very gently push the fan around a few times. Then re-attach the panel and power on the device - running the above commands again once logged in. It seems to be an issue with some devices that the fan cannot start properly when it has not been powered on in a while.
</p>
<p>Once you have completed these steps and the fan is working properly - you should then either reboot or reload the fan kernel module in order to return the temperature limits to default:
</p>
<pre># modprobe -r gpd-pocket-fan
# modprobe gpd-pocket-fan
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> By default fan is always spinning when on AC <a rel="nofollow"  href="https://github.com/stockmind/gpd-pocket-ubuntu-respin#gpd-fan-always-spinning-on-ac">[1]</a>. To override this behavior add <code>gpd-pocket-fan.speed_on_ac=0</code> to the <a href="../Kernel_parameters.html" title="Kernel parameters">Kernel parameters</a>.</div>
<h4><span class="mw-headline" id="Power_Saving">Power Saving</span></h4>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=tlp">tlp</a></span> and then edit following lines in <code>/etc/default/tlp</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/default/tlp</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
# improve disk IO
DISK_DEVICES="mmcblk0"
DISK_IOSCHED="deadline"
...
# disable wifi power saving mode (wifi speed drops MASSIVELY!)
WIFI_PWR_ON_AC=off
WIFI_PWR_ON_BAT=off
...</pre>
<h4><span class="mw-headline" id="PulseAudio">PulseAudio</span></h4>
<p>Append the following lines into <code>/etc/pulse/default.pa</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set-card-profile alsa_card.platform-cht-bsw-rt5645 HiFi
set-default-sink alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645_0__sink
set-sink-port alsa_output.platform-cht-bsw-rt5645.HiFi__hw_chtrt5645_0__sink [Out] Speaker
</pre>
<p>Turn off realtime scheduling by editing <code>/etc/pulse/daemon.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">realtime-scheduling = no</pre>
<h4><span class="mw-headline" id="Charge_control">Charge control</span></h4>
<p>It is possible to control the charge current, charge end voltage and a few more settings.
</p>
<p>See <a rel="nofollow"  href="http://reddit.com/r/GPDPocket/comments/cfyekh/limit_battery_charge/eudbwto">this reddit post</a> for more information and an example script.
</p>
<p><br>
</p>
<h2><span class="mw-headline" id="Known_Issues">Known Issues</span></h2>
<h4><span class="mw-headline" id="USB-C_Power_source_status">USB-C Power source status</span></h4>
<p>USB-C power source status does not work on Kernel 4.14-15. Hans' kernel has a patch fixing this.
</p>
<h4><span class="mw-headline" id="systemd-gpt-auto-generator_failed_to_dissect">systemd-gpt-auto-generator failed to dissect</span></h4>
<p>Due to <a rel="nofollow"  href="https://github.com/systemd/systemd/issues/5806">this issue</a>, an error message appears at boot: 
</p>
<p><code>systemd-gpt-auto-generator[199]: Failed to dissect: Input/output error</code>.
</p>
<p>To avoid the error message, add this boot parameter to your boot loader.
</p>
<pre>systemd.gpt_auto=0
</pre>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow"  href="https://github.com/njkli/gpd-pocket/">https://github.com/njkli/gpd-pocket/</a></li>
<li><a rel="nofollow"  href="http://hansdegoede.livejournal.com/">http://hansdegoede.livejournal.com/</a></li>
</ul>
</div></div>
		
		<div id="catlinks"  data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../Category:GPD.html" title="Category:GPD">GPD</a></li></ul>
</div></div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GPD_Pocket&amp;oldid=607059">https://wiki.archlinux.org/index.php?title=GPD_Pocket&amp;oldid=607059</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 21 April 2020, at 11:34.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



