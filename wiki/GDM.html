<!--
    title: GDM
    description: Migration of GDM from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:44:33.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">GDM</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../GNOME.html" title="GNOME">GNOME</a></li>
<li><a href="../Display_manager.html" title="Display manager">Display manager</a></li>
</ul>
</div>
<p>From <a rel="nofollow"  href="https://wiki.gnome.org/Projects/GDM">GDM - GNOME Display Manager</a>: "The GNOME Display Manager (GDM) is a program that manages graphical display servers and handles graphical user logins."
</p>
<p><a href="../Display_manager.html" title="Display manager">Display managers</a> provide <a href="../Xorg.html" class="mw-redirect" title="X Window System">X Window System</a> and <a href="../Wayland.html" title="Wayland">Wayland</a> users with a graphical login prompt.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span >1</span> <span >Installation</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Starting"><span >2</span> <span >Starting</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Autostarting_applications"><span >2.1</span> <span >Autostarting applications</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#Configuration"><span >3</span> <span >Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Log-in_screen_background_image"><span >3.1</span> <span >Log-in screen background image</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#DConf_configuration"><span >3.2</span> <span >DConf configuration</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Log-in_screen_logo"><span >3.2.1</span> <span >Log-in screen logo</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Changing_the_cursor_theme"><span >3.2.2</span> <span >Changing the cursor theme</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Larger_font_for_log-in_screen"><span >3.2.3</span> <span >Larger font for log-in screen</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Turning_off_the_sound"><span >3.2.4</span> <span >Turning off the sound</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Configure_power_button_behavior"><span >3.2.5</span> <span >Configure power button behavior</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Enabling_tap-to-click"><span >3.2.6</span> <span >Enabling tap-to-click</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Disable/Enable_Accessibility_Menu"><span >3.2.7</span> <span >Disable/Enable Accessibility Menu</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Keyboard_layout"><span >3.3</span> <span >Keyboard layout</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Change_the_language"><span >3.4</span> <span >Change the language</span></a></li>
<li class="toclevel-2 tocsection-16">
<a href="#Users_and_login"><span >3.5</span> <span >Users and login</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Automatic_login"><span >3.5.1</span> <span >Automatic login</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Passwordless_login"><span >3.5.2</span> <span >Passwordless login</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#Passwordless_shutdown_for_multiple_sessions"><span >3.5.3</span> <span >Passwordless shutdown for multiple sessions</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Enable_root_login_in_GDM"><span >3.5.4</span> <span >Enable root login in GDM</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#Hide_user_from_login_list"><span >3.5.5</span> <span >Hide user from login list</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-22"><a href="#Setup_default_monitor_settings"><span >3.6</span> <span >Setup default monitor settings</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Configure_X_server_access_permission"><span >3.7</span> <span >Configure X server access permission</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24">
<a href="#Troubleshooting"><span >4</span> <span >Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="#Wayland_and_the_proprietary_NVIDIA_driver"><span >4.1</span> <span >Wayland and the proprietary NVIDIA driver</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Failure_on_logout"><span >4.2</span> <span >Failure on logout</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Rootless_Xorg"><span >4.3</span> <span >Rootless Xorg</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Use_Xorg_backend"><span >4.4</span> <span >Use Xorg backend</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#GDM_freezes_with_systemd"><span >4.5</span> <span >GDM freezes with systemd</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#GDM_does_not_start_until_input_is_provided"><span >4.6</span> <span >GDM does not start until input is provided</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Incomplete_removal_of_gdm"><span >4.7</span> <span >Incomplete removal of gdm</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#GDM_auto-suspend_(GNOME_3.28)"><span >4.8</span> <span >GDM auto-suspend (GNOME 3.28)</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#GDM_ignore_Wayland_and_use_X.Org_by_default"><span >4.9</span> <span >GDM ignore Wayland and use X.Org by default</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-34"><a href="#See_also"><span >5</span> <span >See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>GDM can be <a href="../Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installed</a> with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gdm">gdm</a></span> package, and it is installed as part of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/groups/x86_64/gnome/">gnome</a></span> group.
</p>
<p>If you would prefer to use legacy GDM which was used in GNOME 2 and has its own configuration utility, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/gdm-old/">gdm-old</a></span><sup><small>AUR</small></sup> package. Note that the rest of this article discusses current GDM, not legacy GDM, unless indicated otherwise.
</p>
<p>You might also wish to install the following:
</p>
<ul><li>
<b>gdm3setup</b> — An interface to configure GDM3, autologin options and change Shell theme</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://github.com/Nano77/gdm3setup">https://github.com/Nano77/gdm3setup</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/gdm3setup/">gdm3setup</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h2><span class="mw-headline" id="Starting">Starting</span></h2>
<p>To start GDM at boot time <a href="../Systemd.html#Using_units" class="mw-redirect" title="Enable">enable</a> <code>gdm.service</code>.
</p>
<h3><span class="mw-headline" id="Autostarting_applications">Autostarting applications</span></h3>
<p>One might want to autostart certain commands, such as <i>xrandr</i> for instance, on login. This can be achieved by adding a command or script to a location that is sourced by the display manager. See <a href="../Display_manager.html#Autostarting" title="Display manager">Display manager#Autostarting</a> for a list of supported locations. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The <code>/etc/gdm/Init</code> directory is no longer a supported location, see <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=751602#c2">[1]</a>.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Log-in_screen_background_image">Log-in screen background image</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Configuration is not persistent and will be gone after gdm update. Needs to be rewritten to enable user-themes gnome-shell extension for gdm user and use custom theme and set gsetting to use that theme (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:GDM">Talk:GDM#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Since GNOME 3.16, GNOME Shell themes are now stored as binary files (gresource).</li>
<li>This change will be overwritten on subsequent updates of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-shell">gnome-shell</a></span>.</li>
</ul>
</div>
<p>Firstly, you need to extract the existing GNOME Shell theme to a folder in your home directory. You can do this using the following script:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">extractgst.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
gst=/usr/share/gnome-shell/gnome-shell-theme.gresource
workdir=${HOME}/shell-theme

for r in `gresource list $gst`; do
	r=${r#\/org\/gnome\/shell/}
	if [ ! -d $workdir/${r%/*} ]; then
	  mkdir -p $workdir/${r%/*}
	fi
done

for r in `gresource list $gst`; do
        gresource extract $gst $r &gt;$workdir/${r#\/org\/gnome\/shell/}
done</pre>
<p>Navigate to the created directory. You should find that the theme files have been extracted to it. Now copy your preferred background image to this directory.
</p>
<p>Next, you need to create a file in the directory with the following content:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">gnome-shell-theme.gresource.xml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;gresources&gt;
  &lt;gresource prefix="/org/gnome/shell/theme"&gt;
    &lt;file&gt;calendar-today.svg&lt;/file&gt;
    &lt;file&gt;checkbox-focused.svg&lt;/file&gt;
    &lt;file&gt;checkbox-off-focused.svg&lt;/file&gt;
    &lt;file&gt;checkbox-off.svg&lt;/file&gt;
    &lt;file&gt;checkbox.svg&lt;/file&gt;
    &lt;file&gt;dash-placeholder.svg&lt;/file&gt;
    &lt;file&gt;gnome-shell.css&lt;/file&gt;
    &lt;file&gt;gnome-shell-high-contrast.css&lt;/file&gt;
    &lt;file&gt;icons/message-indicator-symbolic.svg&lt;/file&gt;
    &lt;file&gt;icons/pointer-double-click-symbolic.svg&lt;/file&gt;
    &lt;file&gt;icons/pointer-drag-symbolic.svg&lt;/file&gt;
    &lt;file&gt;icons/pointer-primary-click-symbolic.svg&lt;/file&gt;
    &lt;file&gt;icons/pointer-secondary-click-symbolic.svg&lt;/file&gt;
    &lt;file&gt;key-enter.svg&lt;/file&gt;
    &lt;file&gt;key-hide.svg&lt;/file&gt;
    &lt;file&gt;key-layout.svg&lt;/file&gt;
    &lt;file&gt;key-shift-latched-uppercase.svg&lt;/file&gt;
    &lt;file&gt;key-shift.svg&lt;/file&gt;
    &lt;file&gt;key-shift-uppercase.svg&lt;/file&gt;
    &lt;file&gt;no-events.svg&lt;/file&gt;
    &lt;file&gt;noise-texture.png&lt;/file&gt;
    &lt;file&gt;<b>filename</b>&lt;/file&gt;
    &lt;file&gt;no-notifications.svg&lt;/file&gt;
    &lt;file&gt;pad-osd.css&lt;/file&gt;
    &lt;file&gt;process-working.svg&lt;/file&gt;
    &lt;file&gt;toggle-off-dark.svg&lt;/file&gt;
    &lt;file&gt;toggle-off-hc.svg&lt;/file&gt;
    &lt;file&gt;toggle-off.svg&lt;/file&gt;
    &lt;file&gt;toggle-on-dark.svg&lt;/file&gt;
    &lt;file&gt;toggle-on-hc.svg&lt;/file&gt;
    &lt;file&gt;toggle-on.svg&lt;/file&gt;
  &lt;/gresource&gt;
&lt;/gresources&gt;</pre>
<p>Replace <b>filename</b> with the filename of your background image.
</p>
<p>Now, open the <code>gnome-shell.css</code> file in the directory and change the <code>#lockDialogGroup</code> definition as follows:
</p>
<pre>#lockDialogGroup {
  background: #2e3436 url(<b>filename</b>);
  background-size: <b>[WIDTH]</b>px <b>[HEIGHT]</b>px;
  background-repeat: no-repeat;
}
</pre>
<p>Set <code>background-size</code> to the resolution that GDM uses, this might not necessarily be the resolution of the image. For a list of display resolutions see <a href="https://en.wikipedia.org/wiki/Display_resolution#Computer_monitors"  title="wikipedia:Display resolution">Display resolution</a>. Again, set <b>filename</b> to be the name of the background image.
</p>
<p>Finally, compile the theme using the following command:
</p>
<pre>$ glib-compile-resources gnome-shell-theme.gresource.xml
</pre>
<p>Then copy the resulting <code>gnome-shell-theme.gresource</code> file to the <code>/usr/share/gnome-shell</code> directory.
</p>
<p>Then restart <code>gdm.service</code> (note that simply logging out is not enough) and you should find that it is using your preferred background image.
</p>
<p>For more information, please see the following <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=197036">forum thread</a>. A shell script to automate the above steps is available on <a rel="nofollow"  href="https://github.com/DimaZirix/fedora-gdm-wallpaper">DimaZirix's github repository</a>.
</p>
<h3><span class="mw-headline" id="DConf_configuration">DConf configuration</span></h3>
<p>Some GDM settings are stored in a DConf database. They can be configured either by adding <i>keyfiles</i> to the <code>/etc/dconf/db/gdm.d</code> directory and then recompiling the GDM database by running <code>dconf update</code> as root or by logging into the GDM user on the system and changing the setting directly using the <i>gsettings</i> command line tool. Note that for the former approach, a GDM profile file is required - this must be created manually as it is no longer shipped upstream, see below:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/profile/gdm</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">user-db:user
system-db:gdm
file-db:/usr/share/gdm/greeter-dconf-defaults</pre>
<p>For the latter approach, you can log into the GDM user with the command below:
</p>
<pre># machinectl shell gdm@ /bin/bash
</pre>
<h4><span class="mw-headline" id="Log-in_screen_logo">Log-in screen logo</span></h4>
<p>Either create the following keyfile
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/02-logo</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/login-screen]
logo='<i>/path/to/logo.png</i>'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.login-screen logo '<i>/path/to/logo.png</i>'
</pre>
<h4><span class="mw-headline" id="Changing_the_cursor_theme">Changing the cursor theme</span></h4>
<p>GDM disregards <a href="../GNOME.html" title="GNOME">GNOME</a> cursor theme settings and it also ignores the cursor theme set according to the <a href="../Cursor_themes.html#XDG_specification" title="Cursor themes">XDG specification</a>. To change the cursor theme used in GDM, either create the following keyfile
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/10-cursor-settings</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/desktop/interface]
cursor-theme='<i>theme-name'</i>
</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.interface cursor-theme '<i>theme-name</i>'
</pre>
<h4><span class="mw-headline" id="Larger_font_for_log-in_screen">Larger font for log-in screen</span></h4>
<p>Click on the accessibility icon at the top right of the screen (a white circle with the silhouette of a person in the centre) and check the <i>Large Text</i> option.
</p>
<p>To set a specific scaling factor, you can create the following keyfile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/03-scaling</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/desktop/interface]
text-scaling-factor='<i>1.25</i>'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.interface text-scaling-factor '<i>1.25</i>'
</pre>
<h4><span class="mw-headline" id="Turning_off_the_sound">Turning off the sound</span></h4>
<p>This tweak disables the audible feedback heard when the system volume is adjusted (via keyboard) on the login screen.
</p>
<p>Either create the following keyfile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/04-sound</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/desktop/sound]
event-sounds='false'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.sound event-sounds 'false'
</pre>
<h4><span class="mw-headline" id="Configure_power_button_behavior">Configure power button behavior</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>The <a href="../Power_management.html#ACPI_events" title="Power management">logind settings</a> for the power button are overriden by GNOME Settings Daemon. <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=755953#c4">[2]</a>
</li>
<li>As of GDM 3.18, the power button cannot be set to <i>interactive</i>. <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=753713#c6">[3]</a>
</li>
<li>In some cases, this setting will be ignored and hardcoded defaults will be used. <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=755953#c17">[4]</a>
</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Please note that the <a href="../Acpid.html" title="Acpid">acpid</a> daemon also handles the "power button" and "hibernate button" events. Running both systems at the same time may lead to unexpected behaviour.</div>
<p>Either create the following keyfile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/05-power</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/settings-daemon/plugins/power]
power-button-action='<i>action</i>'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.settings-daemon.plugins.power power-button-action '<i>action</i>'
</pre>
<p>where <i>action</i> can be one of <code>nothing</code>, <code>suspend</code> or <code>hibernate</code>.
</p>
<h4><span class="mw-headline" id="Enabling_tap-to-click">Enabling tap-to-click</span></h4>
<p>Tap-to-click is disabled in GDM (and GNOME) by default, but you can easily enable it with a dconf setting.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you want to do this under X, you have to first set up correct X server access permissions - see <a href="#Configure_X_server_access_permission">#Configure X server access permission</a>.</div>
<p>To enable tap-to-click, either create the following keyfile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/06-tap-to-click</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/desktop/peripherals/touchpad]
tap-to-click='true'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.peripherals.touchpad tap-to-click 'true'
</pre>
<h4>
<span id="Disable.2FEnable_Accessibility_Menu"></span><span class="mw-headline" id="Disable/Enable_Accessibility_Menu">Disable/Enable Accessibility Menu</span>
</h4>
<p>To disable or enable the Accessibility Menu, either create the following keyfile:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/dconf/db/gdm.d/07-accessibility</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[org/gnome/desktop/interface]
toolkit-accessibility='<i>boolean</i>'</pre>
<p>and then recompile the GDM database or alternatively log in to the GDM user and execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.interface toolkit-accessibility '<i>boolean</i>'
</pre>
<p>The menu is disabled when the key is <code>false</code>, enabled when it is <code>true</code>.
</p>
<h3><span class="mw-headline" id="Keyboard_layout">Keyboard layout</span></h3>
<p>The system keyboard layout will be applied to GDM. See <a href="../Xorg/Keyboard_configuration.html#Using_X_configuration_files" class="mw-redirect" title="Keyboard configuration in Xorg">Keyboard configuration in Xorg#Using X configuration files</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> See <a href="https://en.wikipedia.org/wiki/ISO_3166-1"  title="wikipedia:ISO 3166-1">Wikipedia:ISO 3166-1</a> for a list of keymaps.</div>
<p>If a system has multiple users, it is possible to specify a keyboard layout for GDM to use which is different from the system keyboard layout. Firstly, ensure the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-control-center">gnome-control-center</a></span> is installed. Then start <i>gnome-control-center</i> and navigate to <i>Region &amp; Language -&gt; Input Sources</i>. In the header bar, hit the <i>Login Screen</i> toggle button and then choose a keyboard layout from the list. Note that the <i>Login Screen</i> button will not be visible in the header bar unless multiple users are present on the system <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=741500">[5]</a>.
</p>
<p>Users of GDM 2.x (legacy GDM) may need to edit <code>~/.dmrc</code> as shown below:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.dmrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Desktop]
Language=de_DE.UTF-8   # change to your default lang
Layout=de   nodeadkeys # change to your keyboard layout</pre>
<h3><span class="mw-headline" id="Change_the_language">Change the language</span></h3>
<p>The system language will be applied to GDM. If a system has multiple users, it is possible to set a language for GDM different to the system language. In this case, firstly ensure that <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-control-center">gnome-control-center</a></span> is installed. Then, start <i>gnome-control-center</i> and choose <i>Region &amp; Language</i>. In the header bar, check the <i>Login Screen</i> toggle button. Finally, click on <i>Language</i> and choose your language from the list. You will be prompted for your root password. Note that the <i>Login Screen</i> button will not be visible in the header bar unless multiple users are present on the system <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=741500">[6]</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> By adding 2 different input languages, logging out then selecting your default language GDM will remember your choice once the second option is removed.</div>
<h3><span class="mw-headline" id="Users_and_login">Users and login</span></h3>
<h4><span class="mw-headline" id="Automatic_login">Automatic login</span></h4>
<p>To enable automatic login with GDM, add the following to <code>/etc/gdm/custom.conf</code> (replace <i>username</i> with your own):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/gdm/custom.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Enable automatic login for user
[daemon]
AutomaticLogin=<i>username</i>
AutomaticLoginEnable=True</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If GDM fails after adding these lines, comment them out from a TTY.</div>
<p>or for an automatic login with a delay:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/gdm/custom.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[daemon]

TimedLoginEnable=true
TimedLogin=<i>username</i>
TimedLoginDelay=1</pre>
<p>You can set the session used for automatic login (replace <code>gnome-xorg</code> with desired session):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/AccountsService/users/<i>username</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">XSession=gnome-xorg</pre>
<h4><span class="mw-headline" id="Passwordless_login">Passwordless login</span></h4>
<p>If you want to bypass the password prompt in GDM then simply add the following line on the first line of <code>/etc/pam.d/gdm-password</code>:
</p>
<pre>auth sufficient pam_succeed_if.so user ingroup nopasswdlogin
</pre>
<p>Then, add the group <code>nopasswdlogin</code> to your system. See <a href="../Users_and_groups.html#Group_management" class="mw-redirect" title="User group">User group</a> for group descriptions and group management commands.
</p>
<p>Now, add your user to the <code>nopasswdlogin</code> group and you will only have to click on your username to login.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>Do <b>not</b> do this for a <b>root</b> account.</li>
<li>You won't be able to change your session type at login with GDM anymore. If you want to change your default session type, you will first need to remove your user from the <code>nopasswdlogin</code> group.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Passwordless_shutdown_for_multiple_sessions">Passwordless shutdown for multiple sessions</span></h4>
<p>GDM uses polkit and logind to gain permissions for shutdown. You can shutdown the system when multiple users are logged in by setting:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/polkit-1/localauthority.conf.d/org.freedesktop.logind.policy</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE policyconfig PUBLIC
 "-//freedesktop//DTD PolicyKit Policy Configuration 1.0//EN"
 "<a rel="nofollow"  href="http://www.freedesktop.org/standards/PolicyKit/1.0/policyconfig.dtd">http://www.freedesktop.org/standards/PolicyKit/1.0/policyconfig.dtd</a>"&gt;


&lt;policyconfig&gt;

  &lt;action id="org.freedesktop.login1.power-off-multiple-sessions"&gt;
    &lt;description&gt;Shutdown the system when multiple users are logged in&lt;/description&gt;
    &lt;message&gt;System policy prevents shutting down the system when other users are logged in&lt;/message&gt;
    &lt;defaults&gt;
      &lt;allow_inactive&gt;yes&lt;/allow_inactive&gt;
      &lt;allow_active&gt;yes&lt;/allow_active&gt;
    &lt;/defaults&gt;
  &lt;/action&gt;

&lt;/policyconfig&gt;</pre>
<p>You can find all available logind options (e.g. reboot-multiple-sessions) <a rel="nofollow"  href="http://www.freedesktop.org/wiki/Software/systemd/logind#Security">here</a>.
</p>
<h4><span class="mw-headline" id="Enable_root_login_in_GDM">Enable root login in GDM</span></h4>
<p>It is not advised to login as root, but if necessary you can edit <code>/etc/pam.d/gdm-password</code> and add the following line before the line <code>auth required pam_deny.so</code>:
</p>
<p><code>/etc/pam.d/gdm-password</code>
</p>
<pre>auth            sufficient      pam_succeed_if.so uid eq 0 quiet
</pre>
<p>The file should look something like this:
</p>
<p><code>/etc/pam.d/gdm-password</code>
</p>
<pre>...
auth            sufficient      pam_succeed_if.so uid eq 0 quiet
auth            sufficient      pam_succeed_if.so uid &gt;= 1000 quiet
auth            required        pam_deny.so
...
</pre>
<p>You should be able to login as root after restarting GDM.
</p>
<h4><span class="mw-headline" id="Hide_user_from_login_list">Hide user from login list</span></h4>
<p>The users for the gdm user list are gathered by <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/AccountsService/">AccountsService</a>. It will automatically hide system users (UID &lt; 1000).
To hide ordinary users from the login list create or edit a file named after the user to hide in <code>/var/lib/AccountsService/users/</code> to contain at least:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/lib/AccountsService/users/<i>username</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[User]
SystemAccount=true</pre>
<h3><span class="mw-headline" id="Setup_default_monitor_settings">Setup default monitor settings</span></h3>
<p>Some <a href="../Desktop_environment.html" class="mw-redirect" title="Desktop environments">desktop environments</a> store display settings in <code>~/.config/monitors.xml</code>. <i>xrandr</i> commands are then generated on the base of the file content. GDM has a similar file stored in <code>/var/lib/gdm/.config/monitors.xml</code>.    
</p>
<p>If you have your monitors setup as you like (orientation, scaling, primary and so on) in <code>~/.config/monitors.xml</code> and want GDM to honor those settings:
</p>
<pre># cp ~/.config/monitors.xml /var/lib/gdm/.config/
# chown gdm:gdm /var/lib/gdm/.config/monitors.xml
</pre>
<p>The relevant parts of <code>monitors.xml</code> for screen rotation and scaling are:
</p>
<pre>&lt;monitors version="2"&gt;
  &lt;configuration&gt;
    &lt;logicalmonitor&gt;
      ...
      &lt;scale&gt;2&lt;/scale&gt;
      ...
      &lt;transform&gt;
        &lt;rotation&gt;right&lt;/rotation&gt;
        &lt;flipped&gt;no&lt;/flipped&gt;
      &lt;/transform&gt;
      ...
    &lt;/logicalmonitor&gt;
  &lt;/configuration&gt;
&lt;/monitors&gt;
</pre>
<p>Changes will take effect on logout.  This is necessary because GDM does not respect <code>xorg.conf</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you use GDM under Wayland, you must also use a <code>monitors.xml</code> that was created under Wayland. See <a rel="nofollow"  href="https://gitlab.gnome.org/GNOME/gdm/issues/224">GDM bug 224</a> for more info. Alternatively, you can force GDM to <a href="#Use_Xorg_backend">#Use Xorg backend</a>, and use a <code>monitors.xml</code> that was created under Xorg.</div>
<h3><span class="mw-headline" id="Configure_X_server_access_permission">Configure X server access permission</span></h3>
<p>You can use the <code>xhost</code> command to configure X server access permissions.
</p>
<p>For instance, to grant GDM the right to access the X server, use the following command:
</p>
<pre># xhost +SI:localuser:gdm</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Wayland_and_the_proprietary_NVIDIA_driver">Wayland and the proprietary NVIDIA driver</span></h3>
<p>GDM doesn't work well in Wayland mode with the proprietary <a href="../NVIDIA.html" title="NVIDIA">NVIDIA</a> driver. When using this driver, GDM will use Xorg instead.<a rel="nofollow"  href="https://gitlab.gnome.org/GNOME/gdm/merge_requests/46">[7]</a>
</p>
<p>To force-enable Wayland, disable the <a href="../Udev.html" title="Udev">udev</a> rule responsible for disabling Wayland in GDM:
</p>
<pre># ln -s /dev/null /usr/lib/udev/rules.d/61-gdm.rules
</pre>
<h3><span class="mw-headline" id="Failure_on_logout">Failure on logout</span></h3>
<p>If GDM starts up properly on boot, but fails after repeated attempts on logout, try adding this line to the daemon section of <code>/etc/gdm/custom.conf</code>:
</p>
<pre>GdmXserverTimeout=60
</pre>
<h3><span class="mw-headline" id="Rootless_Xorg">Rootless Xorg</span></h3>
<p>See <a href="../Xorg.html#Rootless_Xorg" title="Xorg">Xorg#Rootless Xorg</a>.
</p>
<h3><span class="mw-headline" id="Use_Xorg_backend">Use Xorg backend</span></h3>
<p>The <a href="../Wayland.html" title="Wayland">Wayland</a> backend is used by default, and the <a href="../Xorg.html" title="Xorg">Xorg</a> backend is used only if the Wayland backend cannot be started. You may wish to use the Xorg backend instead if, for example:
</p>
<ul>
<li>The screen <a rel="nofollow"  href="https://bugzilla.redhat.com/show_bug.cgi?id=1199890">flickers</a>
</li>
<li>GDM <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=249334">crashes</a>
</li>
</ul>
<p>To use the Xorg backend by default, uncomment the following line in <code>/etc/gdm/custom.conf</code>:
</p>
<pre>#WaylandEnable=false
</pre>
<h3><span class="mw-headline" id="GDM_freezes_with_systemd">GDM freezes with systemd</span></h3>
<p>If GDM gets hang-up with <code>systemctl enable gdm</code> and <code>systemctl start gdm</code> works as expected, apply the config with <code>systemctl edit gdm</code> as below:
</p>
<pre> [Service]
 Type=idle
</pre>
<h3><span class="mw-headline" id="GDM_does_not_start_until_input_is_provided">GDM does not start until input is provided</span></h3>
<p>If, after booting, the screen stays black and GDM does not start until the mouse is moved or something is typed on the keyboard, it may be due to a lack of entropy required for random number generation. To confirm, check that the following line appears inside <i>systemd-random-seed</i>’s log (which can be read using <code>journalctl --unit systemd-random-seed</code>):
</p>
<pre>Kernel entropy pool is not initialized yet, waiting until it is.
</pre>
<p>To fix this, you can pass the <code>random.trust_cpu=on</code> <a href="../Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> if your CPU supports the <i>RDRAND</i> instruction, or you can use <a href="../Haveged.html" title="Haveged">haveged</a> which also provides entropy, albeit it is of allegedly low quality. See <a href="https://wiki.debian.org/BoottimeEntropyStarvation"  title="debian:BoottimeEntropyStarvation">Debian’s article on the topic</a> for other solutions.
</p>
<h3><span class="mw-headline" id="Incomplete_removal_of_gdm">Incomplete removal of gdm</span></h3>
<p>After removing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gdm">gdm</a></span>, <a href="../Systemd.html" title="Systemd">systemd</a> may report the following:
</p>
<pre>user 'gdm': directory '/var/lib/gdm' does not exist
</pre>
<p>To remove this warning, login as root and delete the primary user "gdm" and then delete the group "gdm":
</p>
<pre># userdel gdm
# groupdel gdm
</pre>
<p>Verify that gdm is successfully removed via <code>pwck</code> and <code>grpck</code>. To round it off, you may want to double-check no <a href="../Pacman/Tips_and_tricks.html#Identify_files_not_owned_by_any_package" title="Pacman/Tips and tricks">unowned files</a> for gdm remain.
</p>
<h3>
<span id="GDM_auto-suspend_.28GNOME_3.28.29"></span><span class="mw-headline" id="GDM_auto-suspend_(GNOME_3.28)">GDM auto-suspend (GNOME 3.28)</span>
</h3>
<p>GDM uses a separate dconf database to control power management. You can make GDM behave the same way as user sessions by copying the user settings to GDM's dconf database.
</p>
<pre>$ IFS=$'\n'; for x in $(sudo -u <i>username</i> gsettings list-recursively org.gnome.settings-daemon.plugins.power); do eval "sudo -u gdm dbus-launch gsettings set $x"; done; unset IFS
</pre>
<p>where <code><i>username</i></code> is your user's name.
</p>
<p>Or to simply disable auto-suspend (also run the command with <code>ac</code> replaced with <code>battery</code> to also disable it while running on battery):
</p>
<pre>$ sudo -u gdm dbus-launch gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-ac-type 'nothing'
</pre>
<h3><span class="mw-headline" id="GDM_ignore_Wayland_and_use_X.Org_by_default">GDM ignore Wayland and use X.Org by default</span></h3>
<p>Wayland requires Kernel Mode Setting (KMS) running in order to work, and on some machines the GDM process start earlier than KMS, resulting in GDM unable to see Wayland and working only with X.Org. This might result in messages like the following showing up in your log:
</p>
<pre> gnome-shell[569]: Failed to open gpu '/dev/dri/card0': GDBus.Error:org.freedesktop.DBus.Error.AccessDenied: Operation not permitted
 gnome-shell[569]: Failed to create backend: No GPUs found
 systemd[505]: gnome-shell-wayland.service: Failed with result 'protocol'.
 systemd[505]: Failed to start GNOME Shell on Wayland.
</pre>
<p>You can solve this problem by <a href="../Kernel_mode_setting.html#Early_KMS_start" title="Kernel mode setting">starting KMS earlier</a>.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow"  href="https://help.gnome.org/admin/gdm/stable/index.html.en">GDM Reference Manual</a></li></ul>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../Category:Display_managers.html" title="Category:Display managers">Display managers</a></li>
<li><a href="../Category:GNOME.html" title="Category:GNOME">GNOME</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GDM&amp;oldid=615007">https://wiki.archlinux.org/index.php?title=GDM&amp;oldid=615007</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 22 May 2020, at 13:39.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



