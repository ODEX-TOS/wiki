<!--
    title: Lenovo_yoga_730
    description: Migration of Lenovo_yoga_730 from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:58:55.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Lenovo yoga 730</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Install"><span >1</span> <span >Install</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Packages"><span >1.1</span> <span >Packages</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Suspend"><span >2</span> <span >Suspend</span></a></li>
<li class="toclevel-1 tocsection-4">
<a href="#Backlight"><span >3</span> <span >Backlight</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Fingerprint_reader"><span >3.1</span> <span >Fingerprint reader</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#Thunderbolt_3"><span >3.2</span> <span >Thunderbolt 3</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#eGPU"><span >3.2.1</span> <span >eGPU</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Dock_Stations"><span >3.2.2</span> <span >Dock Stations</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Tablet_mode"><span >3.3</span> <span >Tablet mode</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Pen"><span >3.4</span> <span >Pen</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#External_display"><span >3.5</span> <span >External display</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Issues"><span >4</span> <span >Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#USB-C_Charging"><span >4.1</span> <span >USB-C Charging</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Install">Install</span></h2>
<h3><span class="mw-headline" id="Packages">Packages</span></h3>
<table >
<caption>Packages to install
</caption>
<tbody>
<tr>
<th>Package</th>
<th>purpose
</th>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=iio-sensor-proxy">iio-sensor-proxy</a></span></td>
<td>Auto brightness
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bolt">bolt</a></span></td>
<td>Thunderbolt 3
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xf86-input-wacom">xf86-input-wacom</a></span></td>
<td>Digitiser/Pen support
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia">nvidia</a></span></td>
<td>For external GPU
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=intel-compute-runtime">intel-compute-runtime</a></span></td>
<td>For OpenCL CPU support
</td>
</tr>
</tbody>
</table>
<h2><span class="mw-headline" id="Suspend">Suspend</span></h2>
<p>If closing the lid doesn't suspend. In <code>/etc/systemd/logind.conf</code> uncomment the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/logind.conf/etc/systemd/logind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HandleSuspendKey=suspend
HandleLidSwitch=suspend</pre>
<h2><span class="mw-headline" id="Backlight">Backlight</span></h2>
<p>Works in gnome but can be reduced so far that it goes off, leaving the screen black.
</p>
<p>One of these kernel parameters might fix this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">kernel parameters</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">acpi_backlight=video
acpi_backlight=vendor
acpi_backlight=native</pre>
<p>Installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=iio-sensor-proxy">iio-sensor-proxy</a></span> does auto brightness.
</p>
<h3><span class="mw-headline" id="Fingerprint_reader">Fingerprint reader</span></h3>
<p>The device is <code>Bus 001 Device 005: ID 06cb:0081 Synaptics, Inc. </code>
Nether <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/groups/x86_64/fprint/">fprint</a></span> nor <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/thinkfinger/">thinkfinger</a></span><sup><small>AUR</small></sup> work, but there is a prototype driver <a rel="nofollow"  href="https://github.com/nmikhailov/Validity90">here</a>.
</p>
<h3><span class="mw-headline" id="Thunderbolt_3">Thunderbolt 3</span></h3>
<p>
Works once you install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bolt">bolt</a></span>.  </p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> TODO: Add links to authoritative information on tb3</div>
<p> This can be temperamental, it may require unplugging and re-plugging the eGPU.
</p>
<h4><span class="mw-headline" id="eGPU">eGPU</span></h4>
<p>This was tested with a Gigabyte Aorus 1070. <a href="../wiki/Bumblebee.html" title="Bumblebee">Bumblebee</a> might blacklist the nvidia module, comment out the nvidia modules in <code>/usr/lib/modprobe.d/bumblebee.conf</code> so that it looks like this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/modprobe.d/bumblebee.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#blacklist nvidia
#blacklist nvidia-drm
#blacklist nvidia-modeset
#blacklist nvidia-uvm
blacklist nouveau</pre>
<p>The following allows Xorg to use the GPU if it exists - you'll need to ether delay the Xorg startup or restart it once the device is fully active.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">xorg.conf for both external and internal graphics</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "ServerLayout"
    Identifier  "eGPU"
    # The two screens allow the server to start in one of two modes
    Screen 0 "eGPUScreen"
    Inactive "Intel"   
    Screen 1 "IntelScreen"
EndSection

Section "Device"
    Identifier  "eGPU"
    Driver      "nvidia"
    VendorName  "NVIDIA Corporation"
    Option "NoLogo" "true"
    Option "AllowEmptyInitialConfiguration"
    Option "AllowExternalGpus"
EndSection

Section "Device"
    Identifier   "Intel"
    Driver       "intel"
    VendorName   "Intel"
EndSection

Section "Screen"
    Identifier "eGPUScreen"
    Device     "eGPU"
EndSection

Section "Screen"
    Identifier "IntelScreen"
    Device     "Intel"
EndSection
</pre>
<p>You can use this script to delay the display manager until the device is fully configured.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/wait-for-egpu.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
DEVICE=/dev/dri/card1

# switch to our vt to see the messages
chvt 2
delay=30
wait=1

#while [ \( ! -c "$DEVICE" \) -a $delay -gt 1 -a `cat /sys/class/power_supply/AC*/online` != "1" ] ; do
while [ $wait -gt 0 -a $delay -gt 1 ]; do

        if [ \( -c "$DEVICE" \) -a `cat /sys/class/power_supply/AC*/online` == "1" ] ; then
                echo $'\e[32;1meGPU present, on AC power.\e[0m'
        elif [ -c "$DEVICE" ]; then
                echo $'\e[33;1meGPU present but no power.\e[0m'
        else
                echo $'\e[31;1mNo eGPU.\e[0m'
        fi

        echo "Press 'Y' to continue to Login. Press 'W' to wait forever. Any other key to rescan."

        if read -r -s -n 1 -t 5 key ; then

                if [ "$key" == "y" -o "$key" == "Y" ]; then
                        wait=0
                elif [ "$key" == "w" -o "$key" == "W" ]; then
                        wait=2
                fi
        elif [ $wait -eq 1 ]; then
                let "delay -= 5"
                echo "Waiting for ${delay} more seconds for eGPU."
        fi

done</pre>
<p>Add the <a href="../wiki/Systemd.html" title="Systemd">systemd</a> setup file below and activate it with <code>systemctl daemon-reload</code> and <code>systemctl enable wait-for-egpu</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/wait-for-egpu.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Simple interactive dialog window
After=getty@tty2.service
Before=display-manager.service

[Service]
Type=oneshot
ExecStart=/usr/local/bin/wait-for-egpu.sh
StandardInput=tty
TTYPath=/dev/tty2
TTYReset=yes
TTYVHangup=yes

[Install]
WantedBy=multi-user.target</pre>
<h4><span class="mw-headline" id="Dock_Stations">Dock Stations</span></h4>
<table >
<caption>Wavlink USB-C Ultra 5K Universal Docking Station
</caption>
<tbody>
<tr>
<th>Feature</th>
<th>Status
</th>
</tr>
<tr>
<td>USB-C</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>USB 3.0</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>Audio Jack</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>Gigabit Ethernet</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>HDMI 1 &amp; 2</td>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">Only X11, requires <a href="../wiki/DisplayLink.html" title="DisplayLink">DisplayLink</a>
</td>
</tr>
<tr>
<td>DisplayPort 1 &amp; 2</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">Untested
</td>
</tr>
<tr>
<td>5K Combo (Joined DisplayPorts)</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">Untested
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Some Windows Managers running in Wayland will freeze your system completely if there is a display connected to the dock station, requiring a reboot. This is the case of SwayWM.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> DisplayLink has stated <a rel="nofollow"  href="https://support.displaylink.com/forums/287786-displaylink-feature-suggestions/suggestions/16639654-linux-wayland-support">here</a> that they are working to bring eGPU/DisplayLink multimonitor support to Wayland through GNOME and a <a rel="nofollow"  href="https://gitlab.gnome.org/GNOME/mutter/commit/d4bea60e1aab8e58bd2925d24256ddfdd125dbdb">patch was submitted for GNOME 3.32</a>
</div>
<h3><span class="mw-headline" id="Tablet_mode">Tablet mode</span></h3>
<p>Try gnome extension slide-for-keyboard, keyboard automatically disables under gnome.
</p>
<h3><span class="mw-headline" id="Pen">Pen</span></h3>
<p>install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xf86-input-wacom">xf86-input-wacom</a></span>
</p>
<h3><span class="mw-headline" id="External_display">External display</span></h3>
<p>HDMI on USB-C adapter just works
</p>
<h2><span class="mw-headline" id="Issues">Issues</span></h2>
<h3><span class="mw-headline" id="USB-C_Charging">USB-C Charging</span></h3>
<p>With the Gigabyte Aorus 1070 Gaming box, the charging sometimes stops. Doesn't seem to happen in Windows.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../wiki/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div></div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_yoga_730&amp;oldid=571643">https://wiki.archlinux.org/index.php?title=Lenovo_yoga_730&amp;oldid=571643</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 20 April 2019, at 08:35.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../wiki/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../wiki/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../wiki/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



