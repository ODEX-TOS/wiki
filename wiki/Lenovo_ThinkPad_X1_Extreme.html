<!--
    title: Lenovo_ThinkPad_X1_Extreme
    description: Migration of Lenovo_ThinkPad_X1_Extreme from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-28T17:58:55.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Lenovo ThinkPad X1 Extreme</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../wiki/Laptop/Lenovo.html" title="Laptop/Lenovo">Laptop/Lenovo</a></li>
<li><a href="../wiki/Lenovo_ThinkPad_X1_Extreme_(Gen_2).html" title="Lenovo ThinkPad X1 Extreme (Gen 2)">Lenovo ThinkPad X1 Extreme (Gen 2)</a></li>
</ul>
</div>
<table  style="float: right; clear: right;">
<tbody>
<tr>
<td><b>Device</b></td>
<td><b>Status</b></td>
<td>
<b>Modules</b>
</td>
</tr>
<tr>
<td>Intel UHD 630 Graphics</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>i965
</td>
</tr>
<tr>
<td>Nvidia GTX 1050 Ti (Max-Q)</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>nvidia
</td>
</tr>
<tr>
<td>Intel I219-V Ethernet</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>e1000e
</td>
</tr>
<tr>
<td>Intel 9560 wireless</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>iwlwifi
</td>
</tr>
<tr>
<td>Realtek ALC285 audio</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>snd_hda_intel
</td>
</tr>
<tr>
<td>Synaptics touchpad</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>synaptics + libinput
</td>
</tr>
<tr>
<td>SunplusIT camera</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>uvcvideo
</td>
</tr>
<tr>
<td>Card reader</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>xhci_hcd
</td>
</tr>
<tr>
<td>Intel 9560 Bluetooth</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>btusb
</td>
</tr>
<tr>
<td>Intel JHL7540 Thunderbolt</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>thunderbolt
</td>
</tr>
<tr>
<td>Synaptics fingerprint reader</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">Not working</td>
<td>
</td>
</tr>
</tbody>
</table>
<p>The <a rel="nofollow"  href="https://www.lenovo.com/us/wiki/laptops/thinkpad/thinkpad-x/ThinkPad-X1-Extreme/p/20MF000DUS">ThinkPad X1 Extreme</a> is a thin-and-light 15.6" workstation/multimedia laptop from Lenovo's 2018 ThinkPad X lineup.
</p>
<p>This page specifically concerns the specifics of running TOS Linux on this laptop. See <a href="../wiki/Laptop.html" title="Laptop">Laptop</a> for generic laptop-related information, or <a href="../wiki/Laptop/Lenovo.html" class="mw-redirect" title="ThinkPad">ThinkPad</a> for other ThinkPad laptops. The <a rel="nofollow"  href="https://certification.ubuntu.com/certification/hardware/201809-26479/">Ubuntu certification page</a> may also be useful.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The <a href="../wiki/Lenovo_ThinkPad_P1.html" title="Lenovo ThinkPad P1">Lenovo ThinkPad P1</a> is a workstation version of the same laptop which uses extremely similar hardware. Most of the information on this page should be applicable to P1 models as well.</div>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Hardware_compatibility"><span >1</span> <span >Hardware compatibility</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Firmware_update"><span >1.1</span> <span >Firmware update</span></a></li>
<li class="toclevel-2 tocsection-3">
<a href="#Hybrid_graphics"><span >1.2</span> <span >Hybrid graphics</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Bumblebee"><span >1.2.1</span> <span >Bumblebee</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#optimus-manager"><span >1.2.2</span> <span >optimus-manager</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Using_external_graphics_exclusively"><span >1.2.3</span> <span >Using external graphics exclusively</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Thunderbolt"><span >1.3</span> <span >Thunderbolt</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Fan_control"><span >1.4</span> <span >Fan control</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Other_hardware"><span >1.5</span> <span >Other hardware</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Software_tweaks"><span >2</span> <span >Software tweaks</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Dolby_Atmos_Effect_on_Linux"><span >2.1</span> <span >Dolby Atmos Effect on Linux</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Microphone_noise_reduction"><span >2.2</span> <span >Microphone noise reduction</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Battery_charge_thresholds"><span >2.3</span> <span >Battery charge thresholds</span></a></li>
<li class="toclevel-2 tocsection-14">
<a href="#CPU_throttling_workaround"><span >2.4</span> <span >CPU throttling workaround</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#via_sysfs"><span >2.4.1</span> <span >via sysfs</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#via_third_party_tools"><span >2.4.2</span> <span >via third party tools</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#CPU_undervolting"><span >2.5</span> <span >CPU undervolting</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Specifications"><span >3</span> <span >Specifications</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Hardware_compatibility">Hardware compatibility</span></h2>
<h3><span class="mw-headline" id="Firmware_update">Firmware update</span></h3>
<p>Despite not being strictly required for an TOS Linux install, a UEFI firmware update is strongly recommended for general use of the laptop - the initial 1.13 version devices seem to ship with contains multiple bugs that can result in bricking the laptop: <a rel="nofollow"  href="https://www.reddit.com/r/thinkpad/comments/a2g0k4/warning_do_not_change_from_hybrid_graphics_to/">Reddit thread discussing the issue</a>; <a rel="nofollow"  href="https://www.reddit.com/r/thinkpad/comments/9qreoj/psa_do_not_enable_bios_support_for_thunderbolt/">another Reddit thread discussing a different bricking issue</a>.
</p>
<p>Firmware updates are available via <a href="../wiki/Fwupd.html" title="Fwupd">fwupd</a>, the Lenovo Vantage application on Windows, or from <a rel="nofollow"  href="https://pcsupport.lenovo.com/wiki/en/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x1-extreme/downloads">Lenovo's website</a>.
</p>
<p>The latest version, v1.27, is highly recommended. All information on this page generally assumes the latest firmware unless explicitly stated.
</p>
<h3><span class="mw-headline" id="Hybrid_graphics">Hybrid graphics</span></h3>
<p>Hybrid mode works via <a href="../wiki/Bumblebee.html" title="Bumblebee">Bumblebee</a>, <a href="../wiki/Nvidia-xrun.html" title="Nvidia-xrun">nvidia-xrun</a> or <a href="../wiki/NVIDIA_Optimus.html#Using_optimus-manager" title="NVIDIA Optimus">optimus-manager</a>. Both the HDMI port and DisplayPort outputs created when using either a USB-C adapter or Thunderbolt dock are wired to the Nvidia dGPU.
In BIOS settings there are only 2 options: Discrete Graphics(Nvidia only) and Hybrid (Intel + GPU). Option to use only Intel GPU is not available.
</p>
<h4><span class="mw-headline" id="Bumblebee">Bumblebee</span></h4>
<p>After installing Bumblebee, the HDMI port works after modifying the following files, rebooting, and executing <code>intel-virtual-output -f</code> from an X server running on the iGPU. See <a href="../wiki/Bumblebee.html#Output_wired_to_the_NVIDIA_chip" title="Bumblebee">Bumblebee#Output wired to the NVIDIA chip</a> for details.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-intel.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
    Identifier "intelgpu0"
    Driver "intel"
EndSection
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/bumblebee/xorg.conf.nvidia</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "ServerLayout"
    Identifier  "Layout0"
    Option      "AutoAddDevices" "true"
    Option      "AutoAddGPU" "false"
EndSection

Section "Device"
    Identifier  "DiscreteNvidia"
    Driver      "nvidia"
    VendorName  "NVIDIA Corporation"
    Option "ProbeAllGpus" "false"
    Option "AllowEmptyInitialConfiguration"
EndSection

Section "Screen"
    Identifier "Screen0"
    Device "DiscreteNVidia"
EndSection
</pre>
<h4><span class="mw-headline" id="optimus-manager">optimus-manager</span></h4>
<p>While optimus-manager requires logging out to switch graphics, it provides better performance and more stable external display support. The following configuration has been found to work well:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/optimus-manager/optimus-manager.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[intel]
DRI=3
driver=modesetting
modeset=yes

[nvidia]
PAT=yes
ignore_abi=no
modeset=yes

[optimus]
pci_power_control=no
pci_remove=no
pci_reset=function_level
switching=bbswitch
</pre>
<p>The above configuration needs <a href="../wiki/Bumblebee.html#Power_management" class="mw-redirect" title="Bbswitch">Bbswitch</a> installed.
</p>
<h4><span class="mw-headline" id="Using_external_graphics_exclusively">Using external graphics exclusively</span></h4>
<p>Works fine with the default configuration produced by <code>nvidia-xconfig</code>, including HDMI output.
</p>
<h3><span class="mw-headline" id="Thunderbolt">Thunderbolt</span></h3>
<p>Thunderbolt works out of the box (tested with ThinkPad Thunderbolt 3 Dock); see <a href="../wiki/Thunderbolt.html" title="Thunderbolt">Thunderbolt</a> for details on security.
</p>
<h3><span class="mw-headline" id="Fan_control">Fan control</span></h3>
<p>The fan on the right side of the laptop can be controlled by <a href="../wiki/Fan_speed_control.html#ThinkPad_laptops" title="Fan speed control">thinkpad_acpi</a>. 2nd fan can be controlled after patching thinkpad_acpi module; see <a rel="nofollow"  href="https://github.com/civic9/thinkpad_acpi.2ndfan.patch">[1]</a>. If noise is an issue, the fan can be turned off manually by unplugging it from the motherboard, or <a rel="nofollow"  href="https://www.reddit.com/r/thinkpad/comments/acesmt/x1_extremes_jet_engine_noise_reduced_after_mesh/">the dust mesh can be removed</a>.
</p>
<h3><span class="mw-headline" id="Other_hardware">Other hardware</span></h3>
<p>
The touchpad experience can be greatly improved by enabling "intertouch" as hinted by kernel messages. This can be done by either adding <code>psmouse.synaptics_intertouch=1</code> to the kernel command line or by creating a modprobe entry like: </p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/psmouse.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options psmouse synaptics_intertouch=1</pre>
<p>The webcam works out of the box, though it reports a completely black image instead of the "disconnected" placeholder when the protective slider is closed.
</p>
<p>The fingerprint scanner is currently not supported in libfprint - a reverse engineering effort was ongoing <a rel="nofollow"  href="https://github.com/nmikhailov/Validity90">here</a>, but seems to have stalled. Upstream libfprint bug is tracked <a rel="nofollow"  href="https://gitlab.freedesktop.org/libfprint/libfprint/issues/134">here</a>.
</p>
<p>Everything else works correctly out of the box.
</p>
<h2><span class="mw-headline" id="Software_tweaks">Software tweaks</span></h2>
<h3><span class="mw-headline" id="Dolby_Atmos_Effect_on_Linux">Dolby Atmos Effect on Linux</span></h3>
<p>In order to get the same speaker sound quality/effect as on Dolby Atmos with Windows install &amp; configure <a href="../wiki/PulseAudio.html" title="PulseAudio">PulseAudio</a> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pulseeffects">pulseeffects</a></span>. You can then download the Dolby Atmos preset from <a rel="nofollow"  href="https://github.com/JackHack96/PulseEffects-Presets/tree/master/irs">JackHack96's Github</a> and enable it in the "Convolver" tab of the PulseEffects GUI.
</p>
<h3><span class="mw-headline" id="Microphone_noise_reduction">Microphone noise reduction</span></h3>
<p>PulseAudio's <a href="../wiki/PulseAudio/Troubleshooting.html#Enable_Echo/Noise-Cancellation" title="PulseAudio/Troubleshooting">Echo/Noise-Cancellation</a> can be used to reduce the amount of microphone noise by adding the following to <code>/etc/pulse/default.pa</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Enable Echo/Noise-Cancellation
load-module module-echo-cancel use_master_format=1 aec_method=webrtc aec_args="beamforming=1 mic_geometry=-0.0257,0,0,0.0257,0,0" source_name=echoCancel_source sink_name=echoCancel_sink
set-default-source echoCancel_source
set-default-sink echoCancel_sink</pre>
<p>The above mic_geometry is specific to the X1 Extreme.
</p>
<h3><span class="mw-headline" id="Battery_charge_thresholds">Battery charge thresholds</span></h3>
<p>Battery charging thresholds can be configured via sysfs nodes <code>/sys/class/power_supply/BAT0/charge_start_threshold</code> and <code>/sys/class/power_supply/BAT0/charge_stop_threshold</code>, or using <a href="../wiki/TLP.html" title="TLP">TLP</a>.
</p>
<h3><span class="mw-headline" id="CPU_throttling_workaround">CPU throttling workaround</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> As of firmware v1.27, overriding thermal limits will result in your laptop running out of spec under certain conditions. A proper firmware level solution <a rel="nofollow"  href="https://forums.lenovo.com/t5/Other-Linux-Discussions/X1C6-T480s-low-cTDP-and-trip-temperature-in-Linux/td-p/4028489">is being worked on</a> by Lenovo, and should be available eventually.</div>
<p>A stress test using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=s-tui">s-tui</a></span> indicates that the CPU is limited to 38W/80C, resulting in maximum sustained frequency of around 2850 MHz on i7-8750H under heavy loads. The limits set by Windows in "performance" mode are considerably higher, at 44W/95C. It's possible to configure the power limits in one of the following ways:
</p>
<h4><span class="mw-headline" id="via_sysfs">via sysfs</span></h4>
<p>Starting with version 5.4, the Linux kernel exposes multiple interfaces to configure the thermal policy of the CPU. There are two major knobs to be tweaked: the DPTF policy, which controls the throttling behavior, and the TCC offset, which controls the maximum allowed package temperature. Those can be configured to match Windows using a script like this one:
</p>
<pre>#!/bin/bash

# set DPTF policy to "adaptive performance"
echo "63BE270F-1C11-48FD-A6F7-3AF253FF3E2D" &gt; /sys/devices/platform/INT3400:00/uuids/current_uuid

# enable INT3400 thermal zone
for zone in /sys/class/thermal/thermal_zone*; do
	if [ "$(cat $zone/type)" == "INT3400 Thermal" ]; then
		echo enabled &gt; $zone/mode
	fi
done

# set TCC offset to 5 degrees (Tmax = 95C)
echo 5 &gt; /sys/devices/pci0000:00/0000:00:04.0/tcc_offset_degree_celsius</pre>
<h4><span class="mw-headline" id="via_third_party_tools">via third party tools</span></h4>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=throttled">throttled</a></span> and <code>intel-undervolt</code> (see below) can be used to override both thermal and power limits. However, the approach used by those tools is less reliable.
</p>
<h3><span class="mw-headline" id="CPU_undervolting">CPU undervolting</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> While generally not directly dangerous to the hardware, undervolting is not supported by Lenovo or Intel. If you experience any issues whatsoever while your hardware is undervolted, reset to stock voltages and verify the issue is still present.</div>
<p>Undervolting the CPU/Intel GPU works well with <a href="../wiki/Undervolting_CPU.html#intel-undervolt" title="Undervolting CPU">intel-undervolt</a>. Generally -150mV seems to be a safe choice on the i7-8750H and i7-8850H CPUs, but your mileage may vary.  
</p>
<p>The effects of undervolting on system stability will vary depending on individual hardware (a.k.a. "the silicon lottery").
</p>
<h2><span class="mw-headline" id="Specifications">Specifications</span></h2>
<p>All information on this page has been tested on laptop part number 20MF000BUS and 20MFCTO1WW, with the following specifications:
</p>
<ul>
<li>CPU: Intel Core i7-8750H / i7-8850H</li>
<li>Graphics: Hybrid Intel UHD 630 + Nvidia GTX 1050 Ti Max-Q</li>
<li>Display: Innolux N156HCE-EN1 1920x1080/60Hz IPS (other vendors may be used)</li>
<li>RAM: 16GB / 32GB</li>
<li>SSD: Intel 7600p series 512GB NVMe / Samsung 970 Pro 1TB NVMe</li>
</ul>
</div></div>
		
		<div id="catlinks"  data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../wiki/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div></div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Extreme&amp;oldid=609055">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Extreme&amp;oldid=609055</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 1 May 2020, at 01:00.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../wiki/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../wiki/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="../wiki/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



