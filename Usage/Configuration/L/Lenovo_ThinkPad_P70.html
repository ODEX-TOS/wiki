<!--
    title: Lenovo_ThinkPad_P70
    description: Migration of Lenovo_ThinkPad_P70 from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:25:31.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Lenovo ThinkPad P70</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p>This is a guide of steps aggregated from other sources to installation of TOS on the Lenovo ThinkPad P70. This guide was written for ARCH_201604 ISO. The laptop features a 17.3" IPS display and has connectors for up to four SSDs (two M.2 <a href="/Usage/Configuration/L/Solid_state_drive/NVMe.html" class="mw-redirect" title="NVMe">NVMe</a>, two SATA).
</p>
<table  style="float: right;">
<tbody>
<tr>
<td><b>Device</b></td>
<td><b>Status</b></td>
<td>
<b>Modules</b>
</td>
</tr>
<tr>
<td>Intel</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>xf86-video-intel
</td>
</tr>
<tr>
<td>NVIDIA (Quadro M3000M, M4000M)</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working*</td>
<td>nvidia
</td>
</tr>
<tr>
<td>HDMI</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>
</td>
</tr>
<tr>
<td>Ethernet</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>
</td>
</tr>
<tr>
<td>Wireless</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>iwlwifi
</td>
</tr>
<tr>
<td>Audio</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>
</td>
</tr>
<tr>
<td>Trackpad</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>xf86-input-libinput
</td>
</tr>
<tr>
<td>Trackpoint</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>xf86-input-libinput
</td>
</tr>
<tr>
<td>Camera</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working</td>
<td>
</td>
</tr>
<tr>
<td>Card Reader</td>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">untested</td>
<td>
</td>
</tr>
<tr>
<td>Bluetooth</td>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">untested</td>
<td>
</td>
</tr>
</tbody>
</table>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Hardware"><span >1</span> <span >Hardware</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Preliminaries"><span >2</span> <span >Preliminaries</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Installation"><span >3</span> <span >Installation</span></a></li>
<li class="toclevel-1 tocsection-4">
<a href="#Configuration"><span >4</span> <span >Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Keyboard"><span >4.1</span> <span >Keyboard</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Sound"><span >4.2</span> <span >Sound</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Integrated_Graphics"><span >4.3</span> <span >Integrated Graphics</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Dedicated_Graphics"><span >4.4</span> <span >Dedicated Graphics</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#External_Displays"><span >4.5</span> <span >External Displays</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#HiDPI"><span >4.6</span> <span >HiDPI</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Hardware">Hardware</span></h2>
<p><code>lspci</code> returns something like:
</p>
<pre>00:00.0 Host bridge: Intel Corporation Skylake Host Bridge/DRAM Registers (rev 07)
00:01.0 PCI bridge: Intel Corporation Skylake PCIe Controller (x16) (rev 07)
00:02.0 VGA compatible controller: Intel Corporation Device 191d (rev 06)
00:14.0 USB controller: Intel Corporation Sunrise Point-H USB 3.0 xHCI Controller (rev 31)
00:14.2 Signal processing controller: Intel Corporation Sunrise Point-H Thermal subsystem (rev 31)
00:16.0 Communication controller: Intel Corporation Sunrise Point-H CSME HECI #1 (rev 31)
00:16.3 Serial controller: Intel Corporation Sunrise Point-H KT Redirection (rev 31)
00:17.0 SATA controller: Intel Corporation Sunrise Point-H SATA controller [AHCI mode] (rev 31)
00:1c.0 PCI bridge: Intel Corporation Sunrise Point-H PCI Express Root Port #1 (rev f1)
00:1c.2 PCI bridge: Intel Corporation Sunrise Point-H PCI Express Root Port #3 (rev f1)
00:1c.4 PCI bridge: Intel Corporation Sunrise Point-H PCI Express Root Port #5 (rev f1)
00:1d.0 PCI bridge: Intel Corporation Sunrise Point-H PCI Express Root Port #9 (rev f1)
00:1d.4 PCI bridge: Intel Corporation Sunrise Point-H PCI Express Root Port #13 (rev f1)
00:1f.0 ISA bridge: Intel Corporation Sunrise Point-H LPC Controller (rev 31)
00:1f.2 Memory controller: Intel Corporation Sunrise Point-H PMC (rev 31)
00:1f.3 Audio device: Intel Corporation Sunrise Point-H HD Audio (rev 31)
00:1f.4 SMBus: Intel Corporation Sunrise Point-H SMBus (rev 31)
00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (2) I219-LM (rev 31)
01:00.0 VGA compatible controller: NVIDIA Corporation GM204GLM [Quadro M3000M] (rev a1)
04:00.0 Network controller: Intel Corporation Wireless 8260 (rev 3a)
70:00.0 Non-Volatile memory controller: Samsung Electronics Co Ltd NVMe SSD Controller (rev 01)
71:00.0 Unassigned class [ff00]: Realtek Semiconductor Co., Ltd. RTS525A PCI Express Card Reader (rev 01)
</pre>
<p><code>lsusb</code> returns something like:
</p>
<pre>Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 003: ID 138a:0090 Validity Sensors, Inc. 
Bus 001 Device 002: ID 04f2:b52c Chicony Electronics Co., Ltd 
Bus 001 Device 005: ID 0765:5010 X-Rite, Inc. 
Bus 001 Device 004: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</pre>
<h2><span class="mw-headline" id="Preliminaries">Preliminaries</span></h2>
<ol>
<li>Create a recovery device in Windows 10. It required a USB-only (no SD card, no optical media?) flash drive greater than 8 GB. Formatting FAT32 works.</li>
<li>
<a rel="nofollow"  href="https://support.lenovo.com/us/wiki/documents/yast-3jwkjx">Update the BIOS.</a> At this time of writing, the latest BIOS is 2.15 (2017-05-30). Lenovo provides a bootable, standalone <a rel="nofollow"  href="http://support.lenovo.com/us/wiki/downloads/ds106086">"BIOS Update CD"</a> to perform this update outside of Windows.</li>
<li>Getting <b>into</b> the BIOS is difficult, so <a rel="nofollow"  href="https://support.lenovo.com/us/wiki/documents/sf13-t0025">here are some instructions</a> that seemed to work. The easiest way was through Windows 10.</li>
<li>In the BIOS, you will want to disable UEFI Secure Boot, change the boot order to look at USB devices first, allow <code>F12</code> to bypass the BIOS, and possibly enable the verbose mode because it is easier to press the appropriate buttons on time.</li>
</ol>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>This machine can boot either via EFI or grub.
</p>
<p>This section assumes that you've successfully created bootable TOS install media to a USB drive. The label of the USB installer must be correct (ARCH_201604 in this case). Restart the computer boot from the USB drive. You may need to press <code>F12</code> at some point to trigger a boot order override.
</p>
<p>You need an internet connection; this guide got both ethernet and wifi to work. Find the interfaces with <code>ip link</code>.
</p>
<p>Ethernet: turn on DHCP with
</p>
<pre># dhcpcd <i>&lt;interface&gt;</i> 
</pre>
<p>Wifi: wifi-menu worked here, the appropriate SSID was selected with the right password.
</p>
<p>The font sizes will make you feel very far away. To deal with this, fonts are in <code>/usr/share/kbd/consolefonts</code>.
</p>
<p>You can see the currently selected font with showconsolefont. The font was changed here to <code>sun12x22</code> with: <code>setfont sun12x22</code>. It is a little better.
</p>
<p>Following the <a href="/Usage/Configuration/L/Installation_guide.html" class="mw-redirect" title="Beginner's guide">Beginner's guide</a> to install TOS.
</p>
<p>Shutdown, remove the USB drive, and then boot the computer, and make sure the installed drive is first in the BIOS.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Keyboard">Keyboard</span></h3>
<p>To control the keyboard backlight, you change the value using:
</p>
<pre>echo 1 | sudo dd of=/sys/class/leds/tpacpi\:\:kbd_backlight/brightness
</pre>
<p>for values 0â€“2.
</p>
<h3><span class="mw-headline" id="Sound">Sound</span></h3>
<p>The status of audio output over HDMI, Thunderbolt, and/or Mini Displayport is unknown.
</p>
<h3><span class="mw-headline" id="Integrated_Graphics">Integrated Graphics</span></h3>
<p>The integrated Intel GPU should work (mostly) without configuration using the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xf86-video-intel">xf86-video-intel</a></span> package. If you experience crashes or hangs, please see <a href="/Usage/Configuration/L/Intel_graphics.html#Skylake_support" title="Intel graphics">Intel graphics#Skylake support</a><sup>[<a href="/Usage/Configuration/L/TOS Wiki:Requests.html#Broken_section_links" class="mw-redirect" title="TOS Wiki:Requests">broken link</a>: invalid section]</sup> for additional configuration.
</p>
<h3><span class="mw-headline" id="Dedicated_Graphics">Dedicated Graphics</span></h3>
<p>There is a BIOS option for turning off the Intel Integrated Graphics and only running the NVIDIA discrete card. While it is possible to get the console working with this configuration, there are no confirmed reports of X.org working in this setup.
</p>
<p><a href="/Usage/Configuration/L/NVIDIA_Optimus.html#Use_NVIDIA_graphics_only" title="NVIDIA Optimus">NVIDIA Optimus#Use NVIDIA graphics only</a> contains instructions on configuring Xorg to use your Nvidia Quadro GPU. Be sure to select the "Hybrid Graphics" in your BIOS. The official <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia">nvidia</a></span> driver package supports hybrid GPU configuration without requiring the use of Noveau/PRIME or Bumblebee. The following example configuration enables the GPU using the proprietary driver. Pay close attention to the ConstrainCursor and AccelMethod directives.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Server layout
Section "ServerLayout"
	Identifier "layout"
	Screen 0 "nvidia"
	Inactive "intel"
EndSection

# Intel
Section "Device"
	Identifier "Intel"
	Driver "modesetting"
	BusID "PCI:0@0:2:0"
	#Option "AccelMethod" "sna"
	Option "AccelMethod" "none"
EndSection

Section "Screen"
	Identifier "intel"
	Device "intel"
EndSection

# Nvidia
Section "Device"
	Identifier "nvidia"
	Driver "nvidia"
	BusID "PCI:1@0:0:0"
	Option "ConstrainCursor" "off"
EndSection

Section "Screen"
	Identifier "nvidia"
	Device "nvidia"
	Option "AllowEmptyInitialConfiguration" "on"
	Option "IgnoreDisplayDevices" "CRT"
EndSection</pre>
<h3><span class="mw-headline" id="External_Displays">External Displays</span></h3>
<p>DisplayPort over USB-C, HDMI, and Mini DisplayPort outputs all work using the above configuration with the proprietary Nvidia driver. HDMI has also been confirmed to work using Bumblebee and <code>intel-virtual-output</code>.
</p>
<p>Limited testing suggests that a maximum of 3 total displays from 2 output types may be used at one time. For example, two external DP/USB-C displays and the one internal display will achieve the maximum of three.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Hot-swapping between different external display types has been known to hardlock the Nvidia driver. Change outputs at your own risk!</div>
<h3><span class="mw-headline" id="HiDPI">HiDPI</span></h3>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="/Usage/Configuration/L/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="/Usage/Configuration/L/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_P70&amp;oldid=585589">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_P70&amp;oldid=585589</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 12 October 2019, at 16:06.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="/Usage/Configuration/L/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="/Usage/Configuration/L/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="/Usage/Configuration/L/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



