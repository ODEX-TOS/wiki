<!--
    title: AMDGPU
    description: Migration of AMDGPU from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">AMDGPU</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="/Usage/Configuration/A/AMD_Catalyst.html" title="AMD Catalyst">AMD Catalyst</a></li>
<li><a href="/Usage/Configuration/A/ATI.html" title="ATI">ATI</a></li>
<li><a href="/Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a></li>
<li><a href="/Usage/Configuration/V/Vulkan.html" title="Vulkan">Vulkan</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/AMDGPU"  title="wikipedia:AMDGPU">AMDGPU</a> is the open source graphics driver for AMD Radeon graphics cards from the <a href="https://en.wikipedia.org/wiki/Graphics_Core_Next"  title="wikipedia:Graphics Core Next">Graphics Core Next</a> family.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Selecting_the_right_driver"><span >1</span> <span >Selecting the right driver</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Installation"><span >2</span> <span >Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Experimental"><span >2.1</span> <span >Experimental</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#Enable_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_support"><span >2.2</span> <span >Enable Southern Islands (SI) and Sea Islands (CIK) support</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Specify_the_correct_module_order"><span >2.2.1</span> <span >Specify the correct module order</span></a></li>
<li class="toclevel-3 tocsection-6">
<a href="#Set_required_module_parameters"><span >2.2.2</span> <span >Set required module parameters</span></a>
<ul>
<li class="toclevel-4 tocsection-7"><a href="#Set_module_parameters_in_kernel_command_line"><span >2.2.2.1</span> <span >Set module parameters in kernel command line</span></a></li>
<li class="toclevel-4 tocsection-8"><a href="#Set_module_parameters_in_modprobe.d"><span >2.2.2.2</span> <span >Set module parameters in modprobe.d</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#AMDGPU_PRO"><span >2.3</span> <span >AMDGPU PRO</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#ACO_compiler"><span >2.4</span> <span >ACO compiler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Loading"><span >3</span> <span >Loading</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Enable_early_KMS"><span >3.1</span> <span >Enable early KMS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Xorg_configuration"><span >4</span> <span >Xorg configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Tear_free_rendering"><span >4.1</span> <span >Tear free rendering</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#DRI_level"><span >4.2</span> <span >DRI level</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Variable_refresh_rate"><span >4.3</span> <span >Variable refresh rate</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#10-bit_color"><span >4.4</span> <span >10-bit color</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18">
<a href="#Features"><span >5</span> <span >Features</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Video_acceleration"><span >5.1</span> <span >Video acceleration</span></a></li>
<li class="toclevel-2 tocsection-20">
<a href="#Monitoring"><span >5.2</span> <span >Monitoring</span></a>
<ul>
<li class="toclevel-3 tocsection-21"><a href="#CLI_(default)"><span >5.2.1</span> <span >CLI (default)</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#GUI"><span >5.2.2</span> <span >GUI</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-23">
<a href="#Overclocking"><span >5.3</span> <span >Overclocking</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#Boot_parameter"><span >5.3.1</span> <span >Boot parameter</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Manual_(default)"><span >5.3.2</span> <span >Manual (default)</span></a></li>
<li class="toclevel-3 tocsection-26">
<a href="#Assisted"><span >5.3.3</span> <span >Assisted</span></a>
<ul>
<li class="toclevel-4 tocsection-27"><a href="#CLI_tools"><span >5.3.3.1</span> <span >CLI tools</span></a></li>
<li class="toclevel-4 tocsection-28"><a href="#GUI_tools"><span >5.3.3.2</span> <span >GUI tools</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-29"><a href="#Startup_on_boot"><span >5.3.4</span> <span >Startup on boot</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-30"><a href="#Enable_GPU_display_scaling"><span >5.4</span> <span >Enable GPU display scaling</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-31">
<a href="#Troubleshooting"><span >6</span> <span >Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-32"><a href="#Xorg_or_applications_will_not_start"><span >6.1</span> <span >Xorg or applications will not start</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Screen_artifacts_and_frequency_problem"><span >6.2</span> <span >Screen artifacts and frequency problem</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#R9_390_series_poor_performance_and/or_instability"><span >6.3</span> <span >R9 390 series poor performance and/or instability</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Freezes_with_%22%5Bdrm%5D_IP_block:gmc_v8_0_is_hung!%22_kernel_error"><span >6.4</span> <span >Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Cursor_corruption"><span >6.5</span> <span >Cursor corruption</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#System_freeze_or_crash_when_gaming_on_Vega_cards"><span >6.6</span> <span >System freeze or crash when gaming on Vega cards</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Navi_power_consumption"><span >6.7</span> <span >Navi power consumption</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#WebRenderer_(Firefox)_corruption"><span >6.8</span> <span >WebRenderer (Firefox) corruption</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Selecting_the_right_driver">Selecting the right driver</span></h2>
<p>Depending on the card you have, find the right driver in <a href="/Usage/Configuration/X/Xorg.html#AMD" title="Xorg">Xorg#AMD</a>. This page has instructions for <b>AMDGPU</b> and <b>AMDGPU PRO</b>. 
At the moment there is Xorg <a href="/Usage/Configuration/A/ATI.html" class="mw-redirect" title="Radeon">radeon</a> driver support for <a rel="nofollow"  href="https://www.x.org/wiki/RadeonFeature/">Southern Islands (SI)</a> through Arctic Islands (AI) cards. AMD has no plans to support pre-GCN GPUs.
Owners of unsupported GPUs may use the open source <a href="/Usage/Configuration/A/ATI.html" class="mw-redirect" title="Radeon">radeon</a> or the <a href="/Usage/Configuration/A/AMD_Catalyst.html" title="AMD Catalyst">AMD Catalyst</a> driver .
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If coming from the proprietary Catalyst driver, see <a href="/Usage/Configuration/A/AMD_Catalyst.html#Uninstallation" title="AMD Catalyst">AMD Catalyst#Uninstallation</a> first.</div>
<p><a href="/Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mesa">mesa</a></span> package, which provides the DRI driver for 3D acceleration.
</p>
<ul>
<li>For 32-bit application support, also install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-mesa">lib32-mesa</a></span> package from the <a href="/Usage/Configuration/O/Official_repositories.html#multilib" class="mw-redirect" title="Multilib">multilib</a> repostory.</li>
<li>For the DDX driver (which provides 2D acceleration in <a href="/Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a>), install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xf86-video-amdgpu">xf86-video-amdgpu</a></span> package.</li>
<li>For <a href="/Usage/Configuration/V/Vulkan.html" title="Vulkan">Vulkan</a> support, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=vulkan-radeon">vulkan-radeon</a></span> package. Optionally install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-vulkan-radeon">lib32-vulkan-radeon</a></span> package for 32-bit application support.</li>
</ul>
<p>Support for <a href="#Video_acceleration">accelerated video decoding</a> is provided by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libva-mesa-driver">libva-mesa-driver</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libva-mesa-driver">lib32-libva-mesa-driver</a></span> for VA-API and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mesa-vdpau">mesa-vdpau</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-mesa-vdpau">lib32-mesa-vdpau</a></span> packages for VDPAU.
</p>
<h3><span class="mw-headline" id="Experimental">Experimental</span></h3>
<p>It may be worthwhile for some users to use the upstream experimental build of mesa, to enable features such as AMD Navi improvements that have not landed in the standard mesa packages.
</p>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a></span><sup><small>AUR</small></sup> package, which provides the DRI driver for 3D acceleration.
</p>
<ul>
<li>For 32-bit application support, also install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-mesa-git/">lib32-mesa-git</a></span><sup><small>AUR</small></sup> package from the <i>mesa-git</i> repository or the <a href="/Usage/Configuration/T/TOS_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>.</li>
<li>For the DDX driver (which provides 2D acceleration in <a href="/Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a>), install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/xf86-video-amdgpu-git/">xf86-video-amdgpu-git</a></span><sup><small>AUR</small></sup> package.</li>
<li>For <a href="/Usage/Configuration/V/Vulkan.html" title="Vulkan">Vulkan</a> support using the <i>mesa-git</i> repository below, install the <i>vulkan-radeon-git</i> package. Optionally install the <i>lib32-vulkan-radeon-git</i> package for 32-bit application support. This should not be required if building <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a></span><sup><small>AUR</small></sup> from the AUR.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It may be necessary to symlink LibLLVM for X to start. For example, <code>ln -s /usr/lib/libLLVM-10git.so /usr/lib/libLLVM-10svn.so</code>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Users who do not wish to go through the process of compiling the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a></span><sup><small>AUR</small></sup> package can use the <a href="/Usage/Configuration/U/Unofficial_user_repositories.html#mesa-git" title="Unofficial user repositories">mesa-git</a> unofficial repository.</div>
<h3>
<span id="Enable_Southern_Islands_.28SI.29_and_Sea_Islands_.28CIK.29_support"></span><span class="mw-headline" id="Enable_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_support">Enable Southern Islands (SI) and Sea Islands (CIK) support</span>
</h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=linux">linux</a></span> package enables AMDGPU support for cards of the Southern Islands (SI) and Sea Islands (CIK). When building or compiling a <a href="/Usage/Configuration/K/Kernel.html" title="Kernel">kernel</a>, <code>CONFIG_DRM_AMDGPU_SI=Y</code> and/or <code>CONFIG_DRM_AMDGPU_CIK=Y</code> should be be set in the config.
</p>
<h4><span class="mw-headline" id="Specify_the_correct_module_order">Specify the correct module order</span></h4>
<p>Even when AMDGPU support for SI/CIK has been enabled by the kernel, the <a href="/Usage/Configuration/A/ATI.html" class="mw-redirect" title="Radeon">radeon</a> driver may be loaded before the <code>amdgpu</code> driver.
</p>
<p>Make sure <code>amdgpu</code> has been set as first module in the <a href="/Usage/Configuration/M/Mkinitcpio.html#MODULES" title="Mkinitcpio">Mkinitcpio#MODULES</a> array, e.g. <code>MODULES=(amdgpu radeon)</code>.
</p>
<h4><span class="mw-headline" id="Set_required_module_parameters">Set required module parameters</span></h4>
<p>The <a href="/Usage/Configuration/K/Kernel_module.html#Setting_module_options" class="mw-redirect" title="Module parameters">module parameters</a> of both <code>amdgpu</code> and <code>radeon</code> modules are <code>cik_support=</code> and <code>si_support=</code>. 
</p>
<p>They need to be set as kernel parameters or in a <i>modprobe</i> configuration file, and depend on the cards GCN version.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <a href="/Usage/Configuration/C/Core_utilities.html#Essentials" class="mw-redirect" title="Dmesg">dmesg</a> may indicate the correct kernel parameter to use: <code>[..] amdgpu 0000:01:00.0: Use radeon.cik_support=0 amdgpu.cik_support=1 to override</code>.</div>
<h5><span class="mw-headline" id="Set_module_parameters_in_kernel_command_line">Set module parameters in kernel command line</span></h5>
<p>Set one of the following <a href="/Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>:
</p>
<ul>
<li>Southern Islands (SI): <code>radeon.si_support=0 amdgpu.si_support=1</code>
</li>
<li>Sea Islands (CIK): <code>radeon.cik_support=0 amdgpu.cik_support=1</code>
</li>
</ul>
<h5><span class="mw-headline" id="Set_module_parameters_in_modprobe.d">Set module parameters in modprobe.d</span></h5>
<p>Create the configuration <a href="/Usage/Configuration/K/Kernel_module.html" class="mw-redirect" title="Modprobe">modprobe</a> files in <code>/etc/modprobe.d/</code>, see <span class="plainlinks archwiki-template-man" title="$ man 5 modprobe.d"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/modprobe.d.5">modprobe.d(5)</a></span> for syntax details.
</p>
<p>For Southern Islands (SI) use option <code>si_support=1</code>, for Sea Islands (CIK) use option <code>cik_support=1</code>, e.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/amdgpu.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options amdgpu si_support=1
options amdgpu cik_support=0</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/radeon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options radeon si_support=0
options radeon cik_support=0</pre>
<p>Make sure <code>modconf</code> is in the the <code>HOOKS</code> array in <code>/etc/mkinitcpio.conf</code> and <a href="/Usage/Configuration/M/Mkinitcpio.html#Image_creation_and_activation" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a>.
</p>
<h3><span class="mw-headline" id="AMDGPU_PRO">AMDGPU PRO</span></h3>
<p>AMD provides a proprietary, binary userland driver called <i>AMDGPU PRO</i>, which works on top of the open-source AMDGPU kernel driver.
</p>
<p>From <a rel="nofollow"  href="http://www.phoronix.com/vr.php?view=27266">Radeon Software 18.50 vs Mesa 19 benchmarks</a> article: When it comes to OpenGL games, the RadeonSI Gallium3D driver simply dominates the proprietary AMD OpenGL driver.
</p>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/amdgpu-pro-libgl/">amdgpu-pro-libgl</a></span><sup><small>AUR</small></sup>. Optionally install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-amdgpu-pro-libgl/">lib32-amdgpu-pro-libgl</a></span><sup><small>AUR</small></sup> package for 32-bit application support.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Users of graphic cards other than Radeon Pro are <a rel="nofollow"  href="https://www.amd.com/wiki/support/kb/release-notes/amdgpu-installation">advised to use the amdgpu graphics stack</a>.</div>
<h3><span class="mw-headline" id="ACO_compiler">ACO compiler</span></h3>
<p>The <a rel="nofollow"  href="https://steamcommunity.com/games/221410/announcements/detail/1602634609636894200">ACO compiler</a> is an open source shader compiler created and developed by <a href="https://en.wikipedia.org/wiki/Valve_Corporation"  title="wikipedia:Valve Corporation">Valve Corporation</a> to directly compete with the <a rel="nofollow"  href="http://llvm.org/">LLVM compiler</a>, the <a rel="nofollow"  href="https://github.com/GPUOpen-Drivers/AMDVLK">AMDVLK drivers</a>, as well as <a href="https://en.wikipedia.org/wiki/Windows_10"  title="wikipedia:Windows 10">Windows 10</a>. It offers lesser compilation time and also performs better while gaming than LLVM and AMDVLK.
</p>
<p>Some benchmarks can be seen in <a rel="nofollow"  href="https://itsfoss.com/linux-games-performance-boost-amd-gpu/">It's FOSS</a> and Phoronix <a rel="nofollow"  href="https://www.phoronix.com/scan.php?page=article&amp;item=radv-aco-llvm&amp;num=1">(1)</a> <a rel="nofollow"  href="https://www.phoronix.com/scan.php?page=article&amp;item=radv-aco-gcn10&amp;num=1">(2)</a> <a rel="nofollow"  href="https://www.phoronix.com/scan.php?page=article&amp;item=mesa20radv-aco-amdvlk&amp;num=1">(3)</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> ACO is a very early development and still is marked as <b>testing</b>, you may experience issues.</div>
<p>Since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mesa">mesa</a></span> version 19.3, the ACO compiler is available in the official package, but disabled by default. It can be enabled by <a href="/Usage/Configuration/E/Environment_variables.html#Defining_variables" title="Environment variables">exporting</a> <code>RADV_PERFTEST=aco</code> before starting an application.
</p>
<h2><span class="mw-headline" id="Loading">Loading</span></h2>
<p>The <code>amdgpu</code> kernel module should load fine automatically on system boot.
</p>
<p>If it does not happen, then:
</p>
<ul>
<li>Make sure to <a href="#Enable_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_support">#Enable Southern Islands (SI) and Sea Islands (CIK) support</a> when needed.</li>
<li>Make sure you have the latest <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span> package installed. This driver requires the latest firmware for each model to successfully boot.</li>
<li>Make sure you do <b>not</b> have <code>nomodeset</code> or <code>vga=</code> as a <a href="/Usage/Configuration/K/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>, since <code>amdgpu</code> requires <a href="/Usage/Configuration/K/Kernel_mode_setting.html" class="mw-redirect" title="KMS">KMS</a>.</li>
<li>Check that you have not disabled <code>amdgpu</code> by using any <a href="/Usage/Configuration/K/Kernel_module.html#Blacklisting" class="mw-redirect" title="Kernel modules">kernel module blacklisting</a>.</li>
</ul>
<h3><span class="mw-headline" id="Enable_early_KMS">Enable early KMS</span></h3>
<p>See <a href="/Usage/Configuration/K/Kernel_mode_setting.html#Early_KMS_start" title="Kernel mode setting">Kernel mode setting#Early KMS start</a>.
</p>
<h2><span class="mw-headline" id="Xorg_configuration">Xorg configuration</span></h2>
<p><a href="/Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a> will automatically load the driver and it will use your monitor's EDID to set the native resolution. Configuration is only required for tuning the driver.
</p>
<p>If you want manual configuration, create <code>/etc/X11/xorg.conf.d/20-amdgpu.conf</code>, and add the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-amdgpu.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
     Identifier "AMD"
     Driver "amdgpu"
EndSection</pre>
<p>Using this section, you can enable features and tweak the driver settings, see <span class="plainlinks archwiki-template-man" title="$ man 4 amdgpu"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/amdgpu.4">amdgpu(4)</a></span> first before setting driver options.
</p>
<h3><span class="mw-headline" id="Tear_free_rendering">Tear free rendering</span></h3>
<p><i>TearFree</i> controls tearing prevention using the hardware page flipping mechanism. If this option is set, the default value of the property is 'on' or 'off' accordingly. If this option is not set, the default value of the property is auto, which means that TearFree is on for rotated outputs, outputs with RandR transforms applied and for RandR 1.4 slave outputs, otherwise off:
</p>
<pre>Option "TearFree" "true"
</pre>
<p>You can also enable TearFree temporarily with <a href="/Usage/Configuration/X/Xrandr.html" title="Xrandr">xrandr</a>: 
</p>
<pre>$ xrandr --output <i>output</i> --set TearFree on
</pre>
<p>Where <code><i>output</i></code> should look like <code>DisplayPort-0</code> or <code>HDMI-A-0</code> and can be acquired by running <code>xrandr -q</code>.
</p>
<h3><span class="mw-headline" id="DRI_level">DRI level</span></h3>
<p><i>DRI</i> sets  the maximum level of DRI to enable. Valid values are <i>2</i> for DRI2 or <i>3</i> for DRI3. The default is <i>3</i> for DRI3 if the <a href="/Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a> version is &gt;=  1.18.3, otherwise DRI2 is used:
</p>
<pre>Option "DRI" "3"
</pre>
<h3><span class="mw-headline" id="Variable_refresh_rate">Variable refresh rate</span></h3>
<p>See <a href="/Usage/Configuration/V/Variable_refresh_rate.html" title="Variable refresh rate">Variable refresh rate</a>.
</p>
<h3><span class="mw-headline" id="10-bit_color">10-bit color</span></h3>
<p>Newer AMD cards support 10bpc color, but the default is 24-bit color and 30-bit color must be explicitly enabled. To check if your monitor supports it search for "EDID" in your <a href="/Usage/Configuration/X/Xorg.html#General" title="Xorg">Xorg log file</a> (e.g. <code>/var/log/Xorg.0.log</code> or <code>~/.local/share/xorg/Xorg.0.log</code>):
</p>
<pre>[   336.695] (II) AMDGPU(0): EDID for output DisplayPort-0
[   336.695] (II) AMDGPU(0): EDID for output DisplayPort-1
[   336.695] (II) AMDGPU(0): Manufacturer: DEL  Model: a0ec  Serial#: 123456789
[   336.695] (II) AMDGPU(0): Year: 2018  Week: 23
[   336.695] (II) AMDGPU(0): EDID Version: 1.4
[   336.695] (II) AMDGPU(0): Digital Display Input
<b>[   336.695] (II) AMDGPU(0): 10 bits per channel</b>
</pre>
<p>To check whether it is currently enabled search for "Depth"):
</p>
<pre>[   336.618] (**) AMDGPU(0): Depth 30, (--) framebuffer bpp 32
[   336.618] (II) AMDGPU(0): Pixel depth = 30 bits stored in 4 bytes (32 bpp pixmaps)
</pre>
<p>With the default configuration it will instead say the depth is 24, with 24 bits stored in 4 bytes.
</p>
<p>To check whether 10-bit works, exit Xorg if you have it running and run <code>Xorg -retro</code> which will display a black and white grid, then press <code>Ctrl-Alt-F1</code> and <code>Ctrl-C</code> to exit X, and run <code>Xorg -depth 30 -retro</code>. If this works fine, then 10-bit is working.
</p>
<p>To launch in 10-bit via <code>startx</code>, use <code>startx -- -depth 30</code>. To permanently enable it, create or add to:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-amdgpu.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Screen"
	Identifier "asdf"
	DefaultDepth 30
EndSection</pre>
<p>If you use KDE, KWin's compositor doesn't work properly <a rel="nofollow"  href="https://bugs.kde.org/show_bug.cgi?id=417455">(bug)</a>, apparently due to issues with AMDGPU. Comment 5 on that bug contains a workaround.
</p>
<p>Various other software may also crash or have graphical artifacts with 10-bit color.
</p>
<h2><span class="mw-headline" id="Features">Features</span></h2>
<h3><span class="mw-headline" id="Video_acceleration">Video acceleration</span></h3>
<p>See <a href="/Usage/Configuration/H/Hardware_video_acceleration.html" title="Hardware video acceleration">Hardware video acceleration</a>.
</p>
<h3><span class="mw-headline" id="Monitoring">Monitoring</span></h3>
<p>Monitoring your GPU is often used to check the temperature and also the P-states of your GPU.
</p>
<h4>
<span id="CLI_.28default.29"></span><span class="mw-headline" id="CLI_(default)">CLI (default)</span>
</h4>
<p>To check your GPU's P-states, execute:
</p>
<pre>$ cat /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>To monitor your GPU, execute:
</p>
<pre>$ watch -n 0.5  cat /sys/kernel/debug/dri/0/amdgpu_pm_info
</pre>
<h4><span class="mw-headline" id="GUI">GUI</span></h4>
<ul><li>
<b>WattmanGTK</b> — A GTK GUI tool to monitor your GPU's temperatures P-states</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://github.com/BoukeHaarsma23/WattmanGTK">https://github.com/BoukeHaarsma23/WattmanGTK</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/wattman-gtk-git/">wattman-gtk-git</a></span><sup><small>AUR</small></sup>.</dd></dl>
<ul><li>
<b>TuxClocker</b> — A Qt5 monitoring and overclocking tool.</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://github.com/Lurkki14/tuxclocker">https://github.com/Lurkki14/tuxclocker</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/tuxclocker/">tuxclocker</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/tuxclocker-git/">tuxclocker-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h3><span class="mw-headline" id="Overclocking">Overclocking</span></h3>
<p>Since Linux 4.17, it is possible to adjust clocks and voltages of the graphics card via <code>/sys/class/drm/card0/device/pp_od_clk_voltage</code>.
</p>
<h4><span class="mw-headline" id="Boot_parameter">Boot parameter</span></h4>
<p>It is required to unlock access to adjust clocks and voltages in sysfs by appending the <a href="/Usage/Configuration/K/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">Kernel parameter</a> <code>amdgpu.ppfeaturemask=0xffffffff</code>.
</p>
<h4>
<span id="Manual_.28default.29"></span><span class="mw-headline" id="Manual_(default)">Manual (default)</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In sysfs, paths like <code>/sys/class/drm/...</code> are just symlinks and may change between reboots. Persistent locations can be found in <code>/sys/devices/</code>, e.g. <code>/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/</code>. Adjust the commands accordingly for a reliable result.</div>
<p>To set the GPU clock for the maximum P-state 7 on e.g. a Polaris GPU to 1209MHz and 900mV voltage, run:
</p>
<pre># echo "s 7 1209 900" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>The same procedure can be applied to the VRAM, e.g. maximum P-state 2 on Polaris 5xx series cards:
</p>
<pre># echo "m 2 1850 850" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Double check the entered values, as mistakes might instantly cause fatal hardware damage!</div>
<p>To apply, run
</p>
<pre># echo "c" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>To check if it worked out, read out clocks and voltage under 3D load:
</p>
<pre># watch -n 0.5  cat /sys/kernel/debug/dri/0/amdgpu_pm_info
</pre>
<p>You can reset to the default values using this:
</p>
<pre># echo "r" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>It is also possible to forbid the driver so switch to certain P-states, e.g. to workaround problems with deep powersaving P-states like flickering artifacts or stutter. To force the highest VRAM P-state on a Polaris RX 5xx card, while still allowing the GPU itself to run with lower clocks, run:
</p>
<pre># echo "manual" &gt; /sys/class/drm/card0/device/power_dpm_force_performance_level
# echo "2" &gt;  /sys/class/drm/card0/device/pp_dpm_mclk
</pre>
<p>Allow only the three highest GPU P-states:
</p>
<pre># echo "5 6 7" &gt;  /sys/class/drm/card0/device/pp_dpm_sclk
</pre>
<p>To set the allowed maximum power consumption of the GPU to e.g. 50 Watts, run
</p>
<pre># echo 50000000 &gt; /sys/class/drm/card0/device/hwmon/hwmon0/power1_cap
</pre>
<p>Until Linux kernel 4.20, it will only be possible to decrease the value, not increase.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The above procedure was tested with a Polaris RX 560 card. There may be different behavior or bugs with different GPUs.</div>
<h4><span class="mw-headline" id="Assisted">Assisted</span></h4>
<p>If you are not inclined to fully manually overclock your GPU, there are some overclocking tools that are offered by the community to assist you to overclock and monitor your AMD GPU.
</p>
<h5><span class="mw-headline" id="CLI_tools">CLI tools</span></h5>
<ul><li>
<b>amdgpu-clocks</b> — A script that can be used to monitor and set custom power states for AMD GPUs. It also offers a Systemd service to apply the settings automatically upon boot.</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://github.com/sibradzic/amdgpu-clocks">https://github.com/sibradzic/amdgpu-clocks</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/amdgpu-clocks-git/">amdgpu-clocks-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h5><span class="mw-headline" id="GUI_tools">GUI tools</span></h5>
<ul><li>
<b>TuxClocker</b> — A Qt5 monitoring and overclocking tool.</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://github.com/Lurkki14/tuxclocker">https://github.com/Lurkki14/tuxclocker</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/tuxclocker/">tuxclocker</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/tuxclocker-git/">tuxclocker-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<ul><li>
<b>CoreCtrl</b> — A GUI overclocking tool with a WattMan-like UI that supports per-application profiles.</li></ul>
<dl><dd>
<a rel="nofollow"  href="https://gitlab.com/corectrl/corectrl">https://gitlab.com/corectrl/corectrl</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/corectrl/">corectrl</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/corectrl-git/">corectrl-git</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h4><span class="mw-headline" id="Startup_on_boot">Startup on boot</span></h4>
<p>If you want your settings to apply automatically upon boot, consider looking at this <a rel="nofollow"  href="https://www.reddit.com/r/Amd/comments/agwroj/how_to_overclock_your_amd_gpu_on_linux/">Reddit thread</a> to configure and apply your settings on boot.
</p>
<h3><span class="mw-headline" id="Enable_GPU_display_scaling">Enable GPU display scaling</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-go-next.png" ><img alt="Tango-go-next.png" src="../File:Tango-go-next.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for moving to <a href="/Usage/Configuration/X/Xrandr.html" title="Xrandr">xrandr</a>.</b><a href="../File:Tango-go-next.png" ><img alt="Tango-go-next.png" src="../File:Tango-go-next.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> Not specific to AMDGPU. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:AMDGPU#Moving_">"Enable_GPU_display_scaling"_to_xrandr Talk:AMDGPU#Moving "Enable GPU display scaling" to xrandr</a>)</div>
</div>
<p>To avoid the usage of the scaler which is built in the display, and use the GPU own scaler instead, when not using the native resolution of the monitor, execute:
</p>
<pre>$ xrandr --output <i>output</i> --set "scaling mode" <i>scaling_mode</i>
</pre>
<p>Possible values for <code>"scaling mode"</code> are: <code>None</code>, <code>Full</code>, <code>Center</code>, <code>Full aspect</code>.
</p>
<ul><li>To show the available outputs and settings, execute:</li></ul>
<pre>$ xrandr --prop
</pre>
<ul><li>To set <code>scaling mode = Full aspect</code> for just every available output, execute:</li></ul>
<pre>$ for output in $(xrandr --prop | grep -E -o -i "^[A-Z\-]+-[0-9]+"); do xrandr --output "$output" --set "scaling mode" "Full aspect"; done
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Xorg_or_applications_will_not_start">Xorg or applications will not start</span></h3>
<ul>
<li>"(EE) AMDGPU(0): [DRI2] DRI2SwapBuffers: drawable has no back or front?" error after opening glxgears, can open Xorg server but OpenGL apps crash.</li>
<li>"(EE) AMDGPU(0): Given depth (32) is not supported by amdgpu driver" error, Xorg will not start.</li>
</ul>
<p>Setting the screen's depth under Xorg to 16 or 32 will cause problems/crash. To avoid that, you should use a standard screen depth of 24 by adding this to your "screen" section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/10-screen.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Screen"
       Identifier     "Screen"
       DefaultDepth    24
       SubSection      "Display"
               Depth   24
       EndSubSection
EndSection
</pre>
<h3><span class="mw-headline" id="Screen_artifacts_and_frequency_problem">Screen artifacts and frequency problem</span></h3>
<p><a href="/Usage/Configuration/A/ATI.html#Dynamic_power_management" title="ATI">Dynamic power management</a> may cause screen artifacts to appear when displaying to monitors at higher frequencies (anything above 60Hz) due to issues in the way GPU clock speeds are managed<a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=96868">[1]</a><a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=102646">[2]</a>.
</p>
<p>A workaround <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=96868#c13">[3]</a> is saving <code>high</code> or <code>low</code> in <code>/sys/class/drm/card0/device/power_dpm_force_performance_level</code>.
</p>
<p>There is also a GUI solution <a rel="nofollow"  href="https://github.com/marazmista/radeon-profile">[4]</a> where you can manage the "power_dpm" with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/radeon-profile-git/">radeon-profile-git</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/radeon-profile-daemon-git/">radeon-profile-daemon-git</a></span><sup><small>AUR</small></sup>.
</p>
<h3>
<span id="R9_390_series_poor_performance_and.2For_instability"></span><span class="mw-headline" id="R9_390_series_poor_performance_and/or_instability">R9 390 series poor performance and/or instability</span>
</h3>
<p>If you experience issues <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=91880">[5]</a> with a AMD R9 390 series graphics card, set <code>radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1 amdgpu.dpm=1 amdgpu.dc=1</code> as <a href="/Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> to force the use of amdgpu driver instead of radeon.
</p>
<p>If it still does not work, try disabling DPM, by setting the <a href="/Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> to: <code>radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1</code>
</p>
<h3>
<span id="Freezes_with_.22.5Bdrm.5D_IP_block:gmc_v8_0_is_hung.21.22_kernel_error"></span><span class="mw-headline" id='Freezes_with_"[drm]_IP_block:gmc_v8_0_is_hung!"_kernel_error'>Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</span>
</h3>
<p>If you experience freezes and kernel crashes during a GPU intensive task with the kernel error " [drm] IP block:gmc_v8_0 is hung!" <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=102322">[6]</a>, a workaround is to set <code>amdgpu.vm_update_mode=3</code> as <a href="/Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> to force the GPUVM page tables update to be done using the CPU. Downsides are listed here <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=102322#c15">[7]</a>.
</p>
<h3><span class="mw-headline" id="Cursor_corruption">Cursor corruption</span></h3>
<p>If you experience issues with the mouse cursor sometimes not rendering properly, set <code>Option "SWCursor" "True"</code> in the <code>"Device"</code> section of the <code>/etc/X11/xorg.conf.d/20-amdgpu.conf</code> configuration file.
</p>
<p>If you are using <code>xrandr</code> for scaling and the cursor is flickering or disappearing, you may be able to fix it by setting the <code>TearFree</code> property: <code>xrandr --output HDMI-A-0 --set TearFree on</code>.
</p>
<h3><span class="mw-headline" id="System_freeze_or_crash_when_gaming_on_Vega_cards">System freeze or crash when gaming on Vega cards</span></h3>
<p><a href="/Usage/Configuration/A/ATI.html#Dynamic_power_management" title="ATI">Dynamic power management</a> may cause a complete system freeze whilst gaming due to issues in the way GPU clock speeds are managed. <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=109955">[8]</a> A workaround is to disable dynamic power management, see <a href="/Usage/Configuration/A/ATI.html#Dynamic_power_management" title="ATI">ATI#Dynamic power management</a> for details.
</p>
<h3><span class="mw-headline" id="Navi_power_consumption">Navi power consumption</span></h3>
<p>Some users have reported higher than usual idle power consumption when using kernel 5.3. There is a <a rel="nofollow"  href="https://cgit.freedesktop.org/~agd5f/linux/tag/?h=drm-next-5.4-2019-08-30">patch set</a> available for kernel 5.4 that appears to fix the issues.
</p>
<h3>
<span id="WebRenderer_.28Firefox.29_corruption"></span><span class="mw-headline" id="WebRenderer_(Firefox)_corruption">WebRenderer (Firefox) corruption</span>
</h3>
<p>Artifacts and other anomilies may present themselves (e.g. inability to select extension options) when <a href="/Usage/Configuration/F/Firefox/Tweaks.html#Enable_WebRender" title="Firefox/Tweaks">WebRenderer</a> is force enabled by the user. Workaround is to fall back to OpenGL compositing.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="/Usage/Configuration/C/Category:Graphics.html" title="Category:Graphics">Graphics</a></li>
<li><a href="/Usage/Configuration/C/Category:X_server.html" title="Category:X server">X server</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="/Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Move.html" title="Category:Pages or sections flagged with Template:Move">Pages or sections flagged with Template:Move</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=AMDGPU&amp;oldid=611778">https://wiki.archlinux.org/index.php?title=AMDGPU&amp;oldid=611778</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 9 May 2020, at 17:58.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="/Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="/Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="/Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



