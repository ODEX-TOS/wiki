<!--
title: AMDGPU
description: 
published: true
date: 2020-05-29T17:19:44.906Z
tags: 
-->

<p>&gt;</p><h1>AMDGPU</h1><p>From TOS Wiki</p><p><a href="#mw-head">Jump to navigation</a> <a href="#p-search">Jump to search</a></p><p>Related articles</p><ul><li><a href="./AMD_Catalyst.html">AMD Catalyst</a></li><li><a href="../wiki/ATI.html">ATI</a></li><li><a href="../wiki/Xorg.html">Xorg</a></li><li><a href="../wiki/Vulkan.html">Vulkan</a></li></ul><p><a href="https://en.wikipedia.org/wiki/AMDGPU">AMDGPU</a> is the open source graphics driver for AMD Radeon graphics cards from the <a href="https://en.wikipedia.org/wiki/Graphics_Core_Next">Graphics Core Next</a> family.</p><h2>Contents</h2><ul><li><a href="#Selecting_the_right_driver">1 Selecting the right driver</a></li><li><a href="#Installation">2 Installation</a><ul><li><a href="#Experimental">2.1 Experimental</a></li><li><a href="#Enable_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_support">2.2 Enable Southern Islands (SI) and Sea Islands (CIK) support</a><ul><li><a href="#Specify_the_correct_module_order">2.2.1 Specify the correct module order</a></li><li><a href="#Set_required_module_parameters">2.2.2 Set required module parameters</a><ul><li><a href="#Set_module_parameters_in_kernel_command_line">2.2.2.1 Set module parameters in kernel command line</a></li><li><a href="#Set_module_parameters_in_modprobe.d">2.2.2.2 Set module parameters in modprobe.d</a></li></ul></li></ul></li><li><a href="#AMDGPU_PRO">2.3 AMDGPU PRO</a></li><li><a href="#ACO_compiler">2.4 ACO compiler</a></li></ul></li><li><a href="#Loading">3 Loading</a><ul><li><a href="#Enable_early_KMS">3.1 Enable early KMS</a></li></ul></li><li><a href="#Xorg_configuration">4 Xorg configuration</a><ul><li><a href="#Tear_free_rendering">4.1 Tear free rendering</a></li><li><a href="#DRI_level">4.2 DRI level</a></li><li><a href="#Variable_refresh_rate">4.3 Variable refresh rate</a></li><li><a href="#10-bit_color">4.4 10-bit color</a></li></ul></li><li><a href="#Features">5 Features</a><ul><li><a href="#Video_acceleration">5.1 Video acceleration</a></li><li><a href="#Monitoring">5.2 Monitoring</a><ul><li><a href="#CLI_(default)">5.2.1 CLI (default)</a></li><li><a href="#GUI">5.2.2 GUI</a></li></ul></li><li><a href="#Overclocking">5.3 Overclocking</a><ul><li><a href="#Boot_parameter">5.3.1 Boot parameter</a></li><li><a href="#Manual_(default)">5.3.2 Manual (default)</a></li><li><a href="#Assisted">5.3.3 Assisted</a><ul><li><a href="#CLI_tools">5.3.3.1 CLI tools</a></li><li><a href="#GUI_tools">5.3.3.2 GUI tools</a></li></ul></li><li><a href="#Startup_on_boot">5.3.4 Startup on boot</a></li></ul></li><li><a href="#Enable_GPU_display_scaling">5.4 Enable GPU display scaling</a></li></ul></li><li><a href="#Troubleshooting">6 Troubleshooting</a><ul><li><a href="#Xorg_or_applications_will_not_start">6.1 Xorg or applications will not start</a></li><li><a href="#Screen_artifacts_and_frequency_problem">6.2 Screen artifacts and frequency problem</a></li><li><a href="#R9_390_series_poor_performance_and/or_instability">6.3 R9 390 series poor performance and/or instability</a></li><li><a href="#Freezes_with_%22%5Bdrm%5D_IP_block:gmc_v8_0_is_hung!%22_kernel_error">6.4 Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</a></li><li><a href="#Cursor_corruption">6.5 Cursor corruption</a></li><li><a href="#System_freeze_or_crash_when_gaming_on_Vega_cards">6.6 System freeze or crash when gaming on Vega cards</a></li><li><a href="#Navi_power_consumption">6.7 Navi power consumption</a></li><li><a href="#WebRenderer_(Firefox)_corruption">6.8 WebRenderer (Firefox) corruption</a></li></ul></li></ul><h2>Selecting the right driver</h2><p>Depending on the card you have, find the right driver in <a href="../wiki/Xorg.html#AMD">Xorg#AMD</a>. This page has instructions for <strong>AMDGPU</strong> and <strong>AMDGPU PRO</strong>. At the moment there is Xorg <a href="../wiki/ATI.html">radeon</a> driver support for <a href="https://www.x.org/wiki/RadeonFeature/">Southern Islands (SI)</a> through Arctic Islands (AI) cards. AMD has no plans to support pre-GCN GPUs. Owners of unsupported GPUs may use the open source <a href="../wiki/ATI.html">radeon</a> or the <a href="../wiki/AMD_Catalyst.html">AMD Catalyst</a> driver .</p><h2>Installation</h2><p><strong>Note:</strong> If coming from the proprietary Catalyst driver, see <a href="../wiki/AMD_Catalyst.html#Uninstallation">AMD Catalyst#Uninstallation</a> first.</p><p><a href="../wiki/Help:Reading.html#Installation_of_packages">Install</a> the <a href="https://www.archlinux.org/packages/?name=mesa">mesa</a> package, which provides the DRI driver for 3D acceleration.</p><ul><li>For 32-bit application support, also install the <a href="https://www.archlinux.org/packages/?name=lib32-mesa">lib32-mesa</a> package from the <a href="../wiki/Official_repositories.html#multilib">multilib</a> repostory.</li><li>For the DDX driver (which provides 2D acceleration in <a href="../wiki/Xorg.html">Xorg</a>), install the <a href="https://www.archlinux.org/packages/?name=xf86-video-amdgpu">xf86-video-amdgpu</a> package.</li><li>For <a href="../wiki/Vulkan.html">Vulkan</a> support, install the <a href="https://www.archlinux.org/packages/?name=vulkan-radeon">vulkan-radeon</a> package. Optionally install the <a href="https://www.archlinux.org/packages/?name=lib32-vulkan-radeon">lib32-vulkan-radeon</a> package for 32-bit application support.</li></ul><p>Support for <a href="#Video_acceleration">accelerated video decoding</a> is provided by <a href="https://www.archlinux.org/packages/?name=libva-mesa-driver">libva-mesa-driver</a> and <a href="https://www.archlinux.org/packages/?name=lib32-libva-mesa-driver">lib32-libva-mesa-driver</a> for VA-API and <a href="https://www.archlinux.org/packages/?name=mesa-vdpau">mesa-vdpau</a> and <a href="https://www.archlinux.org/packages/?name=lib32-mesa-vdpau">lib32-mesa-vdpau</a> packages for VDPAU.</p><h3>Experimental</h3><p>It may be worthwhile for some users to use the upstream experimental build of mesa, to enable features such as AMD Navi improvements that have not landed in the standard mesa packages.</p><p>Install the <a href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a>AUR package, which provides the DRI driver for 3D acceleration.</p><ul><li>For 32-bit application support, also install the <a href="https://aur.archlinux.org/packages/lib32-mesa-git/">lib32-mesa-git</a>AUR package from the <i>mesa-git</i> repository or the <a href="../wiki/TOS_User_Repository.html">AUR</a>.</li><li>For the DDX driver (which provides 2D acceleration in <a href="../wiki/Xorg.html">Xorg</a>), install the <a href="https://aur.archlinux.org/packages/xf86-video-amdgpu-git/">xf86-video-amdgpu-git</a>AUR package.</li><li>For <a href="../wiki/Vulkan.html">Vulkan</a> support using the <i>mesa-git</i> repository below, install the <i>vulkan-radeon-git</i> package. Optionally install the <i>lib32-vulkan-radeon-git</i> package for 32-bit application support. This should not be required if building <a href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a>AUR from the AUR.</li></ul><p><strong>Note:</strong> It may be necessary to symlink LibLLVM for X to start. For example, ln -s /usr/lib/libLLVM-10git.so /usr/lib/libLLVM-10svn.so</p><p><strong>Tip:</strong> Users who do not wish to go through the process of compiling the <a href="https://aur.archlinux.org/packages/mesa-git/">mesa-git</a>AUR package can use the <a href="../wiki/Unofficial_user_repositories.html#mesa-git">mesa-git</a> unofficial repository.</p><h3>Enable Southern Islands (SI) and Sea Islands (CIK) support</h3><p>The <a href="https://www.archlinux.org/packages/?name=linux">linux</a> package enables AMDGPU support for cards of the Southern Islands (SI) and Sea Islands (CIK). When building or compiling a <a href="../wiki/Kernel.html">kernel</a>, CONFIG_DRM_AMDGPU_SI=Y and/or CONFIG_DRM_AMDGPU_CIK=Y should be be set in the config.</p><h4>Specify the correct module order</h4><p>Even when AMDGPU support for SI/CIK has been enabled by the kernel, the <a href="../wiki/ATI.html">radeon</a> driver may be loaded before the amdgpu driver.</p><p>Make sure amdgpu has been set as first module in the <a href="../wiki/Mkinitcpio.html#MODULES">Mkinitcpio#MODULES</a> array, e.g. MODULES=(amdgpu radeon).</p><h4>Set required module parameters</h4><p>The <a href="../wiki/Kernel_module.html#Setting_module_options">module parameters</a> of both amdgpu and radeon modules are cik_support= and si_support=.</p><p>They need to be set as kernel parameters or in a <i>modprobe</i> configuration file, and depend on the cards GCN version.</p><p><strong>Tip:</strong> <a href="../wiki/Core_utilities.html#Essentials">dmesg</a> may indicate the correct kernel parameter to use: [..] amdgpu 0000:01:00.0: Use radeon.cik_support=0 amdgpu.cik_support=1 to override.</p><h5>Set module parameters in kernel command line</h5><p>Set one of the following <a href="../wiki/Kernel_parameters.html">kernel parameters</a>:</p><ul><li>Southern Islands (SI): radeon.si_support=0 amdgpu.si_support=1</li><li>Sea Islands (CIK): radeon.cik_support=0 amdgpu.cik_support=1</li></ul><h5>Set module parameters in modprobe.d</h5><p>Create the configuration <a href="../wiki/Kernel_module.html">modprobe</a> files in /etc/modprobe.d/, see <a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/modprobe.d.5">modprobe.d(5)</a> for syntax details.</p><p>For Southern Islands (SI) use option si_support=1, for Sea Islands (CIK) use option cik_support=1, e.g.:</p><p>/etc/modprobe.d/amdgpu.conf options amdgpu si_support=1
options amdgpu cik_support=0 /etc/modprobe.d/radeon.conf options radeon si_support=0
options radeon cik_support=0</p><p>Make sure modconf is in the the HOOKS array in /etc/mkinitcpio.conf and <a href="../wiki/Mkinitcpio.html#Image_creation_and_activation">regenerate the initramfs</a>.</p><h3>AMDGPU PRO</h3><p>AMD provides a proprietary, binary userland driver called <i>AMDGPU PRO</i>, which works on top of the open-source AMDGPU kernel driver.</p><p>From <a href="http://www.phoronix.com/vr.php?view=27266">Radeon Software 18.50 vs Mesa 19 benchmarks</a> article: When it comes to OpenGL games, the RadeonSI Gallium3D driver simply dominates the proprietary AMD OpenGL driver.</p><p>Install the <a href="https://aur.archlinux.org/packages/amdgpu-pro-libgl/">amdgpu-pro-libgl</a>AUR. Optionally install the <a href="https://aur.archlinux.org/packages/lib32-amdgpu-pro-libgl/">lib32-amdgpu-pro-libgl</a>AUR package for 32-bit application support.</p><p><strong>Note:</strong> Users of graphic cards other than Radeon Pro are <a href="https://www.amd.com/wiki/support/kb/release-notes/amdgpu-installation">advised to use the amdgpu graphics stack</a>.</p><h3>ACO compiler</h3><p>The <a href="https://steamcommunity.com/games/221410/announcements/detail/1602634609636894200">ACO compiler</a> is an open source shader compiler created and developed by <a href="https://en.wikipedia.org/wiki/Valve_Corporation">Valve Corporation</a> to directly compete with the <a href="http://llvm.org/">LLVM compiler</a>, the <a href="https://github.com/GPUOpen-Drivers/AMDVLK">AMDVLK drivers</a>, as well as <a href="https://en.wikipedia.org/wiki/Windows_10">Windows 10</a>. It offers lesser compilation time and also performs better while gaming than LLVM and AMDVLK.</p><p>Some benchmarks can be seen in <a href="https://itsfoss.com/linux-games-performance-boost-amd-gpu/">It's FOSS</a> and Phoronix <a href="https://www.phoronix.com/scan.php?page=article&amp;item=radv-aco-llvm&amp;num=1">(1)</a> <a href="https://www.phoronix.com/scan.php?page=article&amp;item=radv-aco-gcn10&amp;num=1">(2)</a> <a href="https://www.phoronix.com/scan.php?page=article&amp;item=mesa20radv-aco-amdvlk&amp;num=1">(3)</a>.</p><p><strong>Warning:</strong> ACO is a very early development and still is marked as <strong>testing</strong>, you may experience issues.</p><p>Since <a href="https://www.archlinux.org/packages/?name=mesa">mesa</a> version 19.3, the ACO compiler is available in the official package, but disabled by default. It can be enabled by <a href="../wiki/Environment_variables.html#Defining_variables">exporting</a> RADV_PERFTEST=aco before starting an application.</p><h2>Loading</h2><p>The amdgpu kernel module should load fine automatically on system boot.</p><p>If it does not happen, then:</p><ul><li>Make sure to <a href="#Enable_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_support">#Enable Southern Islands (SI) and Sea Islands (CIK) support</a> when needed.</li><li>Make sure you have the latest <a href="https://www.archlinux.org/packages/?name=linux-firmware">linux-firmware</a> package installed. This driver requires the latest firmware for each model to successfully boot.</li><li>Make sure you do <strong>not</strong> have nomodeset or vga= as a <a href="../wiki/Kernel_parameters.html">kernel parameter</a>, since amdgpu requires <a href="../wiki/Kernel_mode_setting.html">KMS</a>.</li><li>Check that you have not disabled amdgpu by using any <a href="../wiki/Kernel_module.html#Blacklisting">kernel module blacklisting</a>.</li></ul><h3>Enable early KMS</h3><p>See <a href="../wiki/Kernel_mode_setting.html#Early_KMS_start">Kernel mode setting#Early KMS start</a>.</p><h2>Xorg configuration</h2><p><a href="../wiki/Xorg.html">Xorg</a> will automatically load the driver and it will use your monitor's EDID to set the native resolution. Configuration is only required for tuning the driver.</p><p>If you want manual configuration, create /etc/X11/xorg.conf.d/20-amdgpu.conf, and add the following:</p><p>/etc/X11/xorg.conf.d/20-amdgpu.conf Section "Device"
 &nbsp; &nbsp; Identifier "AMD"
 &nbsp; &nbsp; Driver "amdgpu"
EndSection</p><p>Using this section, you can enable features and tweak the driver settings, see <a href="https://jlk.fjfi.cvut.cz/arch/manpages/man/amdgpu.4">amdgpu(4)</a> first before setting driver options.</p><h3>Tear free rendering</h3><p><i>TearFree</i> controls tearing prevention using the hardware page flipping mechanism. If this option is set, the default value of the property is 'on' or 'off' accordingly. If this option is not set, the default value of the property is auto, which means that TearFree is on for rotated outputs, outputs with RandR transforms applied and for RandR 1.4 slave outputs, otherwise off:</p><p>Option "TearFree" "true"
</p><p>You can also enable TearFree temporarily with <a href="../wiki/Xrandr.html">xrandr</a>:</p><p>$ xrandr --output <i>output</i> --set TearFree on
</p><p>Where <i>output</i> should look like DisplayPort-0 or HDMI-A-0 and can be acquired by running xrandr -q.</p><h3>DRI level</h3><p><i>DRI</i> sets the maximum level of DRI to enable. Valid values are <i>2</i> for DRI2 or <i>3</i> for DRI3. The default is <i>3</i> for DRI3 if the <a href="../wiki/Xorg.html">Xorg</a> version is &gt;= 1.18.3, otherwise DRI2 is used:</p><p>Option "DRI" "3"
</p><h3>Variable refresh rate</h3><p>See <a href="../wiki/Variable_refresh_rate.html">Variable refresh rate</a>.</p><h3>10-bit color</h3><p>Newer AMD cards support 10bpc color, but the default is 24-bit color and 30-bit color must be explicitly enabled. To check if your monitor supports it search for "EDID" in your <a href="../wiki/Xorg.html#General">Xorg log file</a> (e.g. /var/log/Xorg.0.log or ~/.local/share/xorg/Xorg.0.log):</p><p>[ &nbsp; 336.695] (II) AMDGPU(0): EDID for output DisplayPort-0
[ &nbsp; 336.695] (II) AMDGPU(0): EDID for output DisplayPort-1
[ &nbsp; 336.695] (II) AMDGPU(0): Manufacturer: DEL &nbsp;Model: a0ec &nbsp;Serial#: 123456789
[ &nbsp; 336.695] (II) AMDGPU(0): Year: 2018 &nbsp;Week: 23
[ &nbsp; 336.695] (II) AMDGPU(0): EDID Version: 1.4
[ &nbsp; 336.695] (II) AMDGPU(0): Digital Display Input
<strong>[ &nbsp; 336.695] (II) AMDGPU(0): 10 bits per channel</strong>
</p><p>To check whether it is currently enabled search for "Depth"):</p><p>[ &nbsp; 336.618] (**) AMDGPU(0): Depth 30, (--) framebuffer bpp 32
[ &nbsp; 336.618] (II) AMDGPU(0): Pixel depth = 30 bits stored in 4 bytes (32 bpp pixmaps)
</p><p>With the default configuration it will instead say the depth is 24, with 24 bits stored in 4 bytes.</p><p>To check whether 10-bit works, exit Xorg if you have it running and run Xorg -retro which will display a black and white grid, then press Ctrl-Alt-F1 and Ctrl-C to exit X, and run Xorg -depth 30 -retro. If this works fine, then 10-bit is working.</p><p>To launch in 10-bit via startx, use startx -- -depth 30. To permanently enable it, create or add to:</p><p>/etc/X11/xorg.conf.d/20-amdgpu.conf Section "Screen"
	Identifier "asdf"
	DefaultDepth 30
EndSection</p><p>If you use KDE, KWin's compositor doesn't work properly <a href="https://bugs.kde.org/show_bug.cgi?id=417455">(bug)</a>, apparently due to issues with AMDGPU. Comment 5 on that bug contains a workaround.</p><p>Various other software may also crash or have graphical artifacts with 10-bit color.</p><h2>Features</h2><h3>Video acceleration</h3><p>See <a href="../wiki/Hardware_video_acceleration.html">Hardware video acceleration</a>.</p><h3>Monitoring</h3><p>Monitoring your GPU is often used to check the temperature and also the P-states of your GPU.</p><h4>CLI (default)</h4><p>To check your GPU's P-states, execute:</p><p>$ cat /sys/class/drm/card0/device/pp_od_clk_voltage
</p><p>To monitor your GPU, execute:</p><p>$ watch -n 0.5 &nbsp;cat /sys/kernel/debug/dri/0/amdgpu_pm_info
</p><h4>GUI</h4><ul><li><strong>WattmanGTK</strong> — A GTK GUI tool to monitor your GPU's temperatures P-states</li></ul><p>&nbsp;</p><p><a href="https://github.com/BoukeHaarsma23/WattmanGTK">https://github.com/BoukeHaarsma23/WattmanGTK</a> || <a href="https://aur.archlinux.org/packages/wattman-gtk-git/">wattman-gtk-git</a>AUR.</p><p>&nbsp;</p><ul><li><strong>TuxClocker</strong> — A Qt5 monitoring and overclocking tool.</li></ul><p>&nbsp;</p><p><a href="https://github.com/Lurkki14/tuxclocker">https://github.com/Lurkki14/tuxclocker</a> || <a href="https://aur.archlinux.org/packages/tuxclocker/">tuxclocker</a>AUR <a href="https://aur.archlinux.org/packages/tuxclocker-git/">tuxclocker-git</a>AUR&nbsp;</p><h3>Overclocking</h3><p>Since Linux 4.17, it is possible to adjust clocks and voltages of the graphics card via /sys/class/drm/card0/device/pp_od_clk_voltage.</p><h4>Boot parameter</h4><p>It is required to unlock access to adjust clocks and voltages in sysfs by appending the <a href="../wiki/Kernel_parameters.html">Kernel parameter</a> amdgpu.ppfeaturemask=0xffffffff.</p><h4>Manual (default)</h4><p><strong>Note:</strong> In sysfs, paths like /sys/class/drm/... are just symlinks and may change between reboots. Persistent locations can be found in /sys/devices/, e.g. /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/. Adjust the commands accordingly for a reliable result.</p><p>To set the GPU clock for the maximum P-state 7 on e.g. a Polaris GPU to 1209MHz and 900mV voltage, run:</p><p># echo "s 7 1209 900" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</p><p>The same procedure can be applied to the VRAM, e.g. maximum P-state 2 on Polaris 5xx series cards:</p><p># echo "m 2 1850 850" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</p><p><strong>Warning:</strong> Double check the entered values, as mistakes might instantly cause fatal hardware damage!</p><p>To apply, run</p><p># echo "c" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</p><p>To check if it worked out, read out clocks and voltage under 3D load:</p><p># watch -n 0.5 &nbsp;cat /sys/kernel/debug/dri/0/amdgpu_pm_info
</p><p>You can reset to the default values using this:</p><p># echo "r" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</p><p>It is also possible to forbid the driver so switch to certain P-states, e.g. to workaround problems with deep powersaving P-states like flickering artifacts or stutter. To force the highest VRAM P-state on a Polaris RX 5xx card, while still allowing the GPU itself to run with lower clocks, run:</p><p># echo "manual" &gt; /sys/class/drm/card0/device/power_dpm_force_performance_level
# echo "2" &gt; &nbsp;/sys/class/drm/card0/device/pp_dpm_mclk
</p><p>Allow only the three highest GPU P-states:</p><p># echo "5 6 7" &gt; &nbsp;/sys/class/drm/card0/device/pp_dpm_sclk
</p><p>To set the allowed maximum power consumption of the GPU to e.g. 50 Watts, run</p><p># echo 50000000 &gt; /sys/class/drm/card0/device/hwmon/hwmon0/power1_cap
</p><p>Until Linux kernel 4.20, it will only be possible to decrease the value, not increase.</p><p><strong>Note:</strong> The above procedure was tested with a Polaris RX 560 card. There may be different behavior or bugs with different GPUs.</p><h4>Assisted</h4><p>If you are not inclined to fully manually overclock your GPU, there are some overclocking tools that are offered by the community to assist you to overclock and monitor your AMD GPU.</p><h5>CLI tools</h5><ul><li><strong>amdgpu-clocks</strong> — A script that can be used to monitor and set custom power states for AMD GPUs. It also offers a Systemd service to apply the settings automatically upon boot.</li></ul><p>&nbsp;</p><p><a href="https://github.com/sibradzic/amdgpu-clocks">https://github.com/sibradzic/amdgpu-clocks</a> || <a href="https://aur.archlinux.org/packages/amdgpu-clocks-git/">amdgpu-clocks-git</a>AUR&nbsp;</p><h5>GUI tools</h5><ul><li><strong>TuxClocker</strong> — A Qt5 monitoring and overclocking tool.</li></ul><p>&nbsp;</p><p><a href="https://github.com/Lurkki14/tuxclocker">https://github.com/Lurkki14/tuxclocker</a> || <a href="https://aur.archlinux.org/packages/tuxclocker/">tuxclocker</a>AUR <a href="https://aur.archlinux.org/packages/tuxclocker-git/">tuxclocker-git</a>AUR&nbsp;</p><ul><li><strong>CoreCtrl</strong> — A GUI overclocking tool with a WattMan-like UI that supports per-application profiles.</li></ul><p>&nbsp;</p><p><a href="https://gitlab.com/corectrl/corectrl">https://gitlab.com/corectrl/corectrl</a> || <a href="https://aur.archlinux.org/packages/corectrl/">corectrl</a>AUR <a href="https://aur.archlinux.org/packages/corectrl-git/">corectrl-git</a>AUR&nbsp;</p><h4>Startup on boot</h4><p>If you want your settings to apply automatically upon boot, consider looking at this <a href="https://www.reddit.com/r/Amd/comments/agwroj/how_to_overclock_your_amd_gpu_on_linux/">Reddit thread</a> to configure and apply your settings on boot.</p><h3>Enable GPU display scaling</h3><figure class="image"><img src="../File:Tango-go-next.png" alt="Tango-go-next.png"></figure><p><strong>This article or section is a candidate for moving to </strong><a href="../wiki/Xrandr.html"><strong>xrandr</strong></a><strong>.</strong></p><figure class="image"><img src="../File:Tango-go-next.png" alt="Tango-go-next.png"></figure><p><strong>Notes:</strong> Not specific to AMDGPU. (Discuss in <a href="https://wiki.archlinux.org/index.php/Talk:AMDGPU#Moving_">"Enable_GPU_display_scaling"_to_xrandr Talk:AMDGPU#Moving "Enable GPU display scaling" to xrandr</a>)</p><p>To avoid the usage of the scaler which is built in the display, and use the GPU own scaler instead, when not using the native resolution of the monitor, execute:</p><p>$ xrandr --output <i>output</i> --set "scaling mode" <i>scaling_mode</i>
</p><p>Possible values for "scaling mode" are: None, Full, Center, Full aspect.</p><ul><li>To show the available outputs and settings, execute:</li></ul><p>&nbsp;$ xrandr --prop
</p><ul><li>To set scaling mode = Full aspect for just every available output, execute:</li></ul><p>&nbsp;$ for output in $(xrandr --prop | grep -E -o -i "^[A-Z\-]+-[0-9]+"); do xrandr --output "$output" --set "scaling mode" "Full aspect"; done
</p><h2>Troubleshooting</h2><h3>Xorg or applications will not start</h3><ul><li>"(EE) AMDGPU(0): [DRI2] DRI2SwapBuffers: drawable has no back or front?" error after opening glxgears, can open Xorg server but OpenGL apps crash.</li><li>"(EE) AMDGPU(0): Given depth (32) is not supported by amdgpu driver" error, Xorg will not start.</li></ul><p>Setting the screen's depth under Xorg to 16 or 32 will cause problems/crash. To avoid that, you should use a standard screen depth of 24 by adding this to your "screen" section:</p><p>/etc/X11/xorg.conf.d/10-screen.conf Section "Screen"
 &nbsp; &nbsp; &nbsp; Identifier &nbsp; &nbsp; "Screen"
 &nbsp; &nbsp; &nbsp; DefaultDepth &nbsp; &nbsp;24
 &nbsp; &nbsp; &nbsp; SubSection &nbsp; &nbsp; &nbsp;"Display"
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Depth &nbsp; 24
 &nbsp; &nbsp; &nbsp; EndSubSection
EndSection
</p><h3>Screen artifacts and frequency problem</h3><p><a href="../wiki/ATI.html#Dynamic_power_management">Dynamic power management</a> may cause screen artifacts to appear when displaying to monitors at higher frequencies (anything above 60Hz) due to issues in the way GPU clock speeds are managed<a href="https://bugs.freedesktop.org/show_bug.cgi?id=96868">[1]</a><a href="https://bugs.freedesktop.org/show_bug.cgi?id=102646">[2]</a>.</p><p>A workaround <a href="https://bugs.freedesktop.org/show_bug.cgi?id=96868#c13">[3]</a> is saving high or low in /sys/class/drm/card0/device/power_dpm_force_performance_level.</p><p>There is also a GUI solution <a href="https://github.com/marazmista/radeon-profile">[4]</a> where you can manage the "power_dpm" with <a href="https://aur.archlinux.org/packages/radeon-profile-git/">radeon-profile-git</a>AUR and <a href="https://aur.archlinux.org/packages/radeon-profile-daemon-git/">radeon-profile-daemon-git</a>AUR.</p><h3>R9 390 series poor performance and/or instability</h3><p>If you experience issues <a href="https://bugs.freedesktop.org/show_bug.cgi?id=91880">[5]</a> with a AMD R9 390 series graphics card, set radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1 amdgpu.dpm=1 amdgpu.dc=1 as <a href="../wiki/Kernel_parameters.html">kernel parameters</a> to force the use of amdgpu driver instead of radeon.</p><p>If it still does not work, try disabling DPM, by setting the <a href="../wiki/Kernel_parameters.html">kernel parameters</a> to: radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1</p><h3>Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</h3><p>If you experience freezes and kernel crashes during a GPU intensive task with the kernel error " [drm] IP block:gmc_v8_0 is hung!" <a href="https://bugs.freedesktop.org/show_bug.cgi?id=102322">[6]</a>, a workaround is to set amdgpu.vm_update_mode=3 as <a href="../wiki/Kernel_parameters.html">kernel parameters</a> to force the GPUVM page tables update to be done using the CPU. Downsides are listed here <a href="https://bugs.freedesktop.org/show_bug.cgi?id=102322#c15">[7]</a>.</p><h3>Cursor corruption</h3><p>If you experience issues with the mouse cursor sometimes not rendering properly, set Option "SWCursor" "True" in the "Device" section of the /etc/X11/xorg.conf.d/20-amdgpu.conf configuration file.</p><p>If you are using xrandr for scaling and the cursor is flickering or disappearing, you may be able to fix it by setting the TearFree property: xrandr --output HDMI-A-0 --set TearFree on.</p><h3>System freeze or crash when gaming on Vega cards</h3><p><a href="../wiki/ATI.html#Dynamic_power_management">Dynamic power management</a> may cause a complete system freeze whilst gaming due to issues in the way GPU clock speeds are managed. <a href="https://bugs.freedesktop.org/show_bug.cgi?id=109955">[8]</a> A workaround is to disable dynamic power management, see <a href="../wiki/ATI.html#Dynamic_power_management">ATI#Dynamic power management</a> for details.</p><h3>Navi power consumption</h3><p>Some users have reported higher than usual idle power consumption when using kernel 5.3. There is a <a href="https://cgit.freedesktop.org/~agd5f/linux/tag/?h=drm-next-5.4-2019-08-30">patch set</a> available for kernel 5.4 that appears to fix the issues.</p><h3>WebRenderer (Firefox) corruption</h3><p>Artifacts and other anomilies may present themselves (e.g. inability to select extension options) when <a href="../wiki/Firefox/Tweaks.html#Enable_WebRender">WebRenderer</a> is force enabled by the user. Workaround is to fall back to OpenGL compositing.</p><p><a href="../Special:Categories.html">Categories</a>:&nbsp;</p><ul><li><a href="../wiki/Category:Graphics.html">Graphics</a></li><li><a href="../wiki/Category:X_server.html">X server</a></li></ul><p>Hidden category:&nbsp;</p><ul><li><a href="../wiki/Category:Pages_or_sections_flagged_with_Template:Move.html">Pages or sections flagged with Template:Move</a></li><li>Retrieved from "<a href="https://wiki.archlinux.org/index.php?title=AMDGPU&amp;oldid=611778">https://wiki.archlinux.org/index.php?title=AMDGPU&amp;oldid=611778</a>"</li><li>This page was last edited on 9 May 2020, at 17:58.</li><li>Content is available under <a href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li><li><a href="../wiki/TOS Wiki:Privacy_policy.html">Privacy policy</a></li><li><a href="../wiki/TOS Wiki:About.html">About TOS Wiki</a></li><li><a href="../wiki/TOS Wiki:General_disclaimer.html">Disclaimers</a></li><li>&nbsp;</li></ul>