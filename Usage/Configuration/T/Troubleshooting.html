<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Music Player Daemon/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/M/Music_Player_Daemon.html" title="Music Player Daemon">Music Player Daemon</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p>Go back to <a href="..//Usage/Configuration/M/Music_Player_Daemon.html" title="Music Player Daemon">Music Player Daemon</a>.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Troubleshooting"><span >1</span> <span >Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Autodetection_failed"><span >1.1</span> <span >Autodetection failed</span></a></li>
<li class="toclevel-2 tocsection-3">
<a href="#MPD_hangs_on_first_startup"><span >1.2</span> <span >MPD hangs on first startup</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Easy_Tag"><span >1.2.1</span> <span >Easy Tag</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Kid3"><span >1.2.2</span> <span >Kid3</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Cannot_connect_to_mpd:_host_%22localhost%22_not_found:_Temporary_failure_in_name_resolution"><span >1.3</span> <span >Cannot connect to mpd: host "localhost" not found: Temporary failure in name resolution</span></a></li>
<li class="toclevel-2 tocsection-7">
<a href="#Other_issues_when_attempting_to_connect_to_mpd_with_a_client"><span >1.4</span> <span >Other issues when attempting to connect to mpd with a client</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#First_fix"><span >1.4.1</span> <span >First fix</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Second_fix"><span >1.4.2</span> <span >Second fix</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Binding_to_IPV6_before_IPV4"><span >1.5</span> <span >Binding to IPV6 before IPV4</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#daemon:_cannot_setgid_for_user_%22mpd%22:_Operation_not_permitted"><span >1.6</span> <span >daemon: cannot setgid for user "mpd": Operation not permitted</span></a></li>
<li class="toclevel-2 tocsection-12">
<a href="#daemon:_fatal_error:_Failed_to_set_group_NN:_Operation_not_permitted"><span >1.7</span> <span >daemon: fatal_error: Failed to set group NN: Operation not permitted</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#First_fix_2"><span >1.7.1</span> <span >First fix</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Second_fix_2"><span >1.7.2</span> <span >Second fix</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Third_fix"><span >1.7.3</span> <span >Third fix</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16">
<a href="#MPD_&amp;_ALSA"><span >1.8</span> <span >MPD &amp; ALSA</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#High_CPU_usage_with_ALSA"><span >1.8.1</span> <span >High CPU usage with ALSA</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Playing_audio_files_with_different_rate_(works_for_EMU_0202/0204/0404)"><span >1.8.2</span> <span >Playing audio files with different rate (works for EMU 0202/0204/0404)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#Changing_user"><span >1.9</span> <span >Changing user</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#MPD_includes_music_from_hidden_folders_in_database"><span >1.10</span> <span >MPD includes music from hidden folders in database</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Autodetection_failed">Autodetection failed</span></h3>
<p>During the start of MPD, it tries to autodetect your set-up and configure output and volume control accordingly. Though this mostly goes well, it will fail for some systems. It may help to tell MPD specifically what to use as output and mixer control. If you copied <code>/etc/mpd.conf</code> over from <code>/etc/mpd.conf.example</code> as mentioned above, you can simply uncomment:
</p>
<p>Example for alsa output type and alsa mixer:
</p>
<pre>audio_output {
	type			"alsa"
	name			"My ALSA Device"
	device			"hw:0,0"	# optional
	format			"44100:16:2"	# optional
	mixer_type		"hardware"
	mixer_device		"default"
	mixer_control		"PCM"
}
</pre>
<p><b>Note:</b> in case of permission problems when using ESD with MPD run this as root:
</p>
<pre># chsh -s /bin/true mpd
</pre>
<h3><span class="mw-headline" id="MPD_hangs_on_first_startup">MPD hangs on first startup</span></h3>
<p>This is a common error that's caused by corrupt mp3 tags.
Here is an experimental way to solve this issue.
Requirements:
</p>
<ul>
<li>kid3</li>
<li>easytag</li>
</ul>
<p>This method is very tedious, especially with a huge database. Just as a baseline it took 2.5h to fix a 16GB database.
</p>
<h4><span class="mw-headline" id="Easy_Tag">Easy Tag</span></h4>
<p>The purpose of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=easytag">easytag</a></span> here is that easytag detects the error in the tags, but like MPD it hangs and dies. The trick here is that easy tags actually tells you what file is causing the problem on the status bar.
Before starting easytag make sure to have a terminal close to be ready to kill easy tag to avoid a hang. Once you are ready, on the tree view select the directory where all your music is located. By default easytag starts to search all subdirectories for mp3 files. Once you notice that easytag stopped scanning for songs, make note of the culprit and kill easytag.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This task can also be achieved by editing mpd's config file and setting "log_level" from "default" to "verbose". restart mpd and look up the last entry in mpd's log file after mpd hangs. It is recommended to set "log_level" back to "default" after debugging, since the log file grows fast.</div>
<h4><span class="mw-headline" id="Kid3">Kid3</span></h4>
<p>Here's where <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=kid3">kid3</a></span> comes in handy. With kid3 go to the offending song and rewrite one of the tags. then save the file. This should force kid3 to rewrite the whole tag again fixing the problem with MPD and easy tag hanging.
</p>
<p>Repeat this procedure until your music library is done.
</p>
<h3>
<span id="Cannot_connect_to_mpd:_host_.22localhost.22_not_found:_Temporary_failure_in_name_resolution"></span><span class="mw-headline" id='Cannot_connect_to_mpd:_host_"localhost"_not_found:_Temporary_failure_in_name_resolution'>Cannot connect to mpd: host "localhost" not found: Temporary failure in name resolution</span>
</h3>
<p>Cannot connect to MPD (with ncmpcpp), if you are disconnected from network. Solution is <a href="..//Usage/Configuration/I/IPv6.html#Disable_IPv6" class="mw-redirect" title="IPv6 - Disabling the Module">disable IPv6</a> or add line to /etc/hosts
</p>
<pre>::1 localhost.localdomain localhost
</pre>
<h3><span class="mw-headline" id="Other_issues_when_attempting_to_connect_to_mpd_with_a_client">Other issues when attempting to connect to mpd with a client</span></h3>
<p>Some have reported being unable to access mpd with various clients, for example seeing errors like these:
</p>
<pre>$ ncmpcpp
Cannot connect to mpd: Connection closed by the server
$ sonata
2011-02-13 18:33:05  Connection lost while reading MPD hello
2011-02-13 18:33:05  Not connected
2011-02-13 18:33:05  Not connected
</pre>
<p>Please see posts on ncmpcpp on the TOS Forums <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=109962">HERE</a> and <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=113493">HERE</a>. Also see <a rel="nofollow"  href="https://bugs.archlinux.org/task/22071">FS#22071</a>.
</p>
<h4><span class="mw-headline" id="First_fix">First fix</span></h4>
<p>Check <code>mpd.conf</code> for a line like <code>mpd.error</code> and remove it. The mpd error file is deprecated and has been removed.
</p>
<h4><span class="mw-headline" id="Second_fix">Second fix</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> I'm not so sure this is a good idea. There is a warning about changing the address to bind to in the default mpd.conf. If this does not help, you might want to comment out the changes.</div>
<p>If that doesn't help, add the following to <code>mpd.conf</code>:
</p>
<pre> bind_to_address "127.0.0.1"
 port "6600"
</pre>
<p>Afterwards, instruct your client to connect via 127.0.0.1. For example, add the following to the ncmpcpp config file:
</p>
<pre> mpd_host "127.0.0.1"
 mpd_port "6600"
</pre>
<h3><span class="mw-headline" id="Binding_to_IPV6_before_IPV4">Binding to IPV6 before IPV4</span></h3>
<p>If on startup, mpd displays the following message:
</p>
<pre>listen: bind to '0.0.0.0:6600' failed: Address already in use (continuing anyway, because binding to '[::]:6600' succeeded)
</pre>
<p>it means mpd binds to the ipv6 interface before binding to ipv4. If you want to use your ipv4 interface, hardcode it in <code>mpd.conf</code>, like:
</p>
<pre>bind_to_address "0.0.0.0"
</pre>
<p>Several binds can also be specified, for example, to have mpd listen both to localhost and to the external IP of your network card:
</p>
<pre>bind_to_address "127.0.0.1"
bind_to_address "192.168.1.13"
</pre>
<h3>
<span id="daemon:_cannot_setgid_for_user_.22mpd.22:_Operation_not_permitted"></span><span class="mw-headline" id='daemon:_cannot_setgid_for_user_"mpd":_Operation_not_permitted'>daemon: cannot setgid for user "mpd": Operation not permitted</span>
</h3>
<p>The error is stating that the user starting the process does not have permissions to become another user (mpd) which the configuration has told the process to run as.
</p>
<p>To solve the issue, simply start mpd as root.
</p>
<pre># systemctl start mpd</pre>
<h3><span class="mw-headline" id="daemon:_fatal_error:_Failed_to_set_group_NN:_Operation_not_permitted">daemon: fatal_error: Failed to set group NN: Operation not permitted</span></h3>
<p>The error is stating that mpd can't set the group. This is if you have set any other group in <code>/etc/mpd.conf</code> than the default: mpd. This is because of the default <code>mpd.service</code> file. It starts mpd as user mpd (and if no group specified with the default group of this user as stated in your <code>/etc/passwd</code>) and therefore mpd does not have any rights to change his group. 
</p>
<h4><span class="mw-headline" id="First_fix_2">First fix</span></h4>
<p>In <code>/etc/mpd.conf</code> comment out the <code>group=</code> part or change it to <code>group=mpd</code>
</p>
<h4><span class="mw-headline" id="Second_fix_2">Second fix</span></h4>
<p>Create a custom <code>mpd.service</code> file in <code>/etc/systemd/system/</code> and add your desired group. E. g. run mpd with the group "audio":
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/mpd.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.include /usr/lib/systemd/system/mpd.service
    [Service]
    Group=audio</pre>
<h4><span class="mw-headline" id="Third_fix">Third fix</span></h4>
<p>Change the default group of the user mpd in your <code>/etc/passwd</code>. 
</p>
<h3>
<span id="MPD_.26_ALSA"></span><span class="mw-headline" id="MPD_&amp;_ALSA">MPD &amp; ALSA</span>
</h3>
<p>Sometimes, when using other audio outputs, e.g: some web pages containing Flash applets, MPD is rendered unable to play (until it is restarted). The error comes up in mpd's log:
</p>
<pre>Error opening alsa device "hw:0,0": Device or resource busy
</pre>
<p>Reasons for this may be:
</p>
<ul>
<li>The sound card does not support hardware mixing (uses <b>dmix</b> plugin)</li>
<li>An application does not work with ALSA's default settings</li>
</ul>
<p>For a detailed description, it is recommended to take a look at <a rel="nofollow"  href="http://mpd.wikia.com/wiki/Alsa">this</a> link. 
</p>
<p>This problem may be solved by adding the following lines to <code>mpd.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
        type                    "alsa"
        name                    "Sound Card"
        options                 "dev=dmixer"
        device                  "plug:dmix"
}</pre>
<p>To make the changes have effect, restart mpd (e.g. <code>systemctl restart mpd</code>, if it is a global configuration).
</p>
<h4><span class="mw-headline" id="High_CPU_usage_with_ALSA">High CPU usage with ALSA</span></h4>
<p>When using MPD with ALSA, users may experience MPD taking up lots of CPU (around 20-30%). This is caused by most sound cards supporting 48kHz and most music being 44.1kHz, thus forcing MPD to resample it. This operation takes lots of CPU cycles and results into high usage.
</p>
<p>For most users the problem should be solved by telling MPD not to use resampling by adding <code>auto_resample "no"</code> into audio_output-part of <code>/etc/mpd.conf</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
   type			"alsa"
   name			"My ALSA Device"
   auto_resample	"no"
}</pre>
<p>Although it may not give as drastic a speedup, enabling mmap may still speed things up:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
   type			"alsa"
   name			"My ALSA Device"
   use_mmap		"yes"
}</pre>
<p>Some users might also want to tell dmix to use 44kHz as well. More info about tuning performance of your MPD can be found on the <a rel="nofollow"  href="http://mpd.wikia.com/wiki/Tuning">MPD wiki</a>
</p>
<h4>
<span id="Playing_audio_files_with_different_rate_.28works_for_EMU_0202.2F0204.2F0404.29"></span><span class="mw-headline" id="Playing_audio_files_with_different_rate_(works_for_EMU_0202/0204/0404)">Playing audio files with different rate (works for EMU 0202/0204/0404)</span>
</h4>
<p>To play audio files of different rate with automatic card rate change install pulseaudio and pulseaudio-alsa and keep using ALSA as output:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">mpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">audio_output {
    type          "alsa"
    name          "Emu 0202 USB"
    device        "hw:2,0"
}</pre>
<h3><span class="mw-headline" id="Changing_user">Changing user</span></h3>
<p>Changing the group that MPD runs as may result in errors like:
</p>
<pre>output: Failed to open "My ALSA Device"
</pre>
<pre>[alsa]: Failed to open ALSA device "default": No such file or directory
</pre>
<p>or
</p>
<pre>player_thread: problems opening audio device while playing "Song Name.mp3"
</pre>
<p>This is because the MPD users need to be part of the <i>audio</i> group to access sound devices under <code>/dev/snd/</code>. To fix it add user make the MPD user part of the <i>audio</i> group:
</p>
<pre># gpasswd -a 'MPD' audio
</pre>
<h3><span class="mw-headline" id="MPD_includes_music_from_hidden_folders_in_database">MPD includes music from hidden folders in database</span></h3>
<p>MPD includes hidden folders in it's database such as repetitive backups of music made by <a rel="nofollow"  href="https://www.archlinux.org/packages/?name=syncthing">syncthing</a> such as <code>.stfolder</code>. To correct for this, create a <code>.mpdignore</code> file in the same directory with a list of folders or files to ignore on each line as per the <a rel="nofollow"  href="https://www.musicpd.org/doc/html/user.html#the-music-directory-and-the-database">mpd documentation</a>.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Music.html" title="Category:Music">Music</a></li></ul>
</div></div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Music_Player_Daemon/Troubleshooting&amp;oldid=596955">https://wiki.archlinux.org/index.php?title=Music_Player_Daemon/Troubleshooting&amp;oldid=596955</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 7 February 2020, at 23:53.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Advanced Linux Sound TOSitecture/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html" title="Advanced Linux Sound TOSitecture">Advanced Linux Sound TOSitecture</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Volume"><span >1</span> <span >Volume</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#No_output"><span >1.1</span> <span >No output</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Output_is_muted_after_reboot"><span >1.2</span> <span >Output is muted after reboot</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Volume_is_too_low"><span >1.3</span> <span >Volume is too low</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Low_Sound_Volume"><span >1.4</span> <span >Low Sound Volume</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Random_lack_of_sound_on_startup"><span >1.5</span> <span >Random lack of sound on startup</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Microphone"><span >2</span> <span >Microphone</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#No_microphone_input"><span >2.1</span> <span >No microphone input</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Setting_the_default_microphone/capture_device"><span >2.2</span> <span >Setting the default microphone/capture device</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Internal_microphone_not_working"><span >2.3</span> <span >Internal microphone not working</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Crackling_microphone"><span >2.4</span> <span >Crackling microphone</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Audio_Quality"><span >3</span> <span >Audio Quality</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Crackling_sound_through_mini-jack_(headphones_connector)"><span >3.1</span> <span >Crackling sound through mini-jack (headphones connector)</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Popping_sound_after_resuming_from_suspension"><span >3.2</span> <span >Popping sound after resuming from suspension</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Sound_skipping_during_playback"><span >3.3</span> <span >Sound skipping during playback</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Poor_sound_quality_or_clipping"><span >3.4</span> <span >Poor sound quality or clipping</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Pops_when_starting_and_stopping_playback"><span >3.5</span> <span >Pops when starting and stopping playback</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Sound_skipping_while_using_dynamic_CPU_frequency_scaling"><span >3.6</span> <span >Sound skipping while using dynamic CPU frequency scaling</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Hardware_and_Cards"><span >4</span> <span >Hardware and Cards</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Verifying_output_parameters"><span >4.1</span> <span >Verifying output parameters</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Error_'Unknown_hardware'_appears_after_kernel_update"><span >4.2</span> <span >Error 'Unknown hardware' appears after kernel update</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Fix_wrong_audio_pin_mapping"><span >4.3</span> <span >Fix wrong audio pin mapping</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#S/PDIF_output_does_not_work"><span >4.4</span> <span >S/PDIF output does not work</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Conflicting_PC_speaker"><span >4.5</span> <span >Conflicting PC speaker</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#HP_TX2500"><span >4.6</span> <span >HP TX2500</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#No_sound_when_S/PDIF_video_card_is_installed"><span >4.7</span> <span >No sound when S/PDIF video card is installed</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Wrong_sound_card_model_type"><span >4.8</span> <span >Wrong sound card model type</span></a></li>
<li class="toclevel-2 tocsection-28">
<a href="#Intel_onboard_sound"><span >4.9</span> <span >Intel onboard sound</span></a>
<ul>
<li class="toclevel-3 tocsection-29"><a href="#No_sound_with_onboard_Intel_sound_card"><span >4.9.1</span> <span >No sound with onboard Intel sound card</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#No_headphone_sound_with_onboard_intel_sound_card"><span >4.9.2</span> <span >No headphone sound with onboard intel sound card</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31">
<a href="#HDMI"><span >4.10</span> <span >HDMI</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#HDMI_Output_does_not_work"><span >4.10.1</span> <span >HDMI Output does not work</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#PCM_through_HDMI_does_not_work_(Intel_Gfx)"><span >4.10.2</span> <span >PCM through HDMI does not work (Intel Gfx)</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#HDMI_5.1_sound_goes_to_wrong_speakers"><span >4.10.3</span> <span >HDMI 5.1 sound goes to wrong speakers</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-35">
<a href="#Applications"><span >5</span> <span >Applications</span></a>
<ul>
<li class="toclevel-2 tocsection-36"><a href="#SDL:_No_sound_with_SDL_applications"><span >5.1</span> <span >SDL: No sound with SDL applications</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#OpenAL:_No_sound_in_applications_that_use_OpenAL"><span >5.2</span> <span >OpenAL: No sound in applications that use OpenAL</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#VirtualBox:_Virtual_machine_has_no_sound"><span >5.3</span> <span >VirtualBox: Virtual machine has no sound</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Others:_Generic_application_problems"><span >5.4</span> <span >Others: Generic application problems</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-40">
<a href="#Other_Issues"><span >6</span> <span >Other Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-41"><a href="#Simultaneous_playback_problems"><span >6.1</span> <span >Simultaneous playback problems</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Removing_old_ALSA_state_file_(asound.state)"><span >6.2</span> <span >Removing old ALSA state file (asound.state)</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Problems_with_availability_to_only_one_user_at_a_time"><span >6.3</span> <span >Problems with availability to only one user at a time</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Crackling/popping_on_Dell_laptops"><span >6.4</span> <span >Crackling/popping on Dell laptops</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Volume">Volume</span></h2>
<h3><span class="mw-headline" id="No_output">No output</span></h3>
<p>If <code>speaker-test</code> produces sound but some other program does not, determine whether <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> is being used:
</p>
<pre># fuser -v /dev/snd/*
</pre>
<p>If it is, try using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/apulse/">apulse</a></span><sup><small>AUR</small></sup>, as described in <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html#PulseAudio_compatibility" title="Advanced Linux Sound TOSitecture">Advanced Linux Sound TOSitecture#PulseAudio compatibility</a>.  Alternatively, killing the PulseAudio process may cause sound to start working in the desired process.
</p>
<h3><span class="mw-headline" id="Output_is_muted_after_reboot">Output is muted after reboot</span></h3>
<p>Run the following command:
</p>
<pre># alsactl restore
</pre>
<p>If the problem persists, verify that the <code>Auto-Mute</code> option in <i>alsamixer</i> is set to <code>Disabled</code>.
</p>
<h3><span class="mw-headline" id="Volume_is_too_low">Volume is too low</span></h3>
<p>Run <i>alsamixer</i> and try to increase the value of the sliders, unmuting channels if necessary. Note that if you have many sliders, you may have to scroll to the right to see any missing sliders.
</p>
<p>If all the sliders are maxed out, and the volume is still too low, you can try running the following <a rel="nofollow"  href="http://www.alsa-project.org/hda-analyzer.py">script</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot"  title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup> to reset your codec settings:
</p>
<pre>$ wget <a rel="nofollow"  href="http://www.alsa-project.org/hda-analyzer.py">http://www.alsa-project.org/hda-analyzer.py</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot"  title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup>
$ su -c 'python2 hda-analyzer.py'
</pre>
<p>The script assumes that <code>/usr/bin/python</code> refers to Python 2, which is incorrect on TOS by default. To avoid this issue run the following command:
</p>
<pre>$ sed -i 's/python %s/python2 %s/' hda-analyzer.py
</pre>
<p>Close the analyzer, and when prompted as to whether you want to reset the codecs, say "yes".
</p>
<p>If the volume is still too low, run <i>alsamixer</i> again: resetting the codecs may have caused new sliders to become enabled and some of them may be set to a low value.
</p>
<h3><span class="mw-headline" id="Low_Sound_Volume">Low Sound Volume</span></h3>
<p>If you are facing low sound even after maxing out your speakers/headphones, you can give the softvol plugin a try. Add the following to <code>/etc/asound.conf</code>.
</p>
<pre>pcm.!default {
    type plug
    slave.pcm "softvol"
}

pcm.softvol {
    type softvol
    slave {
        pcm "dmix"
    }
    control {
        name "Pre-Amp"
        card 0
    }
    min_dB -5.0
    max_dB 20.0
    resolution 6
}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You will probably have to restart the computer, as restarting the alsa daemon did not load the new configuration for me. Also, if the configuration does not work even after restarting, try changing <code>plug</code> with <code>hw</code> in the above configuration.</div>
<p>After the changes are loaded successfully, you will see a <code>Pre-Amp</code> section in alsamixer. You can adjust the levels there.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Setting a high value for <code>Pre-Amp</code> can cause sound distortion, so adjust it according to the level that suits you.</li>
<li>Some audio codecs may need to have settings adjusted in the HDA Analyzer (see <a href="#Volume_is_too_low">#Volume is too low</a>) in order to achieve proper volume without distortion. Checking the HP option under widget control in the Playback Switch (Node[0x14] PIN in the ALC892 codec, for instance) can sometimes improve audio quality and volume significantly.</li>
</ul>
</div>
<h3><span class="mw-headline" id="Random_lack_of_sound_on_startup">Random lack of sound on startup</span></h3>
<p>You can quickly test sound by running <code>speaker-test</code>. If there is no sound, the error message might look something like
</p>
<pre> ALSA lib pcm_dmix.c:1022:(snd_pcm_dmix_open) unable to open slave
 Playback open error: -16
 Device or resource busy
</pre>
<p>If you have no sound on startup, this may be because your system has multiple sound cards, and their order may sometimes change on startup.  If this is the case, try <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html#Set_the_default_sound_card" class="mw-redirect" title="ALSA">setting the default sound card</a>.
</p>
<p>If you use mpd and the configuration tips above do not work for you, try <a rel="nofollow"  href="http://mpd.wikia.com/wiki/Configuration#ALSA_MPD_software_volume_control">reading this</a> instead.
</p>
<h2><span class="mw-headline" id="Microphone">Microphone</span></h2>
<h3><span class="mw-headline" id="No_microphone_input">No microphone input</span></h3>
<p>In alsamixer, make sure that all the volume levels are up under recording, and that CAPTURE is toggled active on the microphone (e.g. Mic, Internal Mic) and/or on Capture (in alsamixer, select these items and press space). Try making positive Mic Boost and raising Capture and Digital levels higher; this make make static or distortion, but then you can adjust them back down once you are hearing <i>something</i> when you record
</p>
<p>As the pulseaudio wrapper is shown as "default" in alsamixer, you may have to press F6 to select your actual soundcard first. You may also need to enable and increase the volume of Line-in in the Playback section.
</p>
<p>To test the microphone, run these commands (see arecord's man page for further information):
</p>
<pre>$ arecord --duration=5 --format=dat test-mic.wav
$ aplay test-mic.wav
</pre>
<p>Alternatively, you can run this command:
</p>
<pre>$ arecord -vv --format=dat /dev/null
</pre>
<p>alongside alsamixer to easily identify channel which you should select and unmute.
</p>
<p>To test a particular device, use the <code>--device</code> parameter followed by the hardware PCM name in the form <code>hw:<i>C</i>,<i>D</i></code> for card <i>C</i> device <i>D</i>, or <code>plughw:<i>C</i>,<i>D</i></code> for plugged hardware. For instance:
</p>
<pre>$ arecord -vvv --format=dat --device=plughw:0,0 /dev/null
</pre>
<p>If all fails, you may want to eliminate hardware failure by testing the microphone with a different device.
</p>
<p>For at least some computers, muting a microphone (MM) simply means its input does not go immediately to the speakers. It still receives input.
</p>
<p>Many Dell laptops need "-dmic" to be appended to the model name in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-hda-intel model=dell-m6-dmic
</pre>
<p>Some programs use try to use OSS as the main input software. If you have enabled the <code>snd_pcm_oss</code>, <code>snd_mixer_oss</code> or <code>snd_seq_oss</code> <a href="..//Usage/Configuration/K/Kernel_module.html" class="mw-redirect" title="Kernel modules">kernel modules</a> previously (they are not loaded by default), try unloading them.
</p>
<p>See also:
</p>
<ul>
<li><a rel="nofollow"  href="http://www.alsa-project.org/main/index.php/SoundcardTesting">http://www.alsa-project.org/main/index.php/SoundcardTesting</a></li>
<li><a rel="nofollow"  href="http://alsa.opensrc.org/Record_from_mic">http://alsa.opensrc.org/Record_from_mic</a></li>
</ul>
<h3>
<span id="Setting_the_default_microphone.2Fcapture_device"></span><span class="mw-headline" id="Setting_the_default_microphone/capture_device">Setting the default microphone/capture device</span>
</h3>
<p>Some applications (Pidgin, Adobe Flash) do not provide an option to change the capture device. It becomes a problem if your microphone is on a separate device (e.g. USB webcam or microphone) than your internal sound card. To change only the default capture device, leaving the default playback device as is, you can modify your <code>~/.asoundrc</code> file to include the following:
</p>
<pre>pcm.usb
{
    type hw
    card U0x46d0x81d
}

pcm.!default
{
    type asym
    playback.pcm
    {
        type plug
        slave.pcm "dmix"
    }
    capture.pcm
    {
        type plug
        slave.pcm "usb"
    }
}
</pre>
<p>Replace "U0x46d0x81d" with your capture device's card name in ALSA. You can use <code>arecord -L</code> to list all the capture devices detected by ALSA.
</p>
<h3><span class="mw-headline" id="Internal_microphone_not_working">Internal microphone not working</span></h3>
<p>First make sure the volume is enabled under the <code>Capture</code> view in <i>alsamixer</i>. In some case, the "Internal Microphone" is not displayed in the capture list available when pressing F4. If so, specifying the card number given by <code>aplay -l</code> to start <i>alsamixer</i> (for example <code>alsamixer -c 0</code> ) can make it appear. 
</p>
<p><br>
Then add the following to <code>/etc/modprobe.d/snd-hda-intel.conf</code>:
</p>
<pre>options snd-hda-intel enable_msi=1
</pre>
<p>Then reload the module:
</p>
<pre># rmmod snd-hda-intel &amp;&amp; modprobe snd-hda-intel
</pre>
<p>Now there should be an additional input under the previously mentioned <code>Capture</code> view.
</p>
<h3><span class="mw-headline" id="Crackling_microphone">Crackling microphone</span></h3>
<p>If you are getting a crackling or popping from your microphone that cannot be resolved with ALSA settings or cleaning your microphone jack, try adding the following line to <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-hda-intel model=MODEL position_fix=3
</pre>
<p>This option will fix crackling on pure ALSA, but will cause issues to pulseaudio. To let Pulse use these settings effectively, edit <code>/etc/pulse/default.pa</code> and find this line:
</p>
<pre>load-module module-udev-detect
</pre>
<p>And change it to this:
</p>
<pre>load-module module-udev-detect tsched=0
</pre>
<p>See the <a rel="nofollow"  href="https://www.kernel.org/doc/html/latest/sound/hd-audio/notes.html#dma-position-problem">DMA-Position Problem in the kernel docs</a>.
</p>
<h2><span class="mw-headline" id="Audio_Quality">Audio Quality</span></h2>
<h3>
<span id="Crackling_sound_through_mini-jack_.28headphones_connector.29"></span><span class="mw-headline" id="Crackling_sound_through_mini-jack_(headphones_connector)">Crackling sound through mini-jack (headphones connector)</span>
</h3>
<p>Whether you followed <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html#Simultaneous_output" title="Advanced Linux Sound TOSitecture">simultaneous output tip</a> or managed to get it done on your own, you might get crackling sound through headphones or external speakers. This can be fixed by muting <b>or</b> setting volume to 0% on item <b>Mic</b>. Use <code>alsamixer</code> or <code>amixer</code>:
</p>
<pre>$ amixer sset "Mic" 0%
$ amixer sset "Mic" mute
</pre>
<h3><span class="mw-headline" id="Popping_sound_after_resuming_from_suspension">Popping sound after resuming from suspension</span></h3>
<p>You might hear a popping sound after resuming the computer from suspension. This can be fixed by editing <code>/etc/pm/sleep.d/90alsa</code> and removing the line that says <code>aplay -d 1 /dev/zero</code>
</p>
<h3><span class="mw-headline" id="Sound_skipping_during_playback">Sound skipping during playback</span></h3>
<p>Run <i>alsamixer</i>, and if channels exist for nonexistent output devices then disable them (e.g. <i>alsamixer</i> showing a center speaker but you not having one).
</p>
<h3><span class="mw-headline" id="Poor_sound_quality_or_clipping">Poor sound quality or clipping</span></h3>
<p>If you experience poor sound quality, try setting the PCM volume (in alsamixer) to a level such that gain is 0.
</p>
<p>If snd-usb-audio driver has been loaded, you could try to enable <code>softvol</code> in <code>/etc/asound.conf</code> file. Example configuration for the first audio device:
</p>
<pre>pcm.!default {
    type plug
    slave.pcm "softvol"
}
pcm.dmixer {
    type dmix
    ipc_key 1024
    slave {
        pcm "hw:0"
        period_size 4096
        buffer_size 131072
        rate 50000
    }
    bindings {
        0 0
        1 1
    }
}
pcm.dsnooper {
    type dsnoop
    ipc_key 1024
    slave {
        pcm "hw:0"
        channels 2
        period_size 4096
        buffer_size 131072
        rate 50000
    }
    bindings {
        0 0
        1 1
        }
}
pcm.softvol {
  type softvol
  slave { pcm "dmixer" }
  control {
    name "Master"
    card 0
  }
}
ctl.!default {
  type hw
  card 0
}
ctl.softvol {
  type hw
  card 0
}
ctl.dmixer {
  type hw
  card 0
}</pre>
<h3><span class="mw-headline" id="Pops_when_starting_and_stopping_playback">Pops when starting and stopping playback</span></h3>
<p>Some modules (e.g. snd_ac97_codec and snd_hda_intel) can power off your sound card when not in use. This can make an audible noise (like a crack/pop/scratch) when turning on/off your sound card. Sometimes even when move the slider volume, or open and close windows (KDE4). If you find this annoying try <code>modinfo snd_MY_MODULE</code>, and look for a module option that adjusts or disables this feature.
</p>
<p><i>Example</i>: disable the power saving mode and solve cracking sound trough speakers problem, using snd_hda_intel add in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd_hda_intel power_save=0
</pre>
<p>The power_save_controller option if set to 'Y' will switch the audio card controller off to conserve power, but it can cause issues when the controller resumes. Setting it to N may reduce the severity of other issues as well.
</p>
<pre>options snd_hda_intel power_save=0 power_save_controller=N
</pre>
<p>You can also try it with <code>modprobe snd_hda_intel power_save=0</code> before.
</p>
<p>You may also have to unmute the 'Line' ALSA channel for this to work. Any value will do (other than '0' or something too high).
</p>
<p><i>Example:</i> on an onboard VIA VT1708S (using the snd_hda_intel module) these cracks occured even though 'power_save' was set to 0. Unmuting the 'Line' channel and setting a value of '1' solved the problem.
</p>
<p>Source: <a rel="nofollow"  href="https://www.kernel.org/doc/Documentation/sound/alsa/powersave.txt">https://www.kernel.org/doc/Documentation/sound/alsa/powersave.txt</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot"  title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-28 ⓘ]</sup>
</p>
<h3><span class="mw-headline" id="Sound_skipping_while_using_dynamic_CPU_frequency_scaling">Sound skipping while using dynamic CPU frequency scaling</span></h3>
<p>Some combinations of ALSA drivers and chipsets may cause audio from all sources to skip when used in combination with a dynamic frequency scaling governor such as <code>ondemand</code> or <code>conservative</code>. Currently, the solution is to switch back to the <code>performance</code> governor.
</p>
<p>Refer to the <a href="..//Usage/Configuration/C/CPU_frequency_scaling.html" title="CPU frequency scaling">CPU frequency scaling</a> for more information.
</p>
<h2><span class="mw-headline" id="Hardware_and_Cards">Hardware and Cards</span></h2>
<h3><span class="mw-headline" id="Verifying_output_parameters">Verifying output parameters</span></h3>
<p>Check the contents of <code>/proc/asound/cardX/pcmYp/subZ/hw_params</code>, where <code>X</code>, <code>Y</code>, and <code>Z</code> are system dependent.
In order to find this file, execute the following command while outputting anything via ALSA:
</p>
<pre>$ find /proc/asound/ -name hw_params | xargs -I FILE grep -v -l "closed" FILE | grep '/proc/asound/card./pcm.p/sub./hw_params'
</pre>
<p>If nothing is playing there should be no results.
</p>
<p>Here is an example output for audio with a <a href="https://en.wikipedia.org/wiki/Audio_bit_depth"  title="wikipedia:Audio bit depth">bit depth</a> of 24 bits and a <a href="https://en.wikipedia.org/wiki/Sampling_frequency"  title="wikipedia:Sampling frequency">sampling frequency</a> of 44.1 kilohertz:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">cat /proc/asound/card1/pcm0p/sub0/hw_params</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">access: RW_INTERLEAVED
format: S24_3LE
subformat: STD
channels: 2
rate: 44100 (44100/1)
period_size: 5513
buffer_size: 22050
</pre>
<p>More info is available in the <a rel="nofollow"  href="http://alsa.opensrc.org/Proc_asound_documentation">ALSA documentation</a>.
</p>
<h3>
<span id="Error_.27Unknown_hardware.27_appears_after_kernel_update"></span><span class="mw-headline" id="Error_'Unknown_hardware'_appears_after_kernel_update">Error 'Unknown hardware' appears after kernel update</span>
</h3>
<p>The following messages may be displayed during ALSA's initialization:
</p>
<pre>Unknown hardware "foo" "bar" ...
Hardware is initialized using a guess method
/usr/bin/alsactl: set_control:nnnn:failed to obtain info for control #mm (No such file or directory)
</pre>
<p>or:
</p>
<pre>Found hardware: "HDA-Intel" "VIA VT1705" "HDA:11064397,18490397,00100000" "0x1849" "0x0397"
Hardware is initialized using a generic method
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #1 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #2 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #25 (No such file or directory)
/usr/bin/alsactl: set_control:1328: failed to obtain info for control #26 (No such file or directory)
</pre>
<p>Simply store ALSA mixer settings again:
</p>
<pre># alsactl -f /var/lib/alsa/asound.state store
</pre>
<p>It may be necessary configure ALSA again with alsamixer
</p>
<h3><span class="mw-headline" id="Fix_wrong_audio_pin_mapping">Fix wrong audio pin mapping</span></h3>
<p>If the mappings to your audio pins(plugs) do not correspond but ALSA works fine, you could try HDA Analyzer -- a pyGTK2 GUI for HD-audio control can be found <a rel="nofollow"  href="http://www.alsa-project.org/main/index.php/HDA_Analyzer">at the ALSA wiki</a>.
Try tweaking the Widget Control section of the PIN nodes, to make microphones IN and headphone jacks OUT. Referring to the Config Defaults heading is a good idea.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The script is incompatible with Python 3, which is the default Python implementation on TOS Linux. In order to use the script, replace all occurrences of <code>python</code> in the <code>run.py</code> file with <code>python2</code> to point the script to the Python 2 version. Then make the script <a href="..//Usage/Configuration/F/File_permissions_and_attributes.html#Changing_permissions" class="mw-redirect" title="Chmod">executable</a> and run it.</div>
<h3>
<span id="S.2FPDIF_output_does_not_work"></span><span class="mw-headline" id="S/PDIF_output_does_not_work">S/PDIF output does not work</span>
</h3>
<p>If the optical/coaxial digital output of your motherboard/sound card is not working or stopped working, and have already enabled and unmuted it in alsamixer, try running the following:
</p>
<pre>$ iecset audio on
</pre>
<p>You can also put this command in an enabled <a href="..//Usage/Configuration/S/Systemd.html" title="Systemd">systemd</a> service as it sometimes it may stop working after a reboot.
</p>
<h3><span class="mw-headline" id="Conflicting_PC_speaker">Conflicting PC speaker</span></h3>
<p>If you are sure nothing is muted, that your drivers are installed correctly, and that your volume is right, but you still do not hear anything, then try adding the following line to <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-NAME-OF-MODULE ac97_quirk=0
</pre>
<p>The above fix has been observed to work with <code>via82xx</code>
</p>
<pre>options snd-NAME-OF-MODULE ac97_quirk=1
</pre>
<p>The above fix has been reported to work with <code>snd-intel8x0</code>
</p>
<h3><span class="mw-headline" id="HP_TX2500">HP TX2500</span></h3>
<p>Add these 2 lines into <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options snd-cmipci mpu_port=0x330 fm_port=0x388
options snd-hda-intel index=0 model=toshiba position_fix=1
options snd-hda-intel model=hp (works for tx2000cto)
</pre>
<h3>
<span id="No_sound_when_S.2FPDIF_video_card_is_installed"></span><span class="mw-headline" id="No_sound_when_S/PDIF_video_card_is_installed">No sound when S/PDIF video card is installed</span>
</h3>
<p>Discover available modules and their order:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cat /proc/asound/modules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> 0 snd_hda_intel
 1 snd_ca0106
</pre>
<p>Disable the undesired video card audio codec in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/modprobe.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">install snd_hda_intel /bin/false
</pre>
<p>If both devices use the same module then we can use the <code>enable</code> parameter from snd_hda_intel module; it is an array of booleans that can enable/disable the desired sound card.
</p>
<pre>options snd_hda_intel enable=1,0
</pre>
<h3><span class="mw-headline" id="Wrong_sound_card_model_type">Wrong sound card model type</span></h3>
<p>Although ALSA detects your soundcard through the BIOS, at times ALSA may not be able to recognize your <a rel="nofollow"  href="https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html">model type</a>.  The soundcard chip can be found in <code>alsamixer</code> (e.g. ALC662) and the model can be set in <code>/etc/modprobe.d/modprobe.conf</code> or <code>/etc/modprobe.d/sound.conf</code>.  For example:
</p>
<pre>options snd-hda-intel model=MODEL
</pre>
<p>There are other model settings too.  For most cases ALSA defaults will do.  If you want to look at more specific settings for your soundcard take a look at the <a rel="nofollow"  href="http://bugtrack.alsa-project.org/main/index.php/Matrix:Main">ALSA Soundcard List</a> find your model, then Details, then look at the "Setting up modprobe..." section.  Enter these values in <code>/etc/modprobe.d/modprobe.conf</code>.  For example, for an Intel AC97 audio:
</p>
<pre># ALSA portion
alias char-major-116 snd
alias snd-card-0 snd-intel8x0
# module options should go here

# OSS/Free portion
alias char-major-14 soundcore
alias sound-slot-0 snd-card-0

# card #1
alias sound-service-0-0 snd-mixer-oss
alias sound-service-0-1 snd-seq-oss
alias sound-service-0-3 snd-pcm-oss
alias sound-service-0-8 snd-seq-oss
alias sound-service-0-12 snd-pcm-oss
</pre>
<h3><span class="mw-headline" id="Intel_onboard_sound">Intel onboard sound</span></h3>
<h4><span class="mw-headline" id="No_sound_with_onboard_Intel_sound_card">No sound with onboard Intel sound card</span></h4>
<p>There may be a problem with two conflicting modules loaded, namely <code>snd-intel8x0</code> and <code>snd-intel8x0m</code>. In this case, blacklist <code>snd-intel8x0m</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/modprobe.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">blacklist snd-intel8x0m</pre>
<p><i>Muting</i> the "External Amplifier" in <code>alsamixer</code> or <code>amixer</code> may also help. See <a rel="nofollow"  href="http://alsa.opensrc.org/Intel8x0#Dell_Inspiron_8600_.28and_probably_others.29">the ALSA wiki</a>.
</p>
<p>Unmuting the "Mix" setting in the mixer might help, also.
</p>
<h4><span class="mw-headline" id="No_headphone_sound_with_onboard_intel_sound_card">No headphone sound with onboard intel sound card</span></h4>
<p>With <b>Intel Corporation 82801 I (ICH9 Family) HD Audio Controller</b> on laptop, you may need to add this line to modprobe or sound.conf:
</p>
<pre>options snd-hda-intel model=<i>model</i>
</pre>
<p>Where <i>model</i> is any one of the following:
</p>
<ul>
<li>dell-m6</li>
<li>dell-vostro</li>
<li>generic</li>
<li>laptop</li>
<li>laptop-hpsense</li>
<li>olpc-xo-1_5</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It may be necessary to put this "options" line below (after) any "alias" lines about your card.</div>
<p>You can see all the available models in the kernel documentation. For example <a rel="nofollow"  href="https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html">https://www.kernel.org/doc/html/latest/sound/hd-audio/models.html</a>, but check that it is the correct version of that document for your kernel version.
</p>
<p>A list of available models is also available <a rel="nofollow"  href="http://www.mjmwired.net/kernel/Documentation/sound/alsa/HD-Audio-Models.txt">here</a>. To know your chip name type the following command (with * being corrected to match your files). Note that some chips could have been renamed and do not directly match the available ones in the file.
</p>
<pre>$ grep Codec /proc/asound/card*/codec*
</pre>
<p>Note that there is a high chance none of the input devices (all internal and external mics) will work if you choose to do this, so it is either your headphones or your mic. Please report to ALSA if you are affected by this bug.
</p>
<p>And also, if you have problems getting beeps to work (pcspkr):
</p>
<pre>options snd-hda-intel model=$model enable=1 index=0
</pre>
<h3><span class="mw-headline" id="HDMI">HDMI</span></h3>
<h4><span class="mw-headline" id="HDMI_Output_does_not_work">HDMI Output does not work</span></h4>
<p>The procedure described below can be used to test HDMI audio. Before proceeding, make sure you have enabled and unmuted the output with <code>alsamixer</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are using an AMD card a necessary kernel module is disabled by default. See <a href="..//Usage/Configuration/A/ATI.html#HDMI_audio" title="ATI">ATI#HDMI audio</a>.</div>
<p>Connect your PC to the Display via HDMI cable and enable the display with <a href="..//Usage/Configuration/X/Xrandr.html" title="Xrandr">xrandr</a>.
</p>
<p>Use <code>aplay -l</code> to discover the card and device number. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ aplay -l</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">**** List of PLAYBACK Hardware Devices ****
card 0: SB [HDA ATI SB], device 0: ALC892 Analog [ALC892 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: SB [HDA ATI SB], device 1: ALC892 Digital [ALC892 Digital]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
<b>card 1</b>: Generic [HD-Audio Generic], <b>device 3</b>: HDMI 0 [HDMI 0]
  Subdevices: 1/1
  Subdevice #0: subdevice #0</pre>
<p>Send sound to the device. Following the example in the previous step, you would send sound to <code><b>card 1</b></code>, <code><b>device 3</b></code>:
</p>
<pre>$ aplay -D plughw:1,3 /usr/share/sounds/alsa/Front_Center.wav
</pre>
<p>If aplay does not output any errors, but still no sound is heard, "reboot" the receiver, monitor or tv set. Since the HDMI interface executes a handshake on connection, it might have noticed before that there was no audio stream embedded, and disabled audio decoding. If you are using a standalone window manager, you may need to have sound playing while plugging in the HDMI cable.
</p>
<p>mplay and other application could be configured to use special HDMI device as audio output. But flashplugin could only use default device. The following method is used to override default device. But you need to change it back when your TV is disconnected from HDMI port.
</p>
<p>If the test is successful, create or edit your <code>~/.asoundrc</code> file to set HDMI as the default audio device.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pcm.!default {
    type hw
    card 1
    device 3
}
</pre>
<p>Or if the above configuration does not work try:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">defaults.pcm.card 1
defaults.pcm.device 3
defaults.ctl.card 1
</pre>
<p>Or if you alternatively succeed with
</p>
<pre>$ speaker-test -Dplug:hdmi
</pre>
<p>for your HDMI or DisplayPort port the following configuration will work (successfully tested on Lenovo ThinkPad T430s):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">pcm.!default {
    type plug
    slave.pcm "hdmi"
}
</pre>
<h4>
<span id="PCM_through_HDMI_does_not_work_.28Intel_Gfx.29"></span><span class="mw-headline" id="PCM_through_HDMI_does_not_work_(Intel_Gfx)">PCM through HDMI does not work (Intel Gfx)</span>
</h4>
<p>As of Linux 3.1 multi-channel PCM output through HDMI with a Intel card (Intel Eaglelake, IbexPeak/Ironlake,SandyBridge/CougarPoint and IvyBridge/PantherPoint) is not yet supported. Support for it has been recently added and expected to be available in Linux 3.2. To make it work in Linux 3.1 you need to apply the following patches:
</p>
<ul>
<li><a rel="nofollow"  href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=patch;h=76adaa34db407f174dd06370cb60f6029c33b465">drm: support routines for HDMI/DP ELD</a></li>
<li><a rel="nofollow"  href="http://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=patch;h=e0dac65ed45e72fe34cc7ccc76de0ba220bd38bb">drm/i915: pass ELD to HDMI/DP audio driver</a></li>
</ul>
<h4><span class="mw-headline" id="HDMI_5.1_sound_goes_to_wrong_speakers">HDMI 5.1 sound goes to wrong speakers</span></h4>
<p>Sound can be redirected to the intended speakers using ALSA's <code>remap</code> function. To do so, add the following to <code>/etc/asound.conf</code>:
</p>
<pre>pcm.!hdmi-remap {
    type asym
    playback.pcm {
        type plug
        slave.pcm "remap-surround51"
    }
}

pcm.!remap-surround51 {
    type route
    slave.pcm "hw:0,3"
    ttable {
        0.0= 1
        1.1= 1
        2.4= 1
        3.5= 1
        4.2= 1
        5.3= 1
    }
}</pre>
<h2><span class="mw-headline" id="Applications">Applications</span></h2>
<h3><span class="mw-headline" id="SDL:_No_sound_with_SDL_applications">SDL: No sound with SDL applications</span></h3>
<p>If you get no sound using SDL based applications, try setting the <a href="..//Usage/Configuration/E/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> <code>SDL_AUDIODRIVER</code> to <code>alsa</code>.
</p>
<h3><span class="mw-headline" id="OpenAL:_No_sound_in_applications_that_use_OpenAL">OpenAL: No sound in applications that use OpenAL</span></h3>
<p>Openal defaults to pulseaudio, to change the order, add the following configuration to <code>/etc/openal/alsoft.conf</code>:
</p>
<pre>drivers=alsa,pulse</pre>
<h3><span class="mw-headline" id="VirtualBox:_Virtual_machine_has_no_sound">VirtualBox: Virtual machine has no sound</span></h3>
<p>If you experience problems with VirtualBox, the following command might be helpful:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ alsactl init</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Found hardware: "ICH" "SigmaTel STAC9700,83,84" "AC97a:83847600" "0x8086" "0x0000"
Hardware is initialized using a generic method</pre>
<p>You might need to activate the ALSA output in your audio software as well. You might also try selecting different sound devices in your virtual machine settings to find one that works.
</p>
<h3><span class="mw-headline" id="Others:_Generic_application_problems">Others: Generic application problems</span></h3>
<p>For other applications who insist on their own audio setup, e.g., XMMS or MPlayer, you would need to set their specific options.
</p>
<p>For <a href="..//Usage/Configuration/M/MPlayer.html" title="MPlayer">MPlayer</a> or <a href="..//Usage/Configuration/M/Mpv.html" title="Mpv">mpv</a>, add the following line to the respective configuration file:
</p>
<pre>ao=alsa
</pre>
<p>Eg. for XMMS2, go into their options and make sure the sound driver is set to ALSA, not oss.
</p>
<p>To do this in XMMS:
</p>
<ul><li>Open XMMS
<ul>
<li>Options &gt; Preferences.</li>
<li>Choose the ALSA output plugin.</li>
</ul>
</li></ul>
<p>For applications which do not provide a ALSA output, you can use aoss from the alsa-oss package. To use aoss, when you run the program, prefix it with <code>aoss</code>, e.g.:
</p>
<pre>aoss realplay
</pre>
<p>pcm.!default{ ... }  doesnt work for me anymore. but this does:
</p>
<pre>pcm.default pcm.dmixer
</pre>
<h2><span class="mw-headline" id="Other_Issues">Other Issues</span></h2>
<h3><span class="mw-headline" id="Simultaneous_playback_problems">Simultaneous playback problems</span></h3>
<p>If you are having problems with simultaneous playback, and if <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> is installed, its default configuration is set to "hijack" the soundcard. Some users of ALSA may not want to use <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> and are quite content with their current ALSA settings. One fix is to edit <code>/etc/asound.conf</code> and comment out the following lines:
</p>
<pre># Use PulseAudio by default
pcm.!default {
    type pulse
    fallback "sysdefault"
    hint {
        show on
        description "Default ALSA Output (currently PulseAudio Sound Server)"
    }
}</pre>
<p>Commenting the following out also may help:
</p>
<pre>ctl.!default {
    type pulse
    fallback "sysdefault"
}</pre>
<p>This may be a much simpler solution than completely uninstalling <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a>.
</p>
<p>Effectively, here is an example of a working <code>/etc/asound.conf</code>:
</p>
<pre>pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_key_add_uid 0
    ipc_perm 0660
}
pcm.dsp {
    type plug
    slave.pcm "dmix"
}</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This <code>/etc/asound.conf</code> file was intended for and used successfully with a global <a href="..//Usage/Configuration/M/Music_Player_Daemon.html" class="mw-redirect" title="MPD">MPD</a> configuration. See <a href="#Problems_with_availability_to_only_one_user_at_a_time">#Problems with availability to only one user at a time</a>.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Alternatively, if you do <b>not</b> have PulseAudio installed, and just want to get <code>dmix</code> to work with vanilla ALSA, see the <a rel="nofollow"  href="http://www.alsa-project.org/main/index.php/Asoundrc#dmix">upstream documentation</a>. In particular, you probably want to replace <code>dsp</code> in the above config with <code>!default</code>. Also, if you notice this causes certain applications to skip while playing (i.e. sound "glitchy"), and complain about underrun occurring, you may want to tweak the <code>slave.buffer_size</code> inside <code>pcm.dmixer</code>.</div>
<h3>
<span id="Removing_old_ALSA_state_file_.28asound.state.29"></span><span class="mw-headline" id="Removing_old_ALSA_state_file_(asound.state)">Removing old ALSA state file (asound.state)</span>
</h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=alsa-utils">alsa-utils</a></span> package provides <code>alsa-store.service</code> which automatically stores the current ALSA state to <code>/var/lib/alsa/asound.state</code> upon system shutdown.  This can be problematic for users who are trying to reset their current ALSA state as the <code>asound.state</code> file will be recreated with the current state upon every shutdown (e.g., attempting to remove user-defined channels from the mixer).  The <code>alsa-store.service</code> service may be temporarily disabled by creating the following empty file:
</p>
<pre># mkdir -p /etc/alsa
# touch /etc/alsa/state-daemon.conf
</pre>
<p>The presence of <code>state-daemon.conf</code> prevents <code>alsa-store.service</code> from saving <code>asound.state</code> during shutdown. After disabling this service, the <code>asound.state</code> file may be removed as such:
</p>
<pre># rm /var/lib/alsa/asound.state
</pre>
<p>After rebooting, the previous ALSA state should be lost and the current state should be reset to defaults.  Re-enable <code>alsa-store.service</code> by deleting the condition file we created:
</p>
<pre># rm /etc/alsa/state-daemon.conf
</pre>
<p>On the next shutdown, the <code>asound.state</code> file should be recreated with ALSA defaults.  The file may also be generated immediately using:
</p>
<pre># alsactl store
</pre>
<p>If you want to clean ALSA state without rebooting, you can use <code>rmmod</code> to remove the sound driver module, then manually delete the unwanted entries in <code>asound.state</code>, and then use <code>modprobe</code> to reinstall the sound driver module.
</p>
<h3><span class="mw-headline" id="Problems_with_availability_to_only_one_user_at_a_time">Problems with availability to only one user at a time</span></h3>
<p>You might find that only one user can use the dmixer at a time.  This is probably ok for most, but for those who run <a href="..//Usage/Configuration/M/Music_Player_Daemon.html" class="mw-redirect" title="Mpd">mpd</a> as a separate user this poses a problem.  When mpd is playing a normal user cannot play sounds though the dmixer.  While it is quite possible to just run mpd under a user's login account, another solution has been found.  Adding the line <code>ipc_key_add_uid 0</code> to the <code>pcm.dmixer</code> block disables this locking.  The following is a snippet from <code>asound.conf</code>, the rest is the same as above.
</p>
<pre>...
pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_key_add_uid 0
    ipc_perm 0660
slave {
 ...</pre>
<h3>
<span id="Crackling.2Fpopping_on_Dell_laptops"></span><span class="mw-headline" id="Crackling/popping_on_Dell_laptops">Crackling/popping on Dell laptops</span>
</h3>
<p>Check if you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/i8kutils/">i8kutils</a></span><sup><small>AUR</small></sup> installed and if anything (e.g. <code>i8kmon.service</code>) is reading or writing to the interface exposed by the module, as i8kutils BIOS system calls block the kernel for a moment on some systems. See warning in <a href="..//Usage/Configuration/F/Fan_speed_control.html#Dell_laptops" title="Fan speed control">Fan speed control#Dell laptops</a> for more details.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Sound.html" title="Category:Sound">Sound</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="..//Usage/Configuration/C/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Advanced_Linux_Sound_TOSitecture/Troubleshooting&amp;oldid=607567">https://wiki.archlinux.org/index.php?title=Advanced_Linux_Sound_TOSitecture/Troubleshooting&amp;oldid=607567</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 24 April 2020, at 10:50.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">CUPS/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a></li>
<li><a href="..//Usage/Configuration/C/CUPS/Printer-specific_problems.html" title="CUPS/Printer-specific problems">CUPS/Printer-specific problems</a></li>
</ul>
</div>
<p>This article covers all non-specific (ie, not related to any one printer) troubleshooting of CUPS and printing drivers (but not problems related to printer sharing), including methods of determining the exact nature of the problem, and of solving the identified problem. 
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Introduction"><span >1</span> <span >Introduction</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Problems_resulting_from_upgrades"><span >2</span> <span >Problems resulting from upgrades</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#CUPS_stops_working"><span >2.1</span> <span >CUPS stops working</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#All_jobs_are_%22stopped%22"><span >2.2</span> <span >All jobs are "stopped"</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#All_jobs_are_%22The_printer_is_not_responding%22"><span >2.3</span> <span >All jobs are "The printer is not responding"</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#The_PPD_version_is_not_compatible_with_gutenprint"><span >2.4</span> <span >The PPD version is not compatible with gutenprint</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Networking_issues"><span >3</span> <span >Networking issues</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Unable_to_locate_printer"><span >3.1</span> <span >Unable to locate printer</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Old_CUPS_server"><span >3.2</span> <span >Old CUPS server</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Shared_printer_works_locally_but_remote_machine_fails_to_print"><span >3.3</span> <span >Shared printer works locally but remote machine fails to print</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Unable_to_locate_PPD_file"><span >3.4</span> <span >Unable to locate PPD file</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Finding_URIs_for_Windows_print_servers"><span >3.5</span> <span >Finding URIs for Windows print servers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#USB_printers"><span >4</span> <span >USB printers</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Conflict_with_SANE"><span >4.1</span> <span >Conflict with SANE</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Conflict_with_usblp"><span >4.2</span> <span >Conflict with usblp</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#USB_autosuspend"><span >4.3</span> <span >USB autosuspend</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Bad_permissions"><span >4.4</span> <span >Bad permissions</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18">
<a href="#HP_issues"><span >5</span> <span >HP issues</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#CUPS:_%22/usr/lib/cups/backend/hp_failed%22"><span >5.1</span> <span >CUPS: "/usr/lib/cups/backend/hp failed"</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#CUPS:_Job_is_shown_as_complete_but_the_printer_does_nothing"><span >5.2</span> <span >CUPS: Job is shown as complete but the printer does nothing</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#CUPS:_'%22foomatic-rip%22_not_available/stopped_with_status_3'"><span >5.3</span> <span >CUPS: '"foomatic-rip" not available/stopped with status 3'</span></a></li>
<li class="toclevel-2 tocsection-22">
<a href="#CUPS:_%22Filter_failed%22"><span >5.4</span> <span >CUPS: "Filter failed"</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#Missing_ghostscript"><span >5.4.1</span> <span >Missing ghostscript</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Missing_foomatic-db"><span >5.4.2</span> <span >Missing foomatic-db</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Avahi_not_enabled"><span >5.4.3</span> <span >Avahi not enabled</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#Out-of-date_plugin"><span >5.4.4</span> <span >Out-of-date plugin</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Outdated_printer_configuration"><span >5.4.5</span> <span >Outdated printer configuration</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-28"><a href="#CUPS:_prints_only_an_empty_and_an_error-message_page_on_HP_LaserJet"><span >5.5</span> <span >CUPS: prints only an empty and an error-message page on HP LaserJet</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#CUPS:_%22File_%22/usr/lib/cups/filter/rastertospl%22_not_available"><span >5.6</span> <span >CUPS:  "File "/usr/lib/cups/filter/rastertospl" not available</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#HPLIP_3.13:_Plugin_is_installed,_but_HP_Device_Manager_complains_it_is_not"><span >5.7</span> <span >HPLIP 3.13: Plugin is installed, but HP Device Manager complains it is not</span></a></li>
<li class="toclevel-2 tocsection-31">
<a href="#hp-toolbox:_%22Unable_to_communicate_with_device%22"><span >5.8</span> <span >hp-toolbox: "Unable to communicate with device"</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Permission_problem"><span >5.8.1</span> <span >Permission problem</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#Virtual_CDROM_printers"><span >5.8.2</span> <span >Virtual CDROM printers</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#Networked_printers"><span >5.8.3</span> <span >Networked printers</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-35"><a href="#hp-setup_asks_to_specify_the_PPD_file_for_the_discovered_printer"><span >5.9</span> <span >hp-setup asks to specify the PPD file for the discovered printer</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#hp-setup:_%22Qt/PyQt_4_initialization_failed%22"><span >5.10</span> <span >hp-setup: "Qt/PyQt 4 initialization failed"</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#hp-setup:_finds_the_printer_automatically_but_reports_%22Unable_to_communicate_with_device%22_when_printing_test_page_immediately_afterwards"><span >5.11</span> <span >hp-setup: finds the printer automatically but reports "Unable to communicate with device" when printing test page immediately afterwards</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#hp-setup:_%22KeyError:_'family-class'%22"><span >5.12</span> <span >hp-setup: "KeyError: 'family-class'"</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39">
<a href="#Other"><span >6</span> <span >Other</span></a>
<ul>
<li class="toclevel-2 tocsection-40">
<a href="#Printer_%22Paused%22_or_%22Stopped%22_with_Status_%22Rendering_completed%22"><span >6.1</span> <span >Printer "Paused" or "Stopped" with Status "Rendering completed"</span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#Low_ink"><span >6.1.1</span> <span >Low ink</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-42"><a href="#Printing_fails_with_unauthorised_error"><span >6.2</span> <span >Printing fails with unauthorised error</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Unknown_supported_format:_application/postscript"><span >6.3</span> <span >Unknown supported format: application/postscript</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Print-Job_client-error-document-format-not-supported"><span >6.4</span> <span >Print-Job client-error-document-format-not-supported</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Unable_to_get_list_of_printer_drivers"><span >6.5</span> <span >Unable to get list of printer drivers</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#lp:_Error_-_Scheduler_Not_Responding"><span >6.6</span> <span >lp: Error - Scheduler Not Responding</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#%22Using_invalid_Host%22_error_message"><span >6.7</span> <span >"Using invalid Host" error message</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Cannot_print_from_LibreOffice"><span >6.8</span> <span >Cannot print from LibreOffice</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Printer_output_shifted"><span >6.9</span> <span >Printer output shifted</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Printer_becomes_stuck_after_a_problem"><span >6.10</span> <span >Printer becomes stuck after a problem</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#Samsung:_URF_ERROR_-_Incomplete_Session_by_time_out"><span >6.11</span> <span >Samsung: URF ERROR - Incomplete Session by time out</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Brother:_Printer_prints_multiple_copies"><span >6.12</span> <span >Brother: Printer prints multiple copies</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#Regular_user_cannot_change_properties_of_the_printer_or_remove_certain_jobs"><span >6.13</span> <span >Regular user cannot change properties of the printer or remove certain jobs</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<p>The best way to get printing working is to set 'LogLevel' in <code>/etc/cups/cupsd.conf</code> to:
</p>
<pre>LogLevel debug
</pre>
<p>And then viewing the output from <code>/var/log/cups/error_log</code> like this:
</p>
<pre># tail -n 100 -f /var/log/cups/error_log
</pre>
<p>The characters at the left of the output stand for:
</p>
<ul>
<li>D=Debug</li>
<li>E=Error</li>
<li>I=Information</li>
<li>And so on</li>
</ul>
<p>These files may also prove useful:
</p>
<ul>
<li>
<code>/var/log/cups/page_log</code> -  Echoes a new entry each time a print is successful</li>
<li>
<code>/var/log/cups/access_log</code> - Lists all cupsd http1.1 server activity</li>
</ul>
<p>Of course, it is important to know how CUPS works if wanting to solve related issues:
</p>
<ol>
<li>An application sends a .ps file (PostScript, a script language that details how the page will look) to CUPS when 'print' has been selected (this is the case with most programs).</li>
<li>CUPS then looks at the printer's PPD file (printer description file) and figures out what filters it needs to use to convert the .ps file to a language that the printer understands (like PJL, PCL), usually GhostScript.</li>
<li>GhostScript takes the input and figures out which filters it should use, then applies them and converts the .ps file to a format understood by the printer.</li>
<li>Then it is sent to the back-end. For example, if the printer is connected to a USB port, it uses the USB back-end.</li>
</ol>
<p>Print a document and watch <code>error_log</code> to get a more detailed and correct image of the printing process.
</p>
<h2><span class="mw-headline" id="Problems_resulting_from_upgrades">Problems resulting from upgrades</span></h2>
<p><i>Issues that appeared after CUPS and related program packages underwent a version increment</i>
</p>
<h3><span class="mw-headline" id="CUPS_stops_working">CUPS stops working</span></h3>
<p>The chances are that a new configuration file is needed for the new version to work properly. Messages such as "404 - page not found" may result from trying to manage CUPS via localhost:631, for example.
</p>
<p>To use the new configuration, copy <code>/etc/cups/cupsd.conf.default</code> to <code>/etc/cups/cupsd.conf</code> (backup the old configuration if needed) and restart CUPS to employ the new settings.
</p>
<h3>
<span id="All_jobs_are_.22stopped.22"></span><span class="mw-headline" id='All_jobs_are_"stopped"'>All jobs are "stopped"</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> This seems a rather brute-force way of fixing this; maybe the printer is simply disabled? (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:CUPS/Troubleshooting">Talk:CUPS/Troubleshooting#</a>)</div>
</div>
<p>If all jobs sent to the printer become "stopped", delete the printer and add it again.
Using the <a rel="nofollow"  href="http://localhost:631">CUPS web interface</a>, go to Printers &gt; Delete Printer.
</p>
<p>To check the printer's settings go to <i>Printers</i>, then <i>Modify Printer</i>. Copy down the information displayed, click 'Modify Printer' to proceed to the next page(s), and so on.
</p>
<h3>
<span id="All_jobs_are_.22The_printer_is_not_responding.22"></span><span class="mw-headline" id='All_jobs_are_"The_printer_is_not_responding"'>All jobs are "The printer is not responding"</span>
</h3>
<p>On networked printers, you should check that the hostname in the printer's URI resolves to the printer's IP address via DNS, e.g. if your printer's connection looks like this:
</p>
<pre>lpd://BRN_020554/BINARY_P1
</pre>
<p>then the hostname 'BRN_020554' needs to resolve to the printer's IP from the server running CUPS. If <a href="..//Usage/Configuration/A/Avahi.html" title="Avahi">Avahi</a> is being used, ensure that <a href="..//Usage/Configuration/A/Avahi.html#Hostname_resolution" title="Avahi">Avahi's hostname resolution</a> is working.
</p>
<p>Alternatively, replace the hostname used in the URI with the printer's IP address.
</p>
<h3><span class="mw-headline" id="The_PPD_version_is_not_compatible_with_gutenprint">The PPD version is not compatible with gutenprint</span></h3>
<p>Run:
</p>
<pre># /usr/bin/cups-genppdupdate
</pre>
<p>And restart CUPS (as pointed out in gutenprint's post-install message).
</p>
<h2><span class="mw-headline" id="Networking_issues">Networking issues</span></h2>
<h3><span class="mw-headline" id="Unable_to_locate_printer">Unable to locate printer</span></h3>
<p>Even if CUPS can detect networked printers, you may still end up with an "Unable to locate printer" error when trying to print something. The solution to this problem is to enable Avahi's <a href="..//Usage/Configuration/A/Avahi.html#Hostname_resolution" title="Avahi">.local hostname resolution</a>. See <a href="..//Usage/Configuration/C/CUPS.html#Network" title="CUPS">CUPS#Network</a> for details.
</p>
<p>This problem may also arise when you have a firewall. You may need to disable your firewall or set the right rules. Using system-config-printer to detect network printers will do that automatically.
</p>
<p>Similarly, being connected to a VPN may also cause CUPS to be unable to locate the printer. Disabling any VPN connections temporarily for printing can help fixing it.
</p>
<h3><span class="mw-headline" id="Old_CUPS_server">Old CUPS server</span></h3>
<p>As of CUPS version 1.6, the client defaults to IPP 2.0. If the server uses CUPS &lt;= 1.5 / IPP &lt;= 1.1, the client does not downgrade the protocol automatically and thus cannot communicate with the server. A workaround is to append the <code>version=1.1</code> option documented at <a rel="nofollow"  href="https://www.cups.org/doc/network.html#TABLE2">[1]</a> to the URI.
</p>
<h3><span class="mw-headline" id="Shared_printer_works_locally_but_remote_machine_fails_to_print">Shared printer works locally but remote machine fails to print</span></h3>
<p>This is caused by a print job being sent through a filter twice, once on the local machine and once on the remote. See also the warning on the main <a href="..//Usage/Configuration/C/CUPS.html#Network_2" title="CUPS">CUPS</a> page.
</p>
<h3><span class="mw-headline" id="Unable_to_locate_PPD_file">Unable to locate PPD file</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/log/cups/error_log</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Cannot connect to remote printer ipp://HP079676.local
copy_model: empty PPD file</pre>
<p>Make sure <a href="..//Usage/Configuration/A/Avahi.html" title="Avahi">Avahi</a> is set up correctly. In particular, make sure <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nss-mdns">nss-mdns</a></span> is installed and set up in <code>/etc/nsswitch.conf</code>.
</p>
<h3><span class="mw-headline" id="Finding_URIs_for_Windows_print_servers">Finding URIs for Windows print servers</span></h3>
<p>Sometimes Windows is a little less than forthcoming about exact device URIs (device locations).  If having trouble specifying the correct device location in CUPS, run the following command to list all shares available to a certain windows username:
</p>
<pre>$ smbtree -U <i>windowsusername</i>
</pre>
<p>This will list every share available to a certain Windows username on the local area network subnet, as long as Samba is set up and running properly.  It should return something like this:
</p>
<pre> WORKGROUP
	\\REGULATOR-PC   		
		\\REGULATOR-PC\Z              	
		\\REGULATOR-PC\Public         	
		\\REGULATOR-PC\print$         	Printer Drivers
		\\REGULATOR-PC\G              	
		\\REGULATOR-PC\EPSON Stylus CX8400 Series	EPSON Stylus CX8400 Series
</pre>
<p>What is needed here is first part of the last line, the resource matching the printer description.  So to print to the EPSON Stylus printer, one would enter:
</p>
<pre>smb://username:password@REGULATOR-PC/EPSON%20Stylus%20CX8400%20Series
</pre>
<p>as the URI into CUPS.
</p>
<h2><span class="mw-headline" id="USB_printers">USB printers</span></h2>
<h3><span class="mw-headline" id="Conflict_with_SANE">Conflict with SANE</span></h3>
<p>If you are also running <a href="..//Usage/Configuration/S/SANE.html" title="SANE">SANE</a>, it's possible that it is conflicting with CUPS. To fix this create a <a href="..//Usage/Configuration/U/Udev.html" title="Udev">Udev</a> rule marking the device as matched by libsane:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-printer.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ATTRS{idVendor}=="<i>vendor id</i>", ATTRS{idProduct}=="<i>product id</i>", MODE="0664", GROUP="lp", ENV{libsane_matched}="yes"</pre>
<h3><span class="mw-headline" id="Conflict_with_usblp">Conflict with usblp</span></h3>
<p>USB printers can be accessed using two methods: The usblp kernel module and libusb. The former is the classic way. It is simple: data is sent to the printer by writing it to a device file as a simple serial data stream. Reading the same device file allows bi-di access, at least for things like reading out ink levels, status, or printer capability information (PJL). It works very well for simple printers, but for multi-function devices (printer/scanner) it is not suitable and manufacturers like HP supply their own backends. Source: <a rel="nofollow"  href="http://lists.linuxfoundation.org/pipermail/printing-architecture/2012/002412.html">here</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> As of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cups">cups</a></span> version 1.6.0, it should no longer be necessary to blacklist the <code>usblp</code> kernel module.
If you find out this is the only way to fix a remaining issue please report this upstream to the CUPS bug tracker and maybe also get in contact with Till Kamppeter (Debian CUPS maintainer). See <a rel="nofollow"  href="https://github.com/apple/cups/issues/4128">upstream bug</a> for more info.</div>
<p>If you have problems getting your USB printer to work, you can try <a href="..//Usage/Configuration/K/Kernel_module.html#Blacklisting" class="mw-redirect" title="Blacklisting">blacklisting</a> the <code>usblp</code> <a href="..//Usage/Configuration/K/Kernel_module.html" title="Kernel module">kernel module</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/blacklistusblp.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">blacklist usblp
</pre>
<p>Custom kernel users may need to manually load the <code>usbcore</code> <a href="..//Usage/Configuration/K/Kernel_module.html" title="Kernel module">kernel module</a> before proceeding.
</p>
<p>Once the modules are installed, plug in the printer and check if the kernel detected it by running the following:
</p>
<pre># journalctl -e
</pre>
<p>or
</p>
<pre># dmesg
</pre>
<p>If you are using <code>usblp</code>, the output should indicate that the printer has been detected like so:
</p>
<pre>Feb 19 20:17:11 kernel: printer.c: usblp0: USB Bidirectional
printer dev 2 if 0 alt 0 proto 2 vid 0x04E8 pid 0x300E
Feb 19 20:17:11 kernel: usb.c: usblp driver claimed interface cfef3920
Feb 19 20:17:11 kernel: printer.c: v0.13: USB Printer Device Class driver
</pre>
<p>If you blacklisted <code>usblp</code>, you will see something like:
</p>
<pre>usb 3-2: new full speed USB device using uhci_hcd and address 3
usb 3-2: configuration #1 chosen from 1 choice
</pre>
<h3><span class="mw-headline" id="USB_autosuspend">USB autosuspend</span></h3>
<p>The Linux kernel automatically suspends USB devices when there is driver support and the devices are not in use. This can save power, but some USB printers think that they are disconnected when the kernel suspends the USB port, preventing printing. This can be fixed by deactivating autosuspend for the specific device, see <a href="..//Usage/Configuration/P/Power_management.html#USB_autosuspend" title="Power management">Power management#USB autosuspend</a>.
</p>
<h3><span class="mw-headline" id="Bad_permissions">Bad permissions</span></h3>
<p>Check the permissions of the printer USB device. Get the bus and device number from <code>lsusb</code>:
</p>
 <pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"> lsusb </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> Bus &lt;BUSID&gt; Device &lt;DEVID&gt;: ID &lt;VENDOR&gt;:&lt;PRINTERID&gt; Hewlett-Packard DeskJet D1360</pre>
<p>Check the ownership by looking in devfs:
</p>
<pre> # ls -l /dev/bus/usb/&lt;BUSID&gt;/&lt;DEVID&gt;
</pre>
<p>The cups daemon runs as user "cups" and belongs to group "lp", so either this user or group needs read &amp; write access to the USB device. If you think the permissions look wrong, you can change the group and permission temporarily:
</p>
<pre># chgrp lp /dev/bus/usb/&lt;BUSID&gt;/&lt;DEVID&gt;
# chmod 664 /dev/bus/usb/&lt;BUSID&gt;/&lt;DEVID&gt;
</pre>
<p>Then check if cups can now see the USB device correctly.
</p>
<p>To make a persistent permission change that will be triggered automatically each time the USB device is attached, add the following line:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/10-local.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEM=="usb", ATTRS{idVendor}=="&lt;VENDOR&gt;", ATTRS{idProduct}=="&lt;PRINTERID&gt;", GROUP:="lp", MODE:="0664"</pre>
<p>After editing, reload the udev rules with this command:
</p>
<pre># udevadm control --reload-rules
</pre>
<p>Each system may vary, so consult <a href="..//Usage/Configuration/U/Udev.html#List_the_attributes_of_a_device" title="Udev">udev#List the attributes of a device</a> wiki page.
</p>
<h2><span class="mw-headline" id="HP_issues">HP issues</span></h2>
<p>See also <a href="..//Usage/Configuration/C/CUPS/Printer-specific_problems.html#HP" title="CUPS/Printer-specific problems">CUPS/Printer-specific problems#HP</a>.
</p>
<h3>
<span id="CUPS:_.22.2Fusr.2Flib.2Fcups.2Fbackend.2Fhp_failed.22"></span><span class="mw-headline" id='CUPS:_"/usr/lib/cups/backend/hp_failed"'>CUPS: "/usr/lib/cups/backend/hp failed"</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Backend failures can be caused by many issues, and <a href="..//Usage/Configuration/A/Avahi.html" title="Avahi">Avahi</a> should not be required (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:CUPS/Troubleshooting">Talk:CUPS/Troubleshooting#</a>)</div>
</div>
<p>Make sure dbus is installed and running. If the error persists, try starting avahi-daemon.
</p>
<p>Try adding the printer as a Network Printer using the http:// protocol.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> There might need to set permissions issues right.</div>
<h3><span class="mw-headline" id="CUPS:_Job_is_shown_as_complete_but_the_printer_does_nothing">CUPS: Job is shown as complete but the printer does nothing</span></h3>
<p>This happens on HP printers when you select the (old) hpijs driver (e.g. the Deskjet D1600 series). Use the hpcups driver instead.
</p>
<p>Some HP printers require their firmware to be downloaded from the computer every time the printer is switched on. If there is an issue with udev (or equivalent) and the firmware download rule is never fired, you may experience this issue.
As a workaround, you can manually download the firmware to the printer. Ensure the printer is plugged in and switched on, then run
</p>
<pre>hp-firmware -n
</pre>
<h3>
<span id="CUPS:_.27.22foomatic-rip.22_not_available.2Fstopped_with_status_3.27"></span><span class="mw-headline" id="CUPS:_'&quot;foomatic-rip&quot;_not_available/stopped_with_status_3'">CUPS: '"foomatic-rip" not available/stopped with status 3'</span>
</h3>
<p>If receiving any of the following error messages in <code>/var/log/cups/error_log</code> while using a HP printer, with jobs appearing to be processed while they all end up not being completed with their status set to 'stopped':
</p>
<pre>Filter "foomatic-rip" for printer <i>printer_name</i> not available: No such file or director
</pre>
<p>or:
</p>
<pre>PID <i>pid</i> (/usr/lib/cups/filter/foomatic-rip) stopped with status 3!
</pre>
<p>make sure <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=hplip">hplip</a></span> has been <a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installed</a>.
</p>
<h3>
<span id="CUPS:_.22Filter_failed.22"></span><span class="mw-headline" id='CUPS:_"Filter_failed"'>CUPS: "Filter failed"</span>
</h3>
<p>A "filter failed" error can be caused by any number of issues. The CUPS error log (by default  <code>/var/log/cups/error_log</code>) should record which filter failed and why.
</p>
<h4><span class="mw-headline" id="Missing_ghostscript">Missing ghostscript</span></h4>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghostscript">ghostscript</a></span> (<code>/usr/lib/cups/filter/gstoraster</code> needs it to run).
</p>
<h4><span class="mw-headline" id="Missing_foomatic-db">Missing foomatic-db</span></h4>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=foomatic-db">foomatic-db</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=foomatic-db-ppds">foomatic-db-ppds</a></span>. This fixes it in some cases.
</p>
<h4><span class="mw-headline" id="Avahi_not_enabled">Avahi not enabled</span></h4>
<p><a href="..//Usage/Configuration/S/Systemd.html#Using_units" class="mw-redirect" title="Start">Start</a>, and <a href="..//Usage/Configuration/S/Systemd.html#Using_units" class="mw-redirect" title="Enable">enable</a> the <code>avahi-daemon</code> service.
</p>
<h4><span class="mw-headline" id="Out-of-date_plugin">Out-of-date plugin</span></h4>
<p>This error can also indicate that the plugin is out of date (version is mismatched) and may occur after a system upgrade, possibly showing up as a <code>Plugin error</code> message in the logs.
If you have installed <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/hplip-plugin/">hplip-plugin</a></span><sup><small>AUR</small></sup> you will need to update the package, otherwise re-run <code>hp-setup -i</code> to install the latest version of the plugin.
</p>
<h4><span class="mw-headline" id="Outdated_printer_configuration">Outdated printer configuration</span></h4>
<p>As of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/hplip-plugin/">hplip-plugin</a></span><sup><small>AUR</small></sup> v3.17.11 hpijs is not longer available. If you have printers using hpijs they will fail to print. You must modify them and select the new hpcups driver instead.
</p>
<p>You can check if this is your case looking at cups error_log:
</p>
 <pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"> $ grep hpijs /var/log/cups/error_log </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> ...
 D [09/Jan/2018:14:32:58 +0000] [Job 97] <b>sh: hpijs: command not found</b>
 ...</pre>
<h3><span class="mw-headline" id="CUPS:_prints_only_an_empty_and_an_error-message_page_on_HP_LaserJet">CUPS: prints only an empty and an error-message page on HP LaserJet</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> The bug was reported in 2012; is this still an issue? (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:CUPS/Troubleshooting">Talk:CUPS/Troubleshooting#</a>)</div>
</div>
<p>There is a bug that causes CUPS to fail when printing images on HP LaserJet (in my case 3380). The bug has been reported and fixed by <a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/cups-filters/+bug/998087">Ubuntu</a>.
The first page is empty, the second page contains the following error message:
</p>
<pre> ERROR:
 invalidaccess
 OFFENDING COMMAND:
 filter
 STACK:
 /SubFileDecode
 endstream
 ...
</pre>
<p>In order to fix the issue, run the following command as root:
</p>
<pre># lpadmin -p <i>printer</i> -o pdftops-renderer-default=pdftops
</pre>
<h3>
<span id="CUPS:_.22File_.22.2Fusr.2Flib.2Fcups.2Ffilter.2Frastertospl.22_not_available"></span><span class="mw-headline" id='CUPS:_"File_"/usr/lib/cups/filter/rastertospl"_not_available'>CUPS:  "File "/usr/lib/cups/filter/rastertospl" not available</span>
</h3>
<p>After the printer is connected by other means to the network, setting up the HP 107w Laser printer is possible through the CUPS web interface; but this error prevents printing.
</p>
<p>It seems that support for this printer is not provided by hplip. However, drivers can be installed using HP's install scripts and PPD file found at the HP <a rel="nofollow"  href="https://support.hp.com/us-en/drivers/selfservice/hp-laser-100-printer-series/24494339/model/24494342">downloads</a> page.
</p>
<p>Extract the .zip and read this <a rel="nofollow"  href="https://gist.github.com/taniwallach/f1f6c81ce19b7d68f74d4b71d1db57a2">gist</a> for further details and instructions.
</p>
<h3>
<span id="HPLIP_3.13:_Plugin_is_installed.2C_but_HP_Device_Manager_complains_it_is_not"></span><span class="mw-headline" id="HPLIP_3.13:_Plugin_is_installed,_but_HP_Device_Manager_complains_it_is_not">HPLIP 3.13: Plugin is installed, but HP Device Manager complains it is not</span>
</h3>
<p>The issue might have to do with the file permission change that had been made to <code>/var/lib/hp/hplip.state</code>. To correct the issue, a simple <code>chmod 644 /var/lib/hp/hplip.state</code> and <code>chmod 755 /var/lib/hp</code> should be sufficient. For further information, please read this <a rel="nofollow"  href="https://bugs.launchpad.net/hplip/+bug/1131596">link</a>.
</p>
<h3>
<span id="hp-toolbox:_.22Unable_to_communicate_with_device.22"></span><span class="mw-headline" id='hp-toolbox:_"Unable_to_communicate_with_device"'>hp-toolbox: "Unable to communicate with device"</span>
</h3>
<pre># hp-toolbox
# error: Unable to communicate with device (code=12): hp:/usb/<i>printer id</i>
</pre>
<h4><span class="mw-headline" id="Permission_problem">Permission problem</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Presumably, hp-toolbox tries to access /dev/usb/* or /dev/lp, so it needs to be in the <code>lp</code> group. But why <code>sys</code>? And I can't seem to reproduce this... (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:CUPS/Troubleshooting">Talk:CUPS/Troubleshooting#</a>)</div>
</div>
<p>It may be needed to add the user to the <code>lp</code> and <code>sys</code> <a href="..//Usage/Configuration/U/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user groups</a>.
</p>
<h4><span class="mw-headline" id="Virtual_CDROM_printers">Virtual CDROM printers</span></h4>
<p>This can also be caused by printers such as the P1102 that provide a virtual CD-ROM drive for MS Windows drivers. The lp dev appears and then disappears. In that case, try the <b>usb-modeswitch</b> and <b>usb-modeswitch-data</b> packages, that lets one switch off the "Smart Drive" (udev rules included in said packages).
</p>
<h4><span class="mw-headline" id="Networked_printers">Networked printers</span></h4>
<p>This can also occur with network attached printers using dynamic hostnames if the <a href="..//Usage/Configuration/A/Avahi.html" title="Avahi">avahi-daemon</a> is not running. Another possibility is that <i>hp-setup</i> failed to locate the printer because the IP address of the the printer changed due to DHCP. If this is the case, consider adding a DHCP reservation for the printer in the DHCP server's configuration.
</p>
<h3><span class="mw-headline" id="hp-setup_asks_to_specify_the_PPD_file_for_the_discovered_printer">hp-setup asks to specify the PPD file for the discovered printer</span></h3>
<p>Furthermore, when selecting a PPD file in hp-setup's graphical mode, the field does not update and no error message is shown.
</p>
<p>Or, if in interactive (console) mode, you may encounter something similar to this even when providing a correct path to a valid ppd file:
</p>
<pre> Please enter the full filesystem path to the PPD file to use (q=quit) :/usr/share/ppd/HP/hp-deskjet_2050_j510_series.ppd.gz
 Traceback (most recent call last):
   File "/usr/bin/hp-setup", line 536, in &lt;module&gt;
     desc = nickname_pat.search(nickname).group(1)
 TypeError: cannot use a string pattern on a bytes-like object
</pre>
<p>The solution is to install and start <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cups">cups</a></span> before running <code>hp-setup</code>.
</p>
<h3>
<span id="hp-setup:_.22Qt.2FPyQt_4_initialization_failed.22"></span><span class="mw-headline" id='hp-setup:_"Qt/PyQt_4_initialization_failed"'>hp-setup: "Qt/PyQt 4 initialization failed"</span>
</h3>
<p><a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/python-pyqt4/">python-pyqt4</a></span><sup><small>AUR</small></sup>, which is an optdepend of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=hplip">hplip</a></span>. Alternatively, to run hp-setup with the command line interface, use the <code>-i</code> flag.
</p>
<h3>
<span id="hp-setup:_finds_the_printer_automatically_but_reports_.22Unable_to_communicate_with_device.22_when_printing_test_page_immediately_afterwards"></span><span class="mw-headline" id='hp-setup:_finds_the_printer_automatically_but_reports_"Unable_to_communicate_with_device"_when_printing_test_page_immediately_afterwards'>hp-setup: finds the printer automatically but reports "Unable to communicate with device" when printing test page immediately afterwards</span>
</h3>
<p>This at least happens to hplip 3.13.5-2 for HP Officejet 6500A through local network connection. To solve the problem, specify the IP address of the HP printer for hp-setup to locate the printer.
</p>
<h3>
<span id="hp-setup:_.22KeyError:_.27family-class.27.22"></span><span class="mw-headline" id="hp-setup:_&quot;KeyError:_'family-class'&quot;">hp-setup: "KeyError: 'family-class'"</span>
</h3>
<p>If adding a printer fails silently in the UI or you receive a <code>KeyError: 'family-class'</code> traceback from <code>hp-setup</code>, the <code>/usr/share/hplip/data/models/models.dat</code> may need to be manually updated.
Check if <code>family-class=Undefined</code> is defined the section for your printer, if not add it:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/hplip/data/models/models.dat</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[hp_laserjet_pro_mfp_m225dw]
...
family-class=Undefined</pre>
<h2><span class="mw-headline" id="Other">Other</span></h2>
<h3>
<span id="Printer_.22Paused.22_or_.22Stopped.22_with_Status_.22Rendering_completed.22"></span><span class="mw-headline" id='Printer_"Paused"_or_"Stopped"_with_Status_"Rendering_completed"'>Printer "Paused" or "Stopped" with Status "Rendering completed"</span>
</h3>
<h4><span class="mw-headline" id="Low_ink">Low ink</span></h4>
<p>When low on ink, some printers will get stuck in "Rendering completed" status and, if it is a network printer, the printer may even become unreachable from CUPS' perspective despite being properly connected to the network. Replacing the low/depleted ink cartridge(s) in this setting will return the printer to "Ready" status and, if it is a network printer, will make the printer available to CUPS again.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you use third-party ink cartridges, the ink levels reported by the printer may be inaccurate. If you use third-party ink and your printer used to work fine but is now getting stuck on "Rendering completed" status, replace the ink cartridges regardless of the reported ink levels before trying other fixes.</div>
<h3><span class="mw-headline" id="Printing_fails_with_unauthorised_error">Printing fails with unauthorised error</span></h3>
<p>If a remote printer requests authentication CUPS will automatically add an <code>AuthInfoRequired</code> directive to the printer in <code>/etc/cups/printers.conf</code>. However, some graphical applications (for instance, some versions of <a href="..//Usage/Configuration/L/LibreOffice.html" title="LibreOffice">LibreOffice</a> <a rel="nofollow"  href="https://bugs.documentfoundation.org/show_bug.cgi?id=53029">[2]</a>) have no way to prompt for credentials, so printing fails.
To fix this include the required username and password in the URI.
See <a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/cups/+bug/283811">[3]</a>, <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=61826">[4]</a>.
</p>
<h3>
<span id="Unknown_supported_format:_application.2Fpostscript"></span><span class="mw-headline" id="Unknown_supported_format:_application/postscript">Unknown supported format: application/postscript</span>
</h3>
<p>Comment the lines:
</p>
<pre>application/octet-stream        application/vnd.cups-raw        0      -
</pre>
<p>from <code>/etc/cups/mime.convs</code>, and:
</p>
<pre>application/octet-stream
</pre>
<p>in <code>/etc/cups/mime.types</code>.
</p>
<h3><span class="mw-headline" id="Print-Job_client-error-document-format-not-supported">Print-Job client-error-document-format-not-supported</span></h3>
<p>Try installing the foomatic packages and use a foomatic driver.
</p>
<h3><span class="mw-headline" id="Unable_to_get_list_of_printer_drivers">Unable to get list of printer drivers</span></h3>
<p>(Also applicable to error "-1 not supported!")
</p>
<p>Try to remove Foomatic drivers or refer to <a href="..//Usage/Configuration/C/CUPS/Printer-specific_problems.html#HPLIP" title="CUPS/Printer-specific problems">CUPS/Printer-specific problems#HPLIP</a> for a workaround.
</p>
<h3><span class="mw-headline" id="lp:_Error_-_Scheduler_Not_Responding">lp: Error - Scheduler Not Responding</span></h3>
<p>If you get this error, ensure <a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a> is running, the environmental variable <code>CUPS_SERVER</code> is unset, and that <code>/etc/cups/client.conf</code> is correct.
</p>
<h3>
<span id=".22Using_invalid_Host.22_error_message"></span><span class="mw-headline" id='"Using_invalid_Host"_error_message'>"Using invalid Host" error message</span>
</h3>
<p>Try adding <code>ServerAlias *</code> into <code>/etc/cups/cupsd.conf</code>.
</p>
<h3><span class="mw-headline" id="Cannot_print_from_LibreOffice">Cannot print from LibreOffice</span></h3>
<p>If you can print a test page from the <a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a> web interface, but not from <a href="..//Usage/Configuration/L/LibreOffice.html" title="LibreOffice">LibreOffice</a>, try to <a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=a2ps">a2ps</a></span> package.
</p>
<h3><span class="mw-headline" id="Printer_output_shifted">Printer output shifted</span></h3>
<p>This seems to be caused by the wrong page size being set in <a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a>.
</p>
<h3><span class="mw-headline" id="Printer_becomes_stuck_after_a_problem">Printer becomes stuck after a problem</span></h3>
<p>When an issue arises during printing, the printer in CUPS may become unresponsive. <code>lpq</code> reports that the printer <code>is not ready</code>, and it can be reactivated using <code>cupsenable</code>. In the CUPS web interface, the printer is shown as <i>Paused</i>, and can be reactivated by <i>resuming</i> the printer.
</p>
<p>To automatically have CUPS reactivate the printer, change <a rel="nofollow"  href="https://www.cups.org/doc/man-cupsd.conf.html?TOPIC=Man+Pages#ErrorPolicy">ErrorPolicy</a> from the default <code>stop-printer</code> to <code>retry-this-job</code>.
</p>
<h3><span class="mw-headline" id="Samsung:_URF_ERROR_-_Incomplete_Session_by_time_out">Samsung: URF ERROR - Incomplete Session by time out</span></h3>
<p>This error is usually encountered when printing files over the network through IPP to a Samsung printer, and is solved by using the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/samsung-unified-driver/">samsung-unified-driver</a></span><sup><small>AUR</small></sup> package.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The corresponding error code 11-1112 corresponds to an internal wiring problem with the printer, so contacting Samsung's tech support is futile.</div>
<h3><span class="mw-headline" id="Brother:_Printer_prints_multiple_copies">Brother: Printer prints multiple copies</span></h3>
<p>Sometimes the printer will print multiple copies of a document (for instance a MFC-9330CDW printed 10 copies). The solution is to <a href="..//Usage/Configuration/C/CUPS/Printer-specific_problems.html#Updating_the_firmware" title="CUPS/Printer-specific problems">update the printer firmware</a>.
</p>
<h3><span class="mw-headline" id="Regular_user_cannot_change_properties_of_the_printer_or_remove_certain_jobs">Regular user cannot change properties of the printer or remove certain jobs</span></h3>
<p>If a regular user needs to be able to change the printers properties or manage the printer queue, the user may need to be added to the <code>sys</code> group.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Printers.html" title="Category:Printers">Printers</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=CUPS/Troubleshooting&amp;oldid=606979">https://wiki.archlinux.org/index.php?title=CUPS/Troubleshooting&amp;oldid=606979</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 21 April 2020, at 01:03.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">GNOME/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/G/GNOME.html" title="GNOME">GNOME</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p>See <a href="..//Usage/Configuration/G/GNOME.html" title="GNOME">GNOME</a> for the main article.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Shell_freezes"><span >1</span> <span >Shell freezes</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Shell_segfaults"><span >2</span> <span >Shell segfaults</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Incorrect_application_defaults"><span >3</span> <span >Incorrect application defaults</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Tracker_&amp;_Documents_do_not_list_any_local_files"><span >4</span> <span >Tracker &amp; Documents do not list any local files</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Unable_to_add_accounts_in_Empathy_and_GNOME_Online_Accounts"><span >5</span> <span >Unable to add accounts in Empathy and GNOME Online Accounts</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Empathy_does_not_use_GNOME_Online_Accounts"><span >6</span> <span >Empathy does not use GNOME Online Accounts</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#GNOME_Online_Accounts_settings_page_does_not_show_properly"><span >7</span> <span >GNOME Online Accounts settings page does not show properly</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#Cannot_change_settings_in_dconf-editor"><span >8</span> <span >Cannot change settings in dconf-editor</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#When_an_extension_breaks_the_shell"><span >9</span> <span >When an extension breaks the shell</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#Extensions_do_not_work_after_GNOME_3_update"><span >10</span> <span >Extensions do not work after GNOME 3 update</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#Keyboard_shortcut_do_not_work_with_only_conky_running"><span >11</span> <span >Keyboard shortcut do not work with only conky running</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Unable_to_apply_stored_configuration_for_monitors"><span >12</span> <span >Unable to apply stored configuration for monitors</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#Consistent_cursor_theme"><span >13</span> <span >Consistent cursor theme</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Windows_cannot_be_modified_with_Alt-Key_+_mouse-button"><span >14</span> <span >Windows cannot be modified with Alt-Key + mouse-button</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Slow_loading_of_system_icons/slow_GDM_login"><span >15</span> <span >Slow loading of system icons/slow GDM login</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Artifacts_when_maximizing_windows"><span >16</span> <span >Artifacts when maximizing windows</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Tear-free_video_with_Intel_HD_Graphics"><span >17</span> <span >Tear-free video with Intel HD Graphics</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Window_opens_behind_other_windows_when_using_multiple_monitors"><span >18</span> <span >Window opens behind other windows when using multiple monitors</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Lock_button_fails_to_re-enable_touchpad"><span >19</span> <span >Lock button fails to re-enable touchpad</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#GNOME_Shell_keyboard_sources_menu_not_visible"><span >20</span> <span >GNOME Shell keyboard sources menu not visible</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Mouse_cursor_missing"><span >21</span> <span >Mouse cursor missing</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#No_restart_button_in_session_menu_when_screen_is_locked"><span >22</span> <span >No restart button in session menu when screen is locked</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#PulseAudio_system-wide_causes_delay_in_GNOME_and_GDM"><span >23</span> <span >PulseAudio system-wide causes delay in GNOME and GDM</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#GNOME_crashes_when_trying_to_reorder_applications_in_the_GNOME_Shell_Dash"><span >24</span> <span >GNOME crashes when trying to reorder applications in the GNOME Shell Dash</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Gnome_Crashes_while_installing_gnome-extra"><span >25</span> <span >Gnome Crashes while installing gnome-extra</span></a></li>
<li class="toclevel-1 tocsection-26"><a href="#No_H264_Video_in_Gnome_Video_Player_(Totem)"><span >26</span> <span >No H264 Video in Gnome Video Player (Totem)</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#No_suspend_on_LID_closure"><span >27</span> <span >No suspend on LID closure</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#gnome-shell_/_gnome-session_crashes_on_session_startup"><span >28</span> <span >gnome-shell / gnome-session crashes on session startup</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Low_OpenGL_performance_and_stuttering"><span >29</span> <span >Low OpenGL performance and stuttering</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#GNOME_Wayland_session_not_available"><span >30</span> <span >GNOME Wayland session not available</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#gnome-control-center_is_empty_and_does_not_list_any_categories"><span >31</span> <span >gnome-control-center is empty and does not list any categories</span></a></li>
<li class="toclevel-1 tocsection-32"><a href="#Gnome_freezes_for_a_second_after_using_a_Function_(Fn)_key_shortcut"><span >32</span> <span >Gnome freezes for a second after using a Function (Fn) key shortcut</span></a></li>
<li class="toclevel-1 tocsection-33"><a href="#Zoom_in/out_keyboard_shortcuts_don't_work_on_some_apps"><span >33</span> <span >Zoom in/out keyboard shortcuts don't work on some apps</span></a></li>
<li class="toclevel-1 tocsection-34"><a href="#Printers_configuration_does_not_work_in_GNOME_settings"><span >34</span> <span >Printers configuration does not work in GNOME settings</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Shell_freezes">Shell freezes</span></h2>
<p>In the event of a Shell freeze (which might be caused by certain appearance tweaks, malfunctioning extensions or perhaps a lack of available memory) restarting the Shell by pressing <code>Alt</code> + <code>F2</code> and then entering <b>r</b> may not be possible.
</p>
<p>In this case, try switching to another TTY (<b>Ctrl</b> + <b>Alt</b> + <b>F2</b>) and entering the following command: <code>pkill -HUP gnome-shell</code>. It may take a few seconds before the Shell successfully restarts. On X11 restarting the shell in this fashion should not log the user out but it is a good idea to try and ensure that all work is saved anyway; on Wayland (currently the default) restarting the shell kills the whole session, so everything will be lost.
</p>
<p>If this fails, the <a href="..//Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a> server will need to be restarted either by: <code>pkill X</code> for console logins or: <code>systemctl restart gdm</code> for GDM logins. Bear in mind that restarting the Xorg server will log the user out so try to ensure that all work is saved before attempting this.
</p>
<h2><span class="mw-headline" id="Shell_segfaults">Shell segfaults</span></h2>
<p>If you experience gnome-shell disappearing and reappearing, it means that it has segfaulted (probably because of an extension). Gnome-shell extensions use javascript; to enable debugging of extensions, it is necessary to
</p>
<p>1) rebuild <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gjs">gjs</a></span> with the following changes to the PKGBUILD:
</p>
<pre>--- PKGBUILD (old)
+++ PKGBUILD (new)
@@ -29,10 +29,13 @@
 build() {
   cd $pkgname
+  export CXXFLAGS='-g -O0'
+  export CPPFLAGS='-D_FORITFY_SOURCE=0'
   ./configure \
+    --enable-debug-symbols=-gdwarf-2 \
     --prefix=/usr \
     --libexecdir=/usr/lib \
     --disable-static \
     --enable-compile-warnings=yes \
     --with-xvfb-tests
   sed -i -e 's/ -shared / -Wl,-O1,--as-needed\0/g' libtool
   make
 }</pre>
<p>2) rebuild <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=js52">js52</a></span> with the following changes to the PKGBUILD:
</p>
<pre>--- PKGBUILD (old)
+++ PKGBUILD (new)
@@ -24,0 +25 @@
+options=(debug)
@@ -36,11 +37,9 @@
 build() {
   unset CPPFLAGS
   CFLAGS+=' -fno-delete-null-pointer-checks -fno-strict-aliasing -fno-tree-vrp -flto=3'
   CXXFLAGS+=' -fno-delete-null-pointer-checks -fno-strict-aliasing -fno-tree-vrp -flto=3'
   export CC=gcc CXX=g++ PYTHON=/usr/bin/python2
 
   cd mozilla-unified/js/src
   sh configure \
     --prefix=/usr \
-    --disable-debug \
-    --disable-debug-symbols \</pre>
<p>Once the gjs and js52 packages are installed and gnome-shell restarted (<code>Alt</code>+ <code>F2</code> + <code>r</code>), whenever gnome-shell crashes the debug symbols will be available.
</p>
<p>After the crash:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ coredumpctl -1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">TIME                            PID   UID   GID SIG COREFILE  EXE
Mon 2017-07-17 15:34:49 CEST  27368  1000  1000  11 present   /usr/bin/gnome-shell
$ coredumpctl gdb 27368
(gdb) bt
#0  0x00007fbc7b997945 in js::GCMethods&lt;JSObject*&gt;::needsPostBarrier(JSObject*) (v=0x7fbc0a9548c0) at /usr/include/mozjs-38/js/RootingAPI.h:663
#1  0x00007fbc7b997945 in JS::Heap&lt;JSObject*&gt;::set(JSObject*) (newPtr=0x0, this=0x254c260) at /usr/include/mozjs-38/js/RootingAPI.h:296
#2  0x00007fbc7b997945 in JS::Heap&lt;JSObject*&gt;::operator=(JSObject* const&amp;) (p=&lt;optimized out&gt;, this=0x254c260) at /usr/include/mozjs-38/js/RootingAPI.h:266
#3  0x00007fbc7b997945 in GjsMaybeOwned&lt;JSObject*&gt;::reset() (this=0x254c250) at ./gjs/jsapi-util-root.h:267
#4  0x00007fbc7b997945 in closure_clear_idle(void*) (data=0x254c220) at gi/closure.cpp:133
#5  0x00007fbc79abd8c5 in g_main_context_dispatch () at /usr/lib/libglib-2.0.so.0
#6  0x00007fbc79abdc88 in  () at /usr/lib/libglib-2.0.so.0
#7  0x00007fbc79abdfa2 in g_main_loop_run () at /usr/lib/libglib-2.0.so.0
#8  0x00007fbc7b27508c in meta_run () at /usr/lib/libmutter-0.so.0
#9  0x0000000000401ff7 in main ()</pre>
<p>You can then report the bug on the <a rel="nofollow"  href="https://gitlab.gnome.org/GNOME/gnome-shell/issues">project page</a> at GNOME GitLab.
</p>
<h2><span class="mw-headline" id="Incorrect_application_defaults">Incorrect application defaults</span></h2>
<p>When installing applications for the first time you may find that GNOME has the wrong application associated to a certain protocols - for instance, <i>easytag</i> becomes the folder handler instead of <a href="..//Usage/Configuration/G/GNOME/Files.html" class="mw-redirect" title="GNOME Files">GNOME Files</a>.
</p>
<p>For GNOME Files see the following page: <a href="..//Usage/Configuration/G/GNOME/Files.html#Files_is_no_longer_the_default_file_manager" class="mw-redirect" title="GNOME Files">GNOME Files#Files is no longer the default file manager</a>.
</p>
<p>For Document Viewer, run the following command:
</p>
<pre>$ xdg-mime default evince.desktop application/pdf
</pre>
<p>For other applications, default handler settings are detailed on the following page: <a href="..//Usage/Configuration/D/Default_applications.html" title="Default applications">Default applications</a>.
</p>
<p>Optionally, you can <a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/gnome-defaults-list/">gnome-defaults-list</a></span><sup><small>AUR</small></sup>. It will place your configuration file at <code>/etc/gnome/defaults.list</code>.
</p>
<h2>
<span id="Tracker_.26_Documents_do_not_list_any_local_files"></span><span class="mw-headline" id="Tracker_&amp;_Documents_do_not_list_any_local_files">Tracker &amp; Documents do not list any local files</span>
</h2>
<p>In order for Tracker (and, therefore, Documents) to detect your local files, they must be stored in an <a rel="nofollow"  href="https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html">XDG compliant directory</a> (such as 'Documents' or 'Music'). For more information, see <a href="..//Usage/Configuration/X/XDG_user_directories.html" title="XDG user directories">XDG user directories</a>.
</p>
<p>You can also configure Tracker to recursively search inside specific directories such as your home directory. These settings can be made using <code>tracker-preferences</code>.
</p>
<h2><span class="mw-headline" id="Unable_to_add_accounts_in_Empathy_and_GNOME_Online_Accounts">Unable to add accounts in Empathy and GNOME Online Accounts</span></h2>
<p>Empathy, the engine behind integrated messaging, GNOME Online Accounts, and all other system settings based on messaging accounts will not function correctly unless the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/groups/x86_64/telepathy/">telepathy</a></span> group of packages or at least one of the backends (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=telepathy-gabble">telepathy-gabble</a></span>, or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=telepathy-haze">telepathy-haze</a></span>, for example) is <a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installed</a>. View descriptions of <i>telepathy</i> components on the <a rel="nofollow"  href="https://telepathy.freedesktop.org/wiki/Components/">freedesktop.org telepathy wiki</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <a href="..//Usage/Configuration/A/Avahi.html" title="Avahi">Avahi</a> daemon is required for connecting with the People Nearby account, and also in order for some desktop extensions to work correctly like <a rel="nofollow"  href="https://extensions.gnome.org/extension/746/chat-status/">Chat Status</a>
</div>
<h2><span class="mw-headline" id="Empathy_does_not_use_GNOME_Online_Accounts">Empathy does not use GNOME Online Accounts</span></h2>
<p>After adding a Gnome Online Account, it may be necessary to log out and log back in for it to be used by Empathy.
</p>
<h2><span class="mw-headline" id="GNOME_Online_Accounts_settings_page_does_not_show_properly">GNOME Online Accounts settings page does not show properly</span></h2>
<p>In some cases, due to interactions with Alacarte (menu editor), Gnome Online accounts settings page would not show. If that happens, "Restore System Configuration" in Alacarte can restore missing functions to gnome-control-center. (See <a rel="nofollow"  href="https://bugzilla.redhat.com/show_bug.cgi?id=1520431">https://bugzilla.redhat.com/show_bug.cgi?id=1520431</a>.)
</p>
<h2><span class="mw-headline" id="Cannot_change_settings_in_dconf-editor">Cannot change settings in dconf-editor</span></h2>
<p>When one cannot set settings in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=dconf">dconf</a></span>, it is possible their dconf user settings are corrupt. In this case it is best to delete the user dconf files in <code>~/.config/dconf/user*</code> and set the settings in dconf-editor after.
</p>
<h2><span class="mw-headline" id="When_an_extension_breaks_the_shell">When an extension breaks the shell</span></h2>
<p>When enabling shell extensions causes GNOME breakage, you should first remove the <i>user-theme</i> and <i>auto-move-windows</i> extensions from their installation directory.
</p>
<p>The installation directory could be one of  <code>~/.local/share/gnome‑shell/extensions</code>, <code>/usr/share/gnome‑shell/extensions</code> or <code>/usr/local/share/gnome‑shell/extensions</code>. Removing these two extension-containing folders may fix the breakage. Otherwise, isolate the problem extension with trial‑and‑error.
</p>
<p>Removing or adding an extension-containing folder to the aforementioned directories removes or adds the corresponding extension to your system. Details on GNOME Shell extensions are available at the <a rel="nofollow"  href="https://wiki.gnome.org/Projects/GnomeShell/Extensions">GNOME web site.</a>
</p>
<p>If you have trouble with uninstalling an extension via <a rel="nofollow"  href="https://extensions.gnome.org/local/">extensions.gnome.org/local</a>, then probably they have been installed as system-wide extensions with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-shell-extensions">gnome-shell-extensions</a></span> package. Removing the package again obviously affects all user accounts.
</p>
<h2><span class="mw-headline" id="Extensions_do_not_work_after_GNOME_3_update">Extensions do not work after GNOME 3 update</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Please bear in mind that whilst the methods below will allow you to <b>try</b> and activate an extension with an unsupported version of GNOME Shell, it is by no means a guarantee that the extension will work successfully. The most likely outcome of trying to activate such an extension is that GNOME Shell will crash and then restart.</div>
<p>Before trying the workarounds below, check if an update is available for the extension by visiting <a rel="nofollow"  href="https://extensions.gnome.org/local">extensions.gnome.org/local</a>. 
</p>
<p>If there is no update for your current GNOME version yet, use the following command to disable version validation for extensions:
</p>
<pre>$ gsettings set org.gnome.shell disable-extension-version-validation true
</pre>
<p>Alternatively, you could modify the extension itself, changing the supported shell version to satisfy the version validation. See the method below.
</p>
<p>Locate the folder where your extensions are installed. It might be <code>~/.local/share/gnome-shell/extensions</code> or <code>/usr/share/gnome-shell/extensions</code>.
</p>
<p>Edit each occurrence of <code>metadata.json</code> which appears in each extension sub-folder.
</p>
<table border="0">
<tbody>
<tr>
<td>Insert:</td>
<td>
<code>"shell-version": ["3.x"]</code>
</td>
</tr>
<tr>
<td>Instead of (for example):</td>
<td>
<code>"shell-version": ["3.4"]</code>
</td>
</tr>
</tbody>
</table>
<p><code>"3.x"</code> indicates the extension works with every shell version. If it breaks, you will know to change it back.
</p>
<h2><span class="mw-headline" id="Keyboard_shortcut_do_not_work_with_only_conky_running">Keyboard shortcut do not work with only conky running</span></h2>
<p>The GNOME shell keyboard shortcuts like <code>Alt+F2</code>, <code>Alt+F1</code>, and the media key shortcuts do not work if conky is the only program running. However, if another application like <i>gedit</i> is running, then the keyboard shortcuts work.
</p>
<p>Solution: edit <code>.conkyrc</code>
</p>
<pre>own_window yes
own_window_transparent yes
own_window_argb_visual yes
own_window_type dock
own_window_class Conky
own_window_hints undecorated,below,sticky,skip_taskbar,skip_pager
</pre>
<h2><span class="mw-headline" id="Unable_to_apply_stored_configuration_for_monitors">Unable to apply stored configuration for monitors</span></h2>
<p>If you encounter this message try to disable the <i>xrandr</i> <code>gnome-settings-daemon plugin</code>:
</p>
<pre>$ dconf write /org/gnome/settings-daemon/plugins/xrandr/active false
</pre>
<h2><span class="mw-headline" id="Consistent_cursor_theme">Consistent cursor theme</span></h2>
<p>See <a href="..//Usage/Configuration/C/Cursor_themes.html#Desktop_environments" title="Cursor themes">Cursor themes#Desktop environments</a>.
</p>
<h2>
<span id="Windows_cannot_be_modified_with_Alt-Key_.2B_mouse-button"></span><span class="mw-headline" id="Windows_cannot_be_modified_with_Alt-Key_+_mouse-button">Windows cannot be modified with Alt-Key + mouse-button</span>
</h2>
<p>In GNOME 3.6 and above, the mouse button modifier (the key that allows you to drag a window from a location other than the titlebar) is the <code>Super</code> key instead of the <code>Alt</code> key which was used in the past. The change was made in response to the following <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=607797">bug report</a>. 
</p>
<p>To change the mouse button modifier back to the <code>Alt</code> key, execute the following:
</p>
<pre>$ gsettings set org.gnome.desktop.wm.preferences mouse-button-modifier '&lt;Alt&gt;'  
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> It is not possible to change this with <i>System settings</i> &gt; <i>Keyboard</i> &gt; <i>Shortcuts</i>
</div>
<h2>
<span id="Slow_loading_of_system_icons.2Fslow_GDM_login"></span><span class="mw-headline" id="Slow_loading_of_system_icons/slow_GDM_login">Slow loading of system icons/slow GDM login</span>
</h2>
<p>Problems with the loading of system icons, such the ones in the title bar of Files, might be solved by executing the following command:
</p>
<pre># gdk-pixbuf-query-loaders --update-cache
</pre>
<p>Running the aforementioned command may also fix repeated occurrences of the  "Oh no! Something has gone wrong!" error screen and/or very slow loading and login with GDM as described in the following <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?pid=1414157">forum thread</a>.
</p>
<h2><span class="mw-headline" id="Artifacts_when_maximizing_windows">Artifacts when maximizing windows</span></h2>
<p>Maximizing windows may cause artifacts as of GNOME 3.12.0 - see the following <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=183617">forum thread</a>  and <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=728385">bug report</a>. A solution is detailed in the following section: <a href="#Tear-free_video_with_Intel_HD_Graphics">#Tear-free video with Intel HD Graphics</a>.
</p>
<h2><span class="mw-headline" id="Tear-free_video_with_Intel_HD_Graphics">Tear-free video with Intel HD Graphics</span></h2>
<dl><dt>DRI3</dt></dl>
<p>According to <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=711028#c2">this bug report</a>, DRI3 includes the <code>buffer_age</code> extension that allows GNOME Shell's Mutter compositor to sync windows to vblank in an efficient way. Since version <code>1:2.99.917+682+g4eaab17-1</code>, DRI3 is enabled by default in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=xf86-video-intel">xf86-video-intel</a></span> <a rel="nofollow"  href="https://git.archlinux.org/svntogit/packages.git/commit/trunk?h=packages/xf86-video-intel&amp;id=cd3de9bb45a9ab84383541ed45ee6f0c10ea8798">[1]</a>.
</p>
<dl><dt>Intel TearFree</dt></dl>
<p>Enabling the <a href="..//Usage/Configuration/I/Intel_graphics.html#Tearing" title="Intel graphics">Xorg Intel TearFree option</a> is a known workaround for tearing problems on Intel adapters. However, the way this option acts increases memory consumption and lowers performance, see <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=37686#c123">the original bug report's final comment</a>.
</p>
<dl><dt>Mutter tweaks</dt></dl>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This workaround has been <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=711028#c0">reported</a> to have side effects and may not fix tearing in all cases.</div>
<p>GNOME Shell's Mutter compositor has a tweak known to address tearing problems (see <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=657071#c1">the original suggestion for this fix</a> and its mention in <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=37686#c59">the Freedesktop bug report</a>). To enable this tweak, append the following line to <code>/etc/environment</code>: <code>CLUTTER_PAINT=disable-clipped-redraws:disable-culling</code>. Then restart the Xorg server.
</p>
<dl><dt>Disable Fullscreen Unredirect</dt></dl>
<p>Gnome Shell does by default unredirect fullscreen applications. This may result in tearing. You can disable this with the gnome shell extension <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/gnome-shell-extension-disable-unredirect/">gnome-shell-extension-disable-unredirect</a></span><sup><small>AUR</small></sup>.
</p>
<h2><span class="mw-headline" id="Window_opens_behind_other_windows_when_using_multiple_monitors">Window opens behind other windows when using multiple monitors</span></h2>
<p>This is possibly a bug in GNOME Shell which causes new windows to open behind others. To fix this issue, one can run the following command:
</p>
<pre>$ gsettings set org.gnome.shell.overrides workspaces-only-on-primary false
</pre>
<h2><span class="mw-headline" id="Lock_button_fails_to_re-enable_touchpad">Lock button fails to re-enable touchpad</span></h2>
<p>Some laptops have a touchpad lock button that disables the touchpad so that users can type without worrying about touching the touchpad. Currently, it appears that although GNOME can lock the touchpad by pressing this button, it cannot unlock it. If the touchpad gets locked you can run the following to unlock it:
</p>
<pre>$ xinput set-prop "SynPS/2 Synaptics TouchPad" "Device Enabled" 1
</pre>
<h2><span class="mw-headline" id="GNOME_Shell_keyboard_sources_menu_not_visible">GNOME Shell keyboard sources menu not visible</span></h2>
<p>A menu showing the keyboard input sources (for example 'en' for an English keyboard layout) should be visible next to the status area containing icons for network, volume and power sources. If the keyboard sources menu is not visible, this is probably because you have configured your <a href="..//Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a> keyboard layout in a way which GNOME does not recognise.
</p>
<p>To ensure that the menu is visible, remove any Xorg keyboard configuration you might have created and set the keyboard locale using <a href="..//Usage/Configuration/X/Xorg/Keyboard_configuration.html#Using_localectl" class="mw-redirect" title="Keyboard configuration in Xorg">localectl</a>.
</p>
<p>Upon running the command and then logging out, you should find that the keyboard input sources menu is visible in GDM and in the GNOME Shell desktop. See <a rel="nofollow"  href="https://blogs.gnome.org/mclasen/2012/09/21/input-sources-in-gnome/">Input sources in GNOME</a> for more information.
</p>
<h2><span class="mw-headline" id="Mouse_cursor_missing">Mouse cursor missing</span></h2>
<p>When using a separate <a href="..//Usage/Configuration/W/Window_manager.html" title="Window manager">window manager</a> with <i>gnome-settings-daemon</i>, the mouse cursor may vanish. Run:
</p>
<pre>$ gsettings set org.gnome.settings-daemon.plugins.cursor active false
</pre>
<h2><span class="mw-headline" id="No_restart_button_in_session_menu_when_screen_is_locked">No restart button in session menu when screen is locked</span></h2>
<p>If <a href="..//Usage/Configuration/X/XScreenSaver.html" title="XScreenSaver">XScreenSaver</a> is installed, ensure that it is not running at startup, see <a href="..//Usage/Configuration/G/GNOME.html#Autostart" title="GNOME">GNOME#Autostart</a>.
</p>
<h2><span class="mw-headline" id="PulseAudio_system-wide_causes_delay_in_GNOME_and_GDM">PulseAudio system-wide causes delay in GNOME and GDM</span></h2>
<p>If you are running <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> in system-wide mode, the PulseAudio 7.0 upgrade breaks <a href="..//Usage/Configuration/G/GDM.html" title="GDM">GDM</a> and GNOME.
See <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=203051">this forum post</a> for more information.
</p>
<h2><span class="mw-headline" id="GNOME_crashes_when_trying_to_reorder_applications_in_the_GNOME_Shell_Dash">GNOME crashes when trying to reorder applications in the GNOME Shell Dash</span></h2>
<p>The dash is the "toolbar" that appears, by default, <a href="https://en.wikipedia.org/wiki/GNOME_Shell#Design_components"  title="wikipedia:GNOME Shell">on the left</a> when you click Activities. Applications can be reordered in the dash by dragging and dropping. If this fails, and/or causes GNOME to crash, try <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=171689">changing your icon theme</a>.
</p>
<h2><span class="mw-headline" id="Gnome_Crashes_while_installing_gnome-extra">Gnome Crashes while installing gnome-extra</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Is there a related bug report? (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:GNOME/Troubleshooting">Talk:GNOME/Troubleshooting#</a>)</div>
</div>
<p>Attempting to install the gnome-extra group while a gnome environment is running will crash gnome while installing gnome-getting-started-docs. X will continue to run, but gnome will not work until fixed. To fix, simply install gnome-extra from a terminal rather than inside gnome. When complete, gnome should work again.
</p>
<h2>
<span id="No_H264_Video_in_Gnome_Video_Player_.28Totem.29"></span><span class="mw-headline" id="No_H264_Video_in_Gnome_Video_Player_(Totem)">No H264 Video in Gnome Video Player (Totem)</span>
</h2>
<p><a href="..//Usage/Configuration/C/Codecs_and_containers.html#Tips_and_tricks" class="mw-redirect" title="Codecs">See Codecs</a>
</p>
<h2><span class="mw-headline" id="No_suspend_on_LID_closure">No suspend on LID closure</span></h2>
<p>GNOME defaults to this behaviour about suspension:
</p>
<ul>
<li>No external monitor attached, computer goes in suspension when LID closes.</li>
<li>External monitor attached, computer does not go in suspension when LID closes.</li>
</ul>
<p>Currently <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-tweaks">gnome-tweaks</a></span> is not able to modify the behaviour on the second case, when a monitor is connected to the computer. While it can inhibit suspension with no monitor attached.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Behaviour on LID closure is controlled also by systemd. See <a href="..//Usage/Configuration/P/Power_management.html#Power_management_with_systemd" title="Power management">Power management#Power management with systemd</a>.</div>
<h2>
<span id="gnome-shell_.2F_gnome-session_crashes_on_session_startup"></span><span class="mw-headline" id="gnome-shell_/_gnome-session_crashes_on_session_startup">gnome-shell / gnome-session crashes on session startup</span>
</h2>
<p>Sometimes <code>gnome-session</code> crashes immediately after login. This might be more visible on wayland and it might seem as if every second login attempt fails. The problem can be temporarily worked around by removing the files in <code>~/.config/gnome-session/saved-session</code>. A more lasting work-around is to disable the session manager's <code>auto-save-session</code> feature:
</p>
<pre>$ gsettings set org.gnome.SessionManager auto-save-session false
</pre>
<h2><span class="mw-headline" id="Low_OpenGL_performance_and_stuttering">Low OpenGL performance and stuttering</span></h2>
<ul><li>With proprietary NVIDIA driver</li></ul>
<p><a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=781835">This</a> bug is much likely the cause of it. You should revert <code>383ba566bd7c2a76d0856015a66e47caedef06b6 </code> commit in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mutter">mutter</a></span>. Use <a href="..//Usage/Configuration/T/TOS_Build_System.html" class="mw-redirect" title="ABS">ABS</a> for this and add <code>git revert -n 383ba566bd7c2a76d0856015a66e47caedef06b6</code> to the <code>prepare()</code> function in the <a href="..//Usage/Configuration/P/PKGBUILD.html" title="PKGBUILD">PKGBUILD</a> or simply install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/mutter-performance/">mutter-performance</a></span><sup><small>AUR</small></sup> instead.
</p>
<ul><li>With free drivers</li></ul>
<p>If video playback stutters (a bit), try <i>GNOME on Xorg</i> instead of Wayland.
</p>
<h2><span class="mw-headline" id="GNOME_Wayland_session_not_available">GNOME Wayland session not available</span></h2>
<p>GNOME Wayland does not support more than one GPU for output yet, <a rel="nofollow"  href="https://bugzilla.gnome.org/show_bug.cgi?id=771442">falling back</a> on GNOME X11.
</p>
<p>If your displays are only connected to one of your video devices, add this to your <a href="..//Usage/Configuration/E/Environment_variables.html#Using_pam_env" title="Environment variables">system environment variables</a>:
</p>
<pre>MUTTER_ALLOW_HYBRID_GPUS=1
</pre>
<p>To avoid <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?pid=1744592#p1744592">problems</a> with some chipsets enable <a href="..//Usage/Configuration/K/Kernel_mode_setting.html#Early_KMS_start" title="Kernel mode setting">Early KMS</a>.
</p>
<p><br>
</p>
<h2><span class="mw-headline" id="gnome-control-center_is_empty_and_does_not_list_any_categories">gnome-control-center is empty and does not list any categories</span></h2>
<p>Under alternative window managers (i3 for example), <i>gnome-control-center</i> starts as an empty window.
You need to set the variable <code>XDG_CURRENT_DESKTOP</code> to <code>GNOME</code> to start it (either in a script or exporting the variable in <code>~/.profile</code>).
</p>
<pre> export XDG_CURRENT_DESKTOP=GNOME
 gnome-control-center &amp;
</pre>
<p><br>
</p>
<h2>
<span id="Gnome_freezes_for_a_second_after_using_a_Function_.28Fn.29_key_shortcut"></span><span class="mw-headline" id="Gnome_freezes_for_a_second_after_using_a_Function_(Fn)_key_shortcut">Gnome freezes for a second after using a Function (Fn) key shortcut</span>
</h2>
<p>This is a problem with the brazilian portuguese ABNT 2 keyboard. If you have the brazilian portuguese  enabled, GNOME might experience this problem. To fix this issue and keep using this keyboard layout, un-map the scroll lock button by commenting this line at <code>/usr/share/X11/xkb/symbols/br</code>:
</p>
<pre> modifier_map Mod3   { Scroll_Lock };
</pre>
<p>And restart the session (log out and in).
</p>
<h2>
<span id="Zoom_in.2Fout_keyboard_shortcuts_don.27t_work_on_some_apps"></span><span class="mw-headline" id="Zoom_in/out_keyboard_shortcuts_don't_work_on_some_apps">Zoom in/out keyboard shortcuts don't work on some apps</span>
</h2>
<p><code>Ctrl</code> + <code>+</code> and <code>Ctrl</code> + <code>-</code> keyboard shourtcuts for zoom in/out functions don't work out of the box on some Gnome apps, such as Files and Gnome-Terminal.
</p>
<p>In such cases, open up GNOME Tweaks (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-tweaks">gnome-tweaks</a></span>) and navigate to Keyboard &amp; Mouse &gt; Additional Layout Options button &gt; Layout of numeric keypad. Change the <code>Disabled</code> value to <code>Hexadecimal</code>.
</p>
<h2><span class="mw-headline" id="Printers_configuration_does_not_work_in_GNOME_settings">Printers configuration does not work in GNOME settings</span></h2>
<p><a href="..//Usage/Configuration/C/CUPS.html" title="CUPS">CUPS</a> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=system-config-printer">system-config-printer</a></span> should be installed
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:GNOME.html" title="Category:GNOME">GNOME</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li></ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GNOME/Troubleshooting&amp;oldid=611668">https://wiki.archlinux.org/index.php?title=GNOME/Troubleshooting&amp;oldid=611668</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 9 May 2020, at 10:40.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Steam/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/S/Steam.html" title="Steam">Steam</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Introduction"><span >1</span> <span >Introduction</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Relevant_online_resources"><span >1.1</span> <span >Relevant online resources</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3">
<a href="#Steam_runtime"><span >2</span> <span >Steam runtime</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Steam_native_runtime"><span >2.1</span> <span >Steam native runtime</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#Debugging_shared_libraries"><span >3</span> <span >Debugging shared libraries</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Finding_missing_game_libraries"><span >3.1</span> <span >Finding missing game libraries</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Finding_missing_runtime_libraries"><span >3.2</span> <span >Finding missing runtime libraries</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Debugging_Steam"><span >4</span> <span >Debugging Steam</span></a></li>
<li class="toclevel-1 tocsection-9">
<a href="#Runtime_issues"><span >5</span> <span >Runtime issues</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Segmentation_fault_when_disabling_runtime"><span >5.1</span> <span >Segmentation fault when disabling runtime</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#'GLBCXX_3.X.XX'_not_found_when_using_Bumblebee"><span >5.2</span> <span >'GLBCXX_3.X.XX' not found when using Bumblebee</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Game_crashes_immediately"><span >5.3</span> <span >Game crashes immediately</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Game_and_Steam_crashes_after_game_start"><span >5.4</span> <span >Game and Steam crashes after game start</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Version_%60CURL_OPENSSL_3%60_not_found"><span >5.5</span> <span >Version `CURL_OPENSSL_3` not found</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Steam_webview/game_browser_not_working_in_native_runtime_(Black_screen)"><span >5.6</span> <span >Steam webview/game browser not working in native runtime (Black screen)</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Steam:_An_X_Error_occurred"><span >5.7</span> <span >Steam: An X Error occurred</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#Audio_issues"><span >6</span> <span >Audio issues</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Configure_PulseAudio"><span >6.1</span> <span >Configure PulseAudio</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#No_audio_or_756_Segmentation_fault"><span >6.2</span> <span >No audio or 756 Segmentation fault</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#FMOD_sound_engine"><span >6.3</span> <span >FMOD sound engine</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#PulseAudio_&amp;_OpenAL:_Audio_streams_can't_be_moved_between_devices"><span >6.4</span> <span >PulseAudio &amp; OpenAL: Audio streams can't be moved between devices</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#Steam_client_issues"><span >7</span> <span >Steam client issues</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#Cannot_add_library_folder_because_of_missing_execute_permissions"><span >7.1</span> <span >Cannot add library folder because of missing execute permissions</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Unusually_slow_download_speed"><span >7.2</span> <span >Unusually slow download speed</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#%22Needs_to_be_online%22_error"><span >7.3</span> <span >"Needs to be online" error</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Steam_forgets_password"><span >7.4</span> <span >Steam forgets password</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Preventing_crash_memory_dumps"><span >7.5</span> <span >Preventing crash memory dumps</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Steam_license_problem_with_playing_videos"><span >7.6</span> <span >Steam license problem with playing videos</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#No_context_menu_for_joining/inviting_friends"><span >7.7</span> <span >No context menu for joining/inviting friends</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Slow_and_unresponsive_user_interface"><span >7.8</span> <span >Slow and unresponsive user interface</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Steam_fails_to_start_correctly"><span >7.9</span> <span >Steam fails to start correctly</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-32">
<a href="#Steam_Remote_Play_issues"><span >8</span> <span >Steam Remote Play issues</span></a>
<ul>
<li class="toclevel-2 tocsection-33"><a href="#Remote_Play_does_not_work_from_TOS_Linux_host_to_TOS_Linux_guest"><span >8.1</span> <span >Remote Play does not work from TOS Linux host to TOS Linux guest</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Hardware_decoding_not_available"><span >8.2</span> <span >Hardware decoding not available</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Big_Picture_Mode_minimizes_itself_after_losing_focus"><span >8.3</span> <span >Big Picture Mode minimizes itself after losing focus</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-36">
<a href="#Other_issues"><span >9</span> <span >Other issues</span></a>
<ul>
<li class="toclevel-2 tocsection-37"><a href="#Steam_Library_in_NTFS_partition"><span >9.1</span> <span >Steam Library in NTFS partition</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Wrong_ELF_class"><span >9.2</span> <span >Wrong ELF class</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Multiple_monitors_setup"><span >9.3</span> <span >Multiple monitors setup</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Text_is_corrupt_or_missing"><span >9.4</span> <span >Text is corrupt or missing</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#SetLocale('en_US.UTF-8')_fails_at_game_startup_or_typing_non-ASCII_characters_does_not_work_in_the_Steam_client"><span >9.5</span> <span >SetLocale('en_US.UTF-8') fails at game startup or typing non-ASCII characters does not work in the Steam client</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Missing_libc"><span >9.6</span> <span >Missing libc</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Games_do_not_launch_on_older_Intel_hardware"><span >9.7</span> <span >Games do not launch on older Intel hardware</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#Mesa:_Game_does_not_launch,_complaining_about_OpenGL_version_supported_by_the_card"><span >9.8</span> <span >Mesa: Game does not launch, complaining about OpenGL version supported by the card</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#2K_games_do_not_run_on_XFS_partitions"><span >9.9</span> <span >2K games do not run on XFS partitions</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Steam_controller_not_being_detected_correctly"><span >9.10</span> <span >Steam controller not being detected correctly</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Steam_controller_makes_a_game_crash"><span >9.11</span> <span >Steam controller makes a game crash</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Steam_hangs_on_%22Installing_breakpad_exception_handler...%22"><span >9.12</span> <span >Steam hangs on "Installing breakpad exception handler..."</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Killing_standalone_compositors_when_launching_games"><span >9.13</span> <span >Killing standalone compositors when launching games</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Symbol_lookup_error_using_DRI3"><span >9.14</span> <span >Symbol lookup error using DRI3</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#Launching_games_on_Nvidia_optimus_laptops"><span >9.15</span> <span >Launching games on Nvidia optimus laptops</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#HiDPI"><span >9.16</span> <span >HiDPI</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#Protocol_support_under_KDE_Plasma"><span >9.17</span> <span >Protocol support under KDE Plasma</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Introduction">Introduction</span></h2>
<ol>
<li>Make sure that you have followed <a href="..//Usage/Configuration/S/Steam.html#Installation" title="Steam">Steam#Installation</a>.</li>
<li>If the Steam client / a game is not starting and/or you have error message about a library, read <a href="#Steam_runtime">#Steam runtime</a> and see <a href="#Debugging_shared_libraries">#Debugging shared libraries</a>.</li>
<li>If the issue is related to networking, make sure that you have forwarded the <a rel="nofollow"  href="https://support.steampowered.com/kb_article.php?ref=8571-GLVN-8711">required ports for Steam</a>.</li>
<li>If the issue is about a game, consult <a href="..//Usage/Configuration/S/Steam/Game-specific_troubleshooting.html" title="Steam/Game-specific troubleshooting">Steam/Game-specific troubleshooting</a>.</li>
</ol>
<h3><span class="mw-headline" id="Relevant_online_resources">Relevant online resources</span></h3>
<ul>
<li><a rel="nofollow"  href="https://bbs.archlinux.org/viewforum.php?id=32">Multimedia and Games / TOS Linux Forums</a></li>
<li>
<a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux">ValveSoftware/steam-for-linux</a> – Issue tracking for the Steam for Linux client</li>
<li><a rel="nofollow"  href="https://steamcommunity.com/">Steam Community discussions of the game</a></li>
<li><a rel="nofollow"  href="https://help.steampowered.com/wiki/">Steam Support FAQ</a></li>
</ul>
<h2><span class="mw-headline" id="Steam_runtime">Steam runtime</span></h2>
<p>Steam for Linux ships with its own set of libraries called the <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-runtime">Steam runtime</a>. By default Steam launches all Steam Applications within the runtime environment.
The Steam runtime is located at <code>~/.steam/root/ubuntu12_32/steam-runtime/</code>.
</p>
<p>If you mix the Steam runtime libraries with system libraries you will run into binary incompatibility issues, see <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/4768">steam-for-linux-tosissue #4768</a>.
Binary incompatibility can lead to the Steam client and games not starting (manifesting as a crash, as hanging or silently returning), audio issues and various other problems.
</p>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=steam">steam</a></span> package offers three ways to launch Steam:
</p>
<ul>
<li>
<code>steam-runtime</code> (alias <code>steam</code>), which overrides runtime libraries known to cause problems via the <code>LD_PRELOAD</code> <a href="..//Usage/Configuration/E/Environment_variables.html" class="mw-redirect" title="Environment variable">environment variable</a> (see <span class="plainlinks archwiki-template-man" title="$ man 8 ld.so"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/ld.so.8">ld.so(8)</a></span>).</li>
<li>
<code>steam-native</code>, see <a href="#Steam_native_runtime">#Steam native runtime</a>
</li>
<li>
<code>/usr/lib/steam/steam</code>, the default Steam launch script</li>
</ul>
<p>As the Steam runtime libraries are older they can lack newer features, e.g. the OpenAL version of the Steam runtime lacks <a href="..//Usage/Configuration/G/Gaming.html#Binaural_Audio_with_OpenAL" title="Gaming">HRTF</a> and surround71 support.
</p>
<h3><span class="mw-headline" id="Steam_native_runtime">Steam native runtime</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Using the Steam native runtime is not recommended as it might break some games due to binary incompatibility and it might miss some libraries present in the Steam runtime.</div>
<p>The <code>steam-native</code> script launches Steam with the <code>STEAM_RUNTIME=0</code> environment variable making it ignore its runtime and only use system libraries.
</p>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=steam-native-runtime">steam-native-runtime</a></span> meta package depends on over 120 packages to pose a native replacement of the Steam runtime, some games may however still require additional packages. You can also use the Steam native runtime without <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=steam-native-runtime">steam-native-runtime</a></span> by manually installing just the packages you need. See <a href="#Finding_missing_runtime_libraries">#Finding missing runtime libraries</a>.
</p>
<h2><span class="mw-headline" id="Debugging_shared_libraries">Debugging shared libraries</span></h2>
<p>To see the shared libraries required by a program or a shared library run the <code>ldd</code> command on it, see <span class="plainlinks archwiki-template-man" title="$ man 1 ldd"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/ldd.1">ldd(1)</a></span>. The <code>LD_LIBRARY_PATH</code> and <code>LD_PRELOAD</code> <a href="..//Usage/Configuration/E/Environment_variables.html" title="Environment variables">environment variables</a> can alter which shared libraries are loaded, see <span class="plainlinks archwiki-template-man" title="$ man 8 ld.so"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/ld.so.8">ld.so(8)</a></span>. 
To correctly debug a program or shared library it is therefore important that these environment variables in your debug environment match the environment you wish to debug.
</p>
<p>If you figure out a missing library you can use <a href="..//Usage/Configuration/P/Pacman.html" title="Pacman">pacman</a> or <a href="..//Usage/Configuration/P/Pkgfile.html" title="Pkgfile">pkgfile</a> to search for packages that contain the missing library.
</p>
<h3><span class="mw-headline" id="Finding_missing_game_libraries">Finding missing game libraries</span></h3>
<p>If a game fails to start, a possible reason is that it is missing required libraries. You can find out what libraries it requests by running <code>ldd <i>game_executable</i></code>. <code><i>game_executable</i></code> is likely located somewhere in <code>~/.steam/root/steamapps/common/</code>. Please note that most of these "missing" libraries are actually already included with Steam, and do not need to be installed globally.
</p>
<h3><span class="mw-headline" id="Finding_missing_runtime_libraries">Finding missing runtime libraries</span></h3>
<p>If individual games or Steam itself is failing to launch when using <code>steam-native</code> you are probably missing libraries. To find the required libraries run:
</p>
<pre>$ cd ~/.steam/root/ubuntu12_32
$ file * | grep ELF | cut -d: -f1 | LD_LIBRARY_PATH=. xargs ldd | grep 'not found' | sort | uniq
</pre>
<p>Alternatively, run Steam with <code>steam-runtime</code> and use the following command to see which non-system libraries Steam is using (not all of these are part of the Steam runtime):
</p>
<pre>$ for i in $(pgrep steam); do sed '/\.local/!d;s/.*  //g' /proc/$i/maps; done | sort | uniq
</pre>
<h2><span class="mw-headline" id="Debugging_Steam">Debugging Steam</span></h2>
<p>The Steam launcher redirects its stdout and stderr to <code>/tmp/dumps/<i>USER</i>_stdout.txt</code>.
This means you do not have to run Steam from the command-line to see that output.
</p>
<p>It is possible to debug Steam to gain more information which could be useful to find out why something does not work.
</p>
<p>You can set <code>DEBUGGER</code> environment variable with one of <code>gdb</code>, <code>cgdb</code>, <code>valgrind</code>, <code>callgrind</code>, <code>strace</code> and then start <code>steam</code>.
</p>
<p>For example with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gdb">gdb</a></span>
</p>
<pre>$ DEBUGGER=gdb steam</pre>
<p><code>gdb</code> will open, then type <code>run</code> which will start <code>steam</code> and once crash happens you can type <code>backtrace</code> to see call stack.
</p>
<h2><span class="mw-headline" id="Runtime_issues">Runtime issues</span></h2>
<h3><span class="mw-headline" id="Segmentation_fault_when_disabling_runtime">Segmentation fault when disabling runtime</span></h3>
<dl><dd><a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3863">steam-for-linux-tosissue #3863</a></dd></dl>
<p>As per the bug report above, Steam crashes with the following error message when run with <code>STEAM_RUNTIME=0</code>:
</p>
<pre>/home/<i>USER</i>/.local/share/Steam/steam.sh: line 756: &lt;variable numeric code&gt; Segmentation fault (core dumped)
</pre>
<p>This happens because <code>steamclient.so</code> is linked to <code>libudev.so.0</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-libudev0/">lib32-libudev0</a></span><sup><small>AUR</small></sup><sup>[<a href="..//Usage/Configuration/H/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup>) which conflicts with <code>libudev.so.1</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-systemd">lib32-systemd</a></span>).
</p>
<p>A proposed workaround is to copy Steam's packaged 32-bit versions of libusb and libgudev to <code>/usr/lib32</code>:
</p>
<pre># cp ~/.steam/root/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libgudev* /usr/lib32
# cp ~/.steam/root/ubuntu12_32/steam-runtime/i386/lib/i386-linux-gnu/libusb* /usr/lib32
</pre>
<p>Notice that the workaround is necessary because the bug affects systems with lib32-libgudev and lib32-libusb installed.
</p>
<p>Alternatively it has been successful to prioritize the loading of the libudev.so.1 (see <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3863#issuecomment-203929113">comment on the same issue</a>):
</p>
<pre>$ LD_PRELOAD=/usr/lib32/libudev.so.1 STEAM_RUNTIME=0 steam</pre>
<h3>
<span id=".27GLBCXX_3.X.XX.27_not_found_when_using_Bumblebee"></span><span class="mw-headline" id="'GLBCXX_3.X.XX'_not_found_when_using_Bumblebee">'GLBCXX_3.X.XX' not found when using Bumblebee</span>
</h3>
<p>This error is likely caused because Steam packages its own out of date <code>libstdc++.so.6</code>. See <a href="#Finding_missing_runtime_libraries">#Finding missing runtime libraries</a> about working around the bad library. See also <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3773">steam-for-linux-tosissue 3773</a>.
</p>
<h3><span class="mw-headline" id="Game_crashes_immediately">Game crashes immediately</span></h3>
<p>This is likely due to <a href="#Steam_runtime">#Steam runtime</a> issues, see <a href="#Debugging_shared_libraries">#Debugging shared libraries</a>.
</p>
<p>Disabling the in-game Steam Overlay in the game properties might help.
</p>
<p>And finally, if those don't work, you should check Steam's output for any error from the game. You may encounter the following:
</p>
<ul>
<li><code>munmap_chunk(): invalid pointer</code></li>
<li><code>free(): invalid pointer</code></li>
</ul>
<p>In these cases, try replacing the <code>libsteam_api.so</code> file from the problematic game with one of a game that works. This error usually happens for games that were not updated recently when Steam runtime is disabled. This error has been encountered with AYIM, Bastion and Monaco.
</p>
<h3><span class="mw-headline" id="Game_and_Steam_crashes_after_game_start">Game and Steam crashes after game start</span></h3>
<p>If the following error is output:
</p>
<pre>failed to dlopen engine.so error=/home/<i>GAMEPATH</i>/bin/libgcc_s.so.1: version `GCC_7.0.0' not found (required by /usr/lib32/libopenal.so.1)
</pre>
<p>moving the incompatible lib can be a workaround.
</p>
<pre>mv .local/share/Steam/steamapps/common/<i>GAME</i>/bin/libgcc_s.so.1 .local/share/Steam/steamapps/common/<i>GAME</i>/bin/libgcc_s.so.1.b
</pre>
<h3>
<span id="Version_.60CURL_OPENSSL_3.60_not_found"></span><span class="mw-headline" id="Version_`CURL_OPENSSL_3`_not_found">Version `CURL_OPENSSL_3` not found</span>
</h3>
<p>This is because <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=curl">curl</a></span> alone is not compatible with previous versions. You need to install the compatibility libraries:
</p>
<p>One of the following messages may show up:
</p>
<pre># Nuclear Throne
./nuclearthrone: /usr/lib32/libcurl.so.4: version `CURL_OPENSSL_3' not found (required by ./nuclearthrone)

# Devil Daggers
./devildaggers: /usr/lib/libcurl.so.4: version `CURL_OPENSSL_3' not found (required by ./devildaggers)
</pre>
<p>You need to install either <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libcurl-compat">libcurl-compat</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libcurl-compat">lib32-libcurl-compat</a></span> and link the compatibility library manually:
</p>
<pre># Nuclear Throne
$ ln -s /usr/lib32/libcurl-compat.so.4.4.0 "<i>LIBRARY</i>/steamapps/common/Nuclear Throne/lib/libcurl.so.4"

# Devil Daggers
$ ln -s /usr/lib/libcurl-compat.so.4.4.0 <i>LIBRARY</i>/steamapps/common/devildaggers/lib64/libcurl.so.4
</pre>
<h3>
<span id="Steam_webview.2Fgame_browser_not_working_in_native_runtime_.28Black_screen.29"></span><span class="mw-headline" id="Steam_webview/game_browser_not_working_in_native_runtime_(Black_screen)">Steam webview/game browser not working in native runtime (Black screen)</span>
</h3>
<p>Since the new Steam Friends UI update, the client webview isn't working correctly with the native-runtime.
</p>
<pre>./steamwebhelper: error while loading shared libraries: libpcre.so.3: cannot open shared object file: No such file or directory
</pre>
<p>It can be solved preloading glib libraries; Those don't require libpcre and selinux-tosto work.
</p>
<pre>$ LD_PRELOAD="/usr/lib/libgio-2.0.so.0 /usr/lib/libglib-2.0.so.0" steam-native
</pre>
<p>Alternatively, you may create a symbolic link to the native TOS libpcre library.
</p>
<pre># ln -s /usr/lib/libpcre.so /usr/lib64/libpcre.so.3
</pre>
<h3><span class="mw-headline" id="Steam:_An_X_Error_occurred">Steam: An X Error occurred</span></h3>
<p>When using an NVidia GPU and proprietary drivers, Steam may fail to start and (if run from the terminal) produce errors of the form:
</p>
<pre>Steam: An X Error occurred
X Error of failed request:  GLXBadContext
Major opcode of failed request:  151
Serial number of failed request:  51
xerror_handler: X failed, continuing
</pre>
<p>Install the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-nvidia-utils">lib32-nvidia-utils</a></span> (or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/lib32-nvidia-390xx-utils/">lib32-nvidia-390xx-utils</a></span><sup><small>AUR</small></sup> if using an old GPU).
</p>
<h2><span class="mw-headline" id="Audio_issues">Audio issues</span></h2>
<p>If the sections below do not address the issue, using the <a href="#Steam_native_runtime">#Steam native runtime</a> might help.
</p>
<h3><span class="mw-headline" id="Configure_PulseAudio">Configure PulseAudio</span></h3>
<p>Games that explicitly depend on ALSA can break PulseAudio. Follow the directions for <a href="..//Usage/Configuration/P/PulseAudio.html#ALSA" title="PulseAudio">PulseAudio#ALSA</a> to make these games use PulseAudio instead.
</p>
<h3><span class="mw-headline" id="No_audio_or_756_Segmentation_fault">No audio or 756 Segmentation fault</span></h3>
<p>First <a href="#Configure_PulseAudio">#Configure PulseAudio</a> and see if that resolves the issue. If you do not have audio in the videos which play within the Steam client, it is possible that the ALSA libraries packaged with Steam are not working.
</p>
<p>Attempting to playback a video within the steam client results in an error similar to:
</p>
<pre>ALSA lib pcm_dmix.c:1018:(snd_pcm_dmix_open) unable to open slave
</pre>
<p>A workaround is to rename or delete the <code>alsa-lib</code> folder and the <code>libasound.so.*</code> files. They can be found at:
</p>
<pre>~/.steam/steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/
</pre>
<p>An alternative workaround is to add the <code>libasound.so.*</code> library to the <code>LD_PRELOAD</code> environment variable:
</p>
<pre>LD_PRELOAD='/usr/$LIB/libasound.so.2 '${LD_PRELOAD} steam
</pre>
<p>If audio still won't work, adding the Pulseaudio-libs to the <code>LD_PRELOAD</code> variable may help:
</p>
<pre>LD_PRELOAD='/usr/$LIB/libpulse.so.0 /usr/$LIB/libpulse-simple.so.0 '${LD_PRELOAD}
</pre>
<p>Be advised that their names may change over time. If so, it is necessary to take a look in 
</p>
<pre>~/.steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu
</pre>
<p>and find the new libraries and their versions.
</p>
<p>Bugs reports have been filed: <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3376">#3376</a> and <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3504">#3504</a>
</p>
<h3><span class="mw-headline" id="FMOD_sound_engine">FMOD sound engine</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> No source / bug report. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Steam/Troubleshooting">Talk:Steam/Troubleshooting#</a>)</div>
</div>
<p>The <a rel="nofollow"  href="https://www.fmod.com/">FMOD</a> audio middleware package is a bit buggy, and as a result games using it may have sound problems.
</p>
<p>It usually occurs when an unused sound device is used as default for ALSA. See <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html#Set_the_default_sound_card" title="Advanced Linux Sound TOSitecture">Advanced Linux Sound TOSitecture#Set the default sound card</a>.
</p>
<dl><dd>Affected games: Hotline Miami, Hotline Miami 2, Transistor</dd></dl>
<h3>
<span id="PulseAudio_.26_OpenAL:_Audio_streams_can.27t_be_moved_between_devices"></span><span class="mw-headline" id="PulseAudio_&amp;_OpenAL:_Audio_streams_can't_be_moved_between_devices">PulseAudio &amp; OpenAL: Audio streams can't be moved between devices</span>
</h3>
<p>If you use <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> and cannot move an audio stream between sinks, it might be because recent OpenAL versions default to disallow audio streams from being moved. Try to add the following to your <code>~/.alsoftrc</code>:
</p>
<pre>[pulse]
allow-moves=true
</pre>
<h2><span class="mw-headline" id="Steam_client_issues">Steam client issues</span></h2>
<h3><span class="mw-headline" id="Cannot_add_library_folder_because_of_missing_execute_permissions">Cannot add library folder because of missing execute permissions</span></h3>
<p>If you add another Steam library folder on another drive, you might get the error message:
</p>
<pre>New Steam library folder must be on a filesystem mounted with execute permissions
</pre>
<p>Make sure you are mounting the filesystem with the correct flags in your <code>/etc/fstab</code>, usually by adding <code>exec</code> to the list of mount parameter. The parameter must occur after any <code>user</code> or <code>users</code> parameter since these can imply <code>noexec</code>.
</p>
<p>This error might also occur if your library folder does not contain a <code>steamapps</code> directory. Previous versions used <code>SteamApps</code> instead, so ensure the name is fully lowercase.
</p>
<p>This error can also occur because of Steam runtime issues and may be fixed following the <a href="#Finding_missing_runtime_libraries">#Finding missing runtime libraries</a> section or due to no space being left on the device. For debugging purposes it might be useful to run Steam from the console and observe the log.
</p>
<h3><span class="mw-headline" id="Unusually_slow_download_speed">Unusually slow download speed</span></h3>
<p>If your Steam apps (games, software…) download speed through the client is unusually slow, but browsing the Steam store and streaming videos is unaffected, installing a DNS cache program, such as <a href="..//Usage/Configuration/D/Dnsmasq.html" title="Dnsmasq">dnsmasq</a> can help <a rel="nofollow"  href="https://steamcommunity.com/app/221410/discussions/2/616189106498372437/">[1]</a>.
</p>
<p>Something else that might help would be disabling <a href="..//Usage/Configuration/I/IPv6.html" title="IPv6">IPv6</a><a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/6126">[2]</a>.
</p>
<h3>
<span id=".22Needs_to_be_online.22_error"></span><span class="mw-headline" id='"Needs_to_be_online"_error'>"Needs to be online" error</span>
</h3>
<p>If the Steam launcher refuses to start and you get an error saying: "<i>Fatal Error: Steam needs to be online to update</i>" while you are online, then there might be issues with name resolving.  
</p>
<p>Try to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libcurl-compat">lib32-libcurl-compat</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nss-mdns">nss-mdns</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-nss">lib32-nss</a></span>.
</p>
<p>This may also be as simple as DNS resolution not correctly working and is not always obvious since modern browsers will user their own DNS servers.  A possible fix if you didn't follow all the directions from the resolved wiki article.  Make sure /run/systemd/resolve/resolv.conf contains name servers as expected:
</p>
<pre>cat /run/systemd/resolve/resolv.conf
</pre>
<p>Create the symbolic link (the -f option will force overwrite any current file):
</p>
<pre>ln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf
</pre>
<h3><span class="mw-headline" id="Steam_forgets_password">Steam forgets password</span></h3>
<dl><dd>Related: <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/5030">steam-for-linux#5030</a>
</dd></dl>
<p>Steam for Linux has a bug which causes it to forget the password of some users.
</p>
<p>As a workaround, after logging in to Steam, run
</p>
<pre>$ chmod -w ~/.steam/registry.vdf
</pre>
<p>This will make the file read-only so Steam cannot modify it, and thus not log you out.
</p>
<h3><span class="mw-headline" id="Preventing_crash_memory_dumps">Preventing crash memory dumps</span></h3>
<p>Every time Steam crashes, it writes a memory dump to <code>/tmp/dumps/</code>. If Steam falls into a crash loop, the dump files can become quite large. When <code>/tmp</code> is mounted as <a href="..//Usage/Configuration/T/Tmpfs.html" title="Tmpfs">tmpfs</a>, memory and swap file can be consumed needlessly.
</p>
<p>To prevent this, link <code>/tmp/dumps/</code> to <code>/dev/null</code>:
</p>
<pre># ln -s /dev/null /tmp/dumps
</pre>
<p>Or alternatively, create and modify permissions on <code>/tmp/dumps</code>. Then Steam will be unable to write dump files to the directory.
</p>
<pre># mkdir /tmp/dumps
# chmod 600 /tmp/dumps
</pre>
<p>This also has the added benefit of Steam not uploading these dumps to Valve's servers.
</p>
<h3><span class="mw-headline" id="Steam_license_problem_with_playing_videos">Steam license problem with playing videos</span></h3>
<p>Steam uses <a href="https://en.wikipedia.org/wiki/Widevine"  title="w:Widevine">Google's Widevine DRM</a> for some videos. If it is not installed you will get the following error:
</p>
<pre>This video requires a license to play which cannot be retrieved. This may be a temporary network condition. Please restart the video to try again.
</pre>
<p>To solve this issue follow the <a rel="nofollow"  href="https://support.steampowered.com/kb_article.php?ref=8699-OASD-1871#15"><i>Streaming Videos on Steam</i> support page</a>.
</p>
<h3>
<span id="No_context_menu_for_joining.2Finviting_friends"></span><span class="mw-headline" id="No_context_menu_for_joining/inviting_friends">No context menu for joining/inviting friends</span>
</h3>
<p>Since the new Steam Friends UI update, it may be the case that in the right-click menu the entries for "Join Game", "Invite to Game" and "View Game  Info" are missing.
</p>
<p>In order to fix this, it maybe be necessary to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lsof">lsof</a></span>.
</p>
<h3><span class="mw-headline" id="Slow_and_unresponsive_user_interface">Slow and unresponsive user interface</span></h3>
<p>If you experience extremely slow and sluggish performance when using the Steam client it might help to disable the option "Enable GPU accelerated rendering in web views" under the "Interface" tab in the Steam client settings.
</p>
<h3><span class="mw-headline" id="Steam_fails_to_start_correctly">Steam fails to start correctly</span></h3>
<p>One troubleshooting step  is to run 
</p>
<pre># steam-runtime --reset
</pre>
<p>This can fix various issues that come with a broken install.
</p>
<h2><span class="mw-headline" id="Steam_Remote_Play_issues">Steam Remote Play issues</span></h2>
<p>See <a href="..//Usage/Configuration/S/Steam.html#Steam_Remote_Play" title="Steam">Steam#Steam Remote Play</a>.
</p>
<h3><span class="mw-headline" id="Remote_Play_does_not_work_from_TOS_Linux_host_to_TOS_Linux_guest">Remote Play does not work from TOS Linux host to TOS Linux guest</span></h3>
<p>Chances are you are missing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libcanberra">lib32-libcanberra</a></span>. Once you <a href="..//Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> that, it should work as expected.
</p>
<p>With that, Steam should no longer crash when trying to launch a game through Remote Play.
</p>
<h3><span class="mw-headline" id="Hardware_decoding_not_available">Hardware decoding not available</span></h3>
<p>Remote Play hardware decoding uses <code>vaapi</code>, but steam requires <code>libva2_32bit</code>, where as TOS defaults to 64bit.
</p>
<p>As a basic set, this is <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libva">libva</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libva">lib32-libva</a></span>. Intel graphics users will also require both <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=libva-intel-driver">libva-intel-driver</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lib32-libva-intel-driver">lib32-libva-intel-driver</a></span>. 
</p>
<p>For more information about vaapi see <a href="..//Usage/Configuration/H/Hardware_video_acceleration.html" title="Hardware video acceleration">hardware video acceleration</a>.
</p>
<p>It may also be necessary to remove the steam runtime version of libva, in order to force it to use system libraries. The current library in use can be found by using:
</p>
<pre>pgrep steam | xargs -I {} cat /proc/{}/maps | grep libva
</pre>
<p>If this shows locations in <code>~/.local/Share/steam</code> steam is still using it's packaged version of libva. This can be rectified by deleting the libva library files at <code>~/.local/share/Steam/ubuntu12_32/steam-runtime/i386/usr/lib/i386-linux-gnu/libva*</code>, so that steam falls back to the system libraries.
</p>
<h3><span class="mw-headline" id="Big_Picture_Mode_minimizes_itself_after_losing_focus">Big Picture Mode minimizes itself after losing focus</span></h3>
<p>This can occur when you play a game via Remote Play or if you have a multi-monitor setup and move the mouse outside of BPM's window. To prevent this, set the following environment variable and restart Steam
</p>
<pre>export SDL_VIDEO_MINIMIZE_ON_FOCUS_LOSS=0
</pre>
<p>See also the <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/4769">steam-for-linux-tosissue 4769</a>.
</p>
<h2><span class="mw-headline" id="Other_issues">Other issues</span></h2>
<h3><span class="mw-headline" id="Steam_Library_in_NTFS_partition">Steam Library in NTFS partition</span></h3>
<p>If your Steam library resides in NTFS partition it is probable that games residing there could not start.
</p>
<p>The trouble is that Wine uses a colon in it's $WINE_PREFIX/dosdevices folder, and NTFS seems to have trouble supporting this.
</p>
<p>Workaround: move the 'steamapps/common/Proton 3.7' and 'steamapps/compatdata' to a non-NTFS drive, then create symbolic link in their original locations.
</p>
<pre>$ mv SteamLibrary/steamapps/common/Proton\ 3.7 /home/user/dir/
$ mv SteamLibrary/steamapps/compatdata /home/user/dir/
$ ln -s /home/user/dir/Proton\ 3.7/ SteamLibrary/steamapps/common/Proton\ 3.7
$ ln -s /home/user/dir/compatdata/ SteamLibrary/steamapps/common/compatdata
</pre>
<h3><span class="mw-headline" id="Wrong_ELF_class">Wrong ELF class</span></h3>
<p>If you see this message in Steam's console output
</p>
<pre>ERROR: ld.so: object '~/.local/share/Steam/ubuntu12_32/gameoverlayrenderer.so' from LD_PRELOAD cannot be preloaded (wrong ELF class: ELFCLASS32): ignored.
</pre>
<p>you can safely ignore it. It is not really any error: Steam includes both 64- and 32-bit versions of some libraries and only one version will load successfully. This "error" is displayed even when Steam (and the in-game overlay) is working perfectly.
</p>
<h3><span class="mw-headline" id="Multiple_monitors_setup">Multiple monitors setup</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Is this Nvidia-only? Can this be reproduced by anyone? Is there an upstream report? (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Steam/Troubleshooting">Talk:Steam/Troubleshooting#</a>)</div>
</div>
<p>A setup with multiple monitors may prevent games from starting. Try to disable all additional displays, and then run a game. You can enable them after the game successfully started. 
</p>
<p>Also you can try running Steam with this environment variable set:
</p>
<pre>export LD_LIBRARY_PATH=/usr/lib32/nvidia:/usr/lib/nvidia:$LD_LIBRARY_PATH
</pre>
<h3><span class="mw-headline" id="Text_is_corrupt_or_missing">Text is corrupt or missing</span></h3>
<p>The Steam Support <a rel="nofollow"  href="https://support.steampowered.com/kb_article.php?ref=1974-YFKL-4947">instructions</a> for Windows seem to work on Linux also.
</p>
<p>You can install them via the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/steam-fonts/">steam-fonts</a></span><sup><small>AUR</small></sup> package, or manually by downloading and <a href="..//Usage/Configuration/F/Fonts.html#Manual_installation" title="Fonts">installing</a> <a rel="nofollow"  href="https://support.steampowered.com/downloads/1974-YFKL-4947/SteamFonts.zip">SteamFonts.zip</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> When steam cannot find the Arial fonts, font-config likes to fall back onto the Helveticia bitmap font. Steam does not render this and possibly other bitmap fonts correctly, so either removing problem fonts or <a href="..//Usage/Configuration/F/Font_configuration.html#Disable_bitmap_fonts" title="Font configuration">disabling bitmap fonts</a> will most likely fix the issue without installing the Arial or ArialBold fonts.
The font being used in place of Arial can be found with the command <pre>$ fc-match -v Arial</pre>
</div>
<h3>
<span id="SetLocale.28.27en_US.UTF-8.27.29_fails_at_game_startup_or_typing_non-ASCII_characters_does_not_work_in_the_Steam_client"></span><span class="mw-headline" id="SetLocale('en_US.UTF-8')_fails_at_game_startup_or_typing_non-ASCII_characters_does_not_work_in_the_Steam_client">SetLocale('en_US.UTF-8') fails at game startup or typing non-ASCII characters does not work in the Steam client</span>
</h3>
<p>You need to generate the <code>en_US.UTF-8 UTF-8</code> locale. See <a href="..//Usage/Configuration/L/Locale.html#Generating_locales" title="Locale">Locale#Generating locales</a>.
</p>
<h3><span class="mw-headline" id="Missing_libc">Missing libc</span></h3>
<p>This could be due to a corrupt Steam executable. Check the output of:
</p>
<pre>$ ldd ~/.local/share/Steam/ubuntu12_32/steam
</pre>
<p>Should <code>ldd</code> claim that it is not a dynamic executable, then Steam likely corrupted the binary during an update. The following should fix the issue:
</p>
<pre>$ cd ~/.local/share/Steam/
$ ./steam.sh --reset
</pre>
<p>If it doesn't, try to delete the <code>~/.local/share/Steam/</code> directory and launch Steam again, telling it to reinstall itself.
</p>
<p>This error message can also occur due to a bug in Steam which occurs when your <code>$HOME</code> directory ends in a slash (Valve GitHub <a rel="nofollow"  href="https://github.com/ValveSoftware/steam-for-linux/issues/3730">issue 3730</a>). This can be fixed by editing <code>/etc/passwd</code> and changing <code>/home/&lt;username&gt;/</code> to <code>home/&lt;username&gt;</code>, then logging out and in again. Afterwards, Steam should repair itself automatically.
</p>
<h3><span class="mw-headline" id="Games_do_not_launch_on_older_Intel_hardware">Games do not launch on older Intel hardware</span></h3>
<dl><dd><a rel="nofollow"  href="https://steamcommunity.com/app/8930/discussions/1/540744299927655197/">source</a></dd></dl>
<p>On older Intel hardware which doesn't support OpenGL 3, such as Intel GMA chips or Westmere CPUs, games may immediately crash when run. It appears as a <code>gameoverlayrenderer.so</code> error in <code>/tmp/dumps/mobile_stdout.txt</code>, but looking in <code>/tmp/gameoverlayrenderer.log</code> it shows a GLXBadFBConfig error. 
</p>
<p>This can be fixed, by forcing the game to use a later version of OpenGL than it wants.
Add <code>MESA_GL_VERSION_OVERRIDE=3.1 MESA_GLSL_VERSION_OVERRIDE=140</code> to your <a href="..//Usage/Configuration/S/Steam.html#Launch_options" class="mw-redirect" title="Launch option">launch options</a>.
</p>
<h3>
<span id="Mesa:_Game_does_not_launch.2C_complaining_about_OpenGL_version_supported_by_the_card"></span><span class="mw-headline" id="Mesa:_Game_does_not_launch,_complaining_about_OpenGL_version_supported_by_the_card">Mesa: Game does not launch, complaining about OpenGL version supported by the card</span>
</h3>
<p>Some games are badly programmed, to use any OpenGL version above 3.0.
With Mesa, an application has to request a specific core profile.
If it doesn't make such a request, only OpenGL 3.0 and lower are available.
</p>
<p>This can be fixed, by forcing the game to use a version of OpenGL it actually needs.
Add <code>MESA_GL_VERSION_OVERRIDE=4.1 MESA_GLSL_VERSION_OVERRIDE=410</code> to your <a href="..//Usage/Configuration/S/Steam.html#Launch_options" class="mw-redirect" title="Launch option">launch options</a>.
</p>
<h3><span class="mw-headline" id="2K_games_do_not_run_on_XFS_partitions">2K games do not run on XFS partitions</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Seems to be a general issue, e.g. <a rel="nofollow"  href="https://github.com/ValveSoftware/Source-1-Games/issues/1685">[3]</a> (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Steam/Troubleshooting">Talk:Steam/Troubleshooting#</a>)</div>
</div>
<p>If you are running 2K games such as Civilization 5 on <a href="..//Usage/Configuration/X/XFS.html" title="XFS">XFS</a> partitions, then the game may not start or run properly due to how the game loads files as it starts.
<a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=185222">[4]</a>
</p>
<h3><span class="mw-headline" id="Steam_controller_not_being_detected_correctly">Steam controller not being detected correctly</span></h3>
<p>See <a href="..//Usage/Configuration/G/Gamepad.html#Steam_Controller" title="Gamepad">Gamepad#Steam Controller</a>.
</p>
<h3><span class="mw-headline" id="Steam_controller_makes_a_game_crash">Steam controller makes a game crash</span></h3>
<p>See <a href="..//Usage/Configuration/G/Gamepad.html#Steam_Controller_makes_a_game_crash_or_not_recognized" title="Gamepad">Gamepad#Steam Controller makes a game crash or not recognized</a>.
</p>
<h3>
<span id="Steam_hangs_on_.22Installing_breakpad_exception_handler....22"></span><span class="mw-headline" id='Steam_hangs_on_"Installing_breakpad_exception_handler..."'>Steam hangs on "Installing breakpad exception handler..."</span>
</h3>
<p><a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=177245">BBS#177245</a>
</p>
<p>You have an Nvidia GPU and Steam has the following output:
</p>
<pre>Running Steam on arch rolling 64-bit
STEAM_RUNTIME is enabled automatically
Installing breakpad exception handler for appid(steam)/version(0_client)
</pre>
<p>Then nothing else happens. Ensure you have the correct drivers installed as well as their 32-bit versions (the 64-bit and 32-bit variants have to have the same versions): see <a href="..//Usage/Configuration/N/NVIDIA.html#Installation" title="NVIDIA">NVIDIA#Installation</a>.
</p>
<h3><span class="mw-headline" id="Killing_standalone_compositors_when_launching_games">Killing standalone compositors when launching games</span></h3>
<p>Further to this, utilising the <code>%command%</code> switch, you can kill standalone compositors (such as Xcompmgr or <a href="..//Usage/Configuration/P/Picom.html" class="mw-redirect" title="Compton">Compton</a>) - which can cause lag and tearing in some games on some systems - and relaunch them after the game ends by adding the following to your game's launch options.
</p>
<pre> killall compton &amp;&amp; %command%; compton -b &amp;
</pre>
<p>Replace <code>compton</code> in the above command with whatever your compositor is. You can also add -options to <code>%command%</code> or <code>compton</code>, of course.
</p>
<p>Steam will latch on to any processes launched after <code>%command%</code> and your Steam status will show as in game. So in this example, we run the compositor through <code>nohup</code> so it is not attached to Steam (it will keep running if you close Steam) and follow it with an ampersand so that the line of commands ends, clearing your Steam status.
</p>
<h3><span class="mw-headline" id="Symbol_lookup_error_using_DRI3">Symbol lookup error using DRI3</span></h3>
<p>Steam outputs this error and exits.
</p>
<pre> symbol lookup error: /usr/lib/libxcb-dri3.so.0: undefined symbol: xcb_send_request_with_fds
</pre>
<p>To work around this, run Steam with <code>LIBGL_DRI3_DISABLE=1</code>, disabling DRI3 for Steam.
</p>
<h3><span class="mw-headline" id="Launching_games_on_Nvidia_optimus_laptops">Launching games on Nvidia optimus laptops</span></h3>
<p>To be able to play games which require using Nvidia GPU (for example, Hitman 2016) on optimus enabled laptop, you should start game with <i>primusrun</i> prefix in launch options. Otherwise, game will not work.
</p>
<p>Find the game in steam library, right click -&gt; Properties -&gt; SET LAUNCH OPTIONS. Change options to
</p>
<p><code>primusrun %command%</code>
</p>
<p>Running steam with primusrum used to work. While steam has changed some behavior that now running steam with primusrun would not have effect on launching games. As a result, you need to set launch options for each game (and you do NOT have to run steam with primusrun).
</p>
<p>For primusrun, VSYNC is enabled by default it could result in a mouse input delay lag, slightly decrease performance and in-game FPS might be locked to a refresh rate of a monitor/display.
In order to disable VSYNC for primusrun default value of option vblank_mode needs to be overridden by environment variable.
</p>
<p><code>vblank_mode=0 primusrun %command%</code>
</p>
<p>Same with optirun that uses primus as a bridge. 
</p>
<p><code>vblank_mode=0 optirun -b primus %command%</code>
</p>
<p>If that did not work try:
</p>
<p><code>LD_PRELOAD="libpthread.so.0 libGL.so.1" __GL_THREADED_OPTIMIZATIONS=1 optirun %command%</code>
</p>
<p>For more details see <a href="..//Usage/Configuration/B/Bumblebee.html#Primusrun_mouse_delay_(disable_VSYNC)" title="Bumblebee">Bumblebee#Primusrun mouse delay (disable VSYNC)</a>.
</p>
<h3><span class="mw-headline" id="HiDPI">HiDPI</span></h3>
<p><a href="..//Usage/Configuration/H/HiDPI.html" title="HiDPI">HiDPI</a> support should work out of the box, although on some systems it is necessary to <a href="..//Usage/Configuration/H/HiDPI.html#Steam" title="HiDPI">force it</a> setting the <code>GDK_SCALE=</code> environment variable to set the desired scale factor.
</p>
<h3><span class="mw-headline" id="Protocol_support_under_KDE_Plasma">Protocol support under KDE Plasma</span></h3>
<p>If you are getting an error after running a game through web browser <i>(or executing the link through xdg-open)</i>
</p>
<pre> Error — KIOExec 
 File not found: steam://run/440
</pre>
<p>Go to <b>System Settings -&gt; Applications -&gt; File Associations</b>, add new, select <code>inode</code> group and name it <code>vnd.kde.service.steam</code>, then under <b>Application Preference Order</b> you have to add Steam. Apply changes, It should be working now.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Gaming.html" title="Category:Gaming">Gaming</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="..//Usage/Configuration/C/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Steam/Troubleshooting&amp;oldid=614378">https://wiki.archlinux.org/index.php?title=Steam/Troubleshooting&amp;oldid=614378</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 19 May 2020, at 11:37.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">NVIDIA/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/N/NVIDIA.html" title="NVIDIA">NVIDIA</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Corrupted_screen:_%22Six_screens%22_Problem"><span >1</span> <span >Corrupted screen: "Six screens" Problem</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#'/dev/nvidia0'_input/output_error"><span >2</span> <span >'/dev/nvidia0' input/output error</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Crashing_in_general"><span >3</span> <span >Crashing in general</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Bad_performance_after_installing_a_new_driver_version"><span >4</span> <span >Bad performance after installing a new driver version</span></a></li>
<li class="toclevel-1 tocsection-5">
<a href="#Avoid_screen_tearing"><span >5</span> <span >Avoid screen tearing</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Multi-monitor"><span >5.1</span> <span >Multi-monitor</span></a></li>
<li class="toclevel-2 tocsection-7">
<a href="#Avoid_screen_tearing_in_KDE_(KWin)"><span >5.2</span> <span >Avoid screen tearing in KDE (KWin)</span></a>
<ul>
<li class="toclevel-3 tocsection-8">
<a href="#Legacy_solutions"><span >5.2.1</span> <span >Legacy solutions</span></a>
<ul>
<li class="toclevel-4 tocsection-9"><a href="#1._GL_threads"><span >5.2.1.1</span> <span >1. GL threads</span></a></li>
<li class="toclevel-4 tocsection-10"><a href="#2._Use_TripleBuffering"><span >5.2.1.2</span> <span >2. Use TripleBuffering</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11"><a href="#Modprobe_Error:_%22Could_not_insert_'nvidia':_No_such_device%22_on_linux_&gt;=4.8"><span >6</span> <span >Modprobe Error: "Could not insert 'nvidia': No such device" on linux-tos&gt;=4.8</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#Poor_performance_after_resuming_from_suspend"><span >7</span> <span >Poor performance after resuming from suspend</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#CPU_spikes_with_400_series_cards"><span >8</span> <span >CPU spikes with 400 series cards</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Full_system_freeze_or_crashes_when_using_Flash"><span >9</span> <span >Full system freeze or crashes when using Flash</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#Laptops:_X_hangs_on_login/out,_worked_around_with_Ctrl+Alt+Backspace"><span >10</span> <span >Laptops: X hangs on login/out, worked around with Ctrl+Alt+Backspace</span></a></li>
<li class="toclevel-1 tocsection-16"><a href="#Screen(s)_found,_but_none_have_a_usable_configuration"><span >11</span> <span >Screen(s) found, but none have a usable configuration</span></a></li>
<li class="toclevel-1 tocsection-17"><a href="#Blackscreen_at_X_startup_/_Machine_poweroff_at_X_shutdown"><span >12</span> <span >Blackscreen at X startup / Machine poweroff at X shutdown</span></a></li>
<li class="toclevel-1 tocsection-18">
<a href="#Backlight_is_not_turning_off_in_some_occasions"><span >13</span> <span >Backlight is not turning off in some occasions</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Driver_415:_HardDPMS"><span >13.1</span> <span >Driver 415: HardDPMS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20"><a href="#Xorg_fails_to_load_or_Red_Screen_of_Death"><span >14</span> <span >Xorg fails to load or Red Screen of Death</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Black_screen_on_systems_with_Intel_integrated_GPU"><span >15</span> <span >Black screen on systems with Intel integrated GPU</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#No_audio_over_HDMI"><span >16</span> <span >No audio over HDMI</span></a></li>
<li class="toclevel-1 tocsection-23"><a href="#Black_screen_on_systems_with_VIA_integrated_GPU"><span >17</span> <span >Black screen on systems with VIA integrated GPU</span></a></li>
<li class="toclevel-1 tocsection-24"><a href="#X_fails_with_%22no_screens_found%22_when_using_Multiple_GPUs"><span >18</span> <span >X fails with "no screens found" when using Multiple GPUs</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#Xorg_fails_during_boot,_but_otherwise_starts_fine"><span >19</span> <span >Xorg fails during boot, but otherwise starts fine</span></a></li>
<li class="toclevel-1 tocsection-26"><a href="#xrandr_BadMatch"><span >20</span> <span >xrandr BadMatch</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#Override_EDID"><span >21</span> <span >Override EDID</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#Overclocking_with_nvidia-settings_GUI_not_working"><span >22</span> <span >Overclocking with nvidia-settings GUI not working</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Overclocking_not_working_with_Unknown_Error"><span >23</span> <span >Overclocking not working with Unknown Error</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#System_will_not_boot_after_driver_was_installed"><span >24</span> <span >System will not boot after driver was installed</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#X_fails_with_%22Failing_initialization_of_X_screen%22"><span >25</span> <span >X fails with "Failing initialization of X screen"</span></a></li>
<li class="toclevel-1 tocsection-32"><a href="#System_does_not_return_from_suspend"><span >26</span> <span >System does not return from suspend</span></a></li>
</ul>
</div>

<h2>
<span id="Corrupted_screen:_.22Six_screens.22_Problem"></span><span class="mw-headline" id='Corrupted_screen:_"Six_screens"_Problem'>Corrupted screen: "Six screens" Problem</span>
</h2>
<p>For some users, using GeForce GT 100M's, the screen gets corrupted after X starts, divided into 6 sections with a resolution limited to 640x480.
The same problem has been recently reported with Quadro 2000 and hi-res displays.
</p>
<p>To solve this problem, enable the Validation Mode <code>NoTotalSizeCheck</code> in section <code>Device</code>:
</p>
<pre>Section "Device"
 ...
 Option "ModeValidation" "NoTotalSizeCheck"
 ...
EndSection
</pre>
<h2>
<span id=".27.2Fdev.2Fnvidia0.27_input.2Foutput_error"></span><span class="mw-headline" id="'/dev/nvidia0'_input/output_error">'/dev/nvidia0' input/output error</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../../File:Tango-inaccurate.png" ><img alt="Tango-inaccurate.png" src="../../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Verify that the BIOS related suggestions work and are not coincidentally set while troubleshooting. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:NVIDIA/Troubleshooting#'/dev/nvidia0'_Input/Output_error..._suggested_fixes">Talk:NVIDIA/Troubleshooting#'/dev/nvidia0' Input/Output error... suggested fixes</a>)</div>
</div>
<p>This error can occur for several different reasons, and the most common solution given for this error is to check for group/file permissions, which in almost every case is <i>not</i> the problem. The NVIDIA documentation does not talk in detail on what you should
do to correct this problem but there are a few things that have worked for some people. The problem can be a IRQ conflict with another device or bad routing by either the kernel or your BIOS.
</p>
<p>First thing to try is to remove other video devices such as video capture cards and see if the problem goes away. If there are too many video processors on the same system it can lead into the kernel being unable to start them because of memory allocation problems with the video controller. In particular on systems with low video memory this can occur even if there is only one video processor. In such case you should find out the amount of your system's video memory (e.g. with <code>lspci -v</code>) and pass allocation parameters to the kernel, e.g. for a 32-bit kernel:
</p>
<pre>vmalloc=384M
</pre>
<p>If running a 64bit kernel, a driver defect can cause the NVIDIA module to fail initializing when IOMMU is on. Turning it off in the BIOS has been confirmed to work for some users. <a rel="nofollow"  href="http://www.nvnews.net/vbulletin/showthread.php?s=68bb2fabadcb53b10b286aa42d13c5bc&amp;t=159335">[1]</a><a href="../../User:Clickthem.html#nvidia_module" title="User:Clickthem">User:Clickthem#nvidia module</a>
</p>
<p>Another thing to try is to change your BIOS IRQ routing from <code>Operating system controlled</code> to <code>BIOS controlled</code> or the other way around. The first one can be passed as a kernel parameter:
</p>
<pre>PCI=biosirq
</pre>
<p>The <code>noacpi</code> kernel parameter has also been suggested as a solution but since it disables ACPI completely it should be used with caution. Some hardware are easily damaged by overheating.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The kernel parameters can be passed either through the kernel command line or the bootloader configuration file. See your bootloader Wiki page for more information.</div>
<h2><span class="mw-headline" id="Crashing_in_general">Crashing in general</span></h2>
<ul>
<li>Try disabling <code>RenderAccel</code> in xorg.conf.</li>
<li>If Xorg outputs an error about <code>"conflicting memory type"</code> or <code>"failed to allocate primary buffer: out of memory"</code>, or crashes with a "Signal 11" while using nvidia-96xx drivers, add <code>nopat</code> to your <a href="..//Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>.</li>
<li>If the NVIDIA compiler complains about different versions of GCC between the current one and the one used for compiling the kernel, add in <code>/etc/profile</code>:</li>
</ul>
<pre>export IGNORE_CC_MISMATCH=1
</pre>
<ul><li>If Xorg is crashing , try disabling PAT. Pass the argument <code>nopat</code> to <a href="..//Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>.</li></ul>
<p>More information about troubleshooting the driver can be found in the <a rel="nofollow"  href="https://forums.geforce.com/">NVIDIA forums.</a>
</p>
<h2><span class="mw-headline" id="Bad_performance_after_installing_a_new_driver_version">Bad performance after installing a new driver version</span></h2>
<p>If FPS have dropped in comparison with older drivers, check if direct rendering is enabled (<code>glxinfo</code> is included in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mesa-demos">mesa-demos</a></span>):
</p>
<pre>$ glxinfo | grep direct
</pre>
<p>If the command prints:
</p>
<pre>direct rendering: No
</pre>
<p>A possible solution could be to regress to the previously installed driver version and rebooting afterwards.
</p>
<h2><span class="mw-headline" id="Avoid_screen_tearing">Avoid screen tearing</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This has been reported to reduce the performance of some OpenGL applications and may produce issues in WebGL. It also drastically increases the time the driver needs to clock down after load (<a rel="nofollow"  href="https://devtalk.nvidia.com/default/topic/1048768/linux/if-you-have-gpu-clock-boost-problems-please-try-__gl_experimentalperfstrategy-1/">Nvidia-Support-Thread</a>).</div>
<p>Tearing can be avoided by forcing a full composition pipeline, regardless of the compositor you are using. To test whether this option will work, run:
</p>
<pre>$ nvidia-settings --assign CurrentMetaMode="nvidia-auto-select +0+0 { ForceFullCompositionPipeline = On }"
</pre>
<p>Or click on the <i>Advanced</i> button that is available on the <i>X Server Display Configuration</i> menu option. Select either <i>Force Composition Pipeline</i> or <i>Force Full Composition Pipeline</i> and click on <i>Apply</i>.
</p>
<p>In order to make the change permanent, it must be added to the <code>"Screen"</code> section of the <a href="..//Usage/Configuration/X/Xorg.html" title="Xorg">Xorg</a> configuration file. When making this change, <code>TripleBuffering</code> should be enabled and <code>AllowIndirectGLXProtocol</code> should be disabled in the driver configuration as well. See example configuration below:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-nvidia.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
        Identifier "Nvidia Card"
        Driver     "nvidia"
        VendorName "NVIDIA Corporation"
        BoardName  "GeForce GTX 1050 Ti"
EndSection

Section "Screen"
    Identifier     "Screen0"
    Device         "Device0"
    Monitor        "Monitor0"
    Option         "metamodes" "nvidia-auto-select +0+0 {ForceFullCompositionPipeline=On}"
    Option         "AllowIndirectGLXProtocol" "off"
    Option         "TripleBuffer" "on"
EndSection
</pre>
<p>If you do not have an Xorg configuration file, you can create one for your present hardware using <code>nvidia-xconfig</code> (see <a href="..//Usage/Configuration/N/NVIDIA.html#Automatic_configuration" title="NVIDIA">NVIDIA#Automatic configuration</a>) and move it from <code>/etc/X11/xorg.conf</code> to the preferred location <code>/etc/X11/xorg.conf.d/20-nvidia.conf</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Many of the configuration options produced in <code>20-nvidia.conf</code> by using <code>nvidia-xconfig</code> are set automatically by the driver and are not needed. To only use this file for enabling composition pipeline, only the section <code>"Screen"</code> containing lines with values for <code>Identifier</code> and <code>Option</code> are necessary. Other sections may be removed from this file.</div>
<h3><span class="mw-headline" id="Multi-monitor">Multi-monitor</span></h3>
<p>For multi-monitor setup you will need to specify <code>ForceCompositionPipeline=On</code> for each display. For example:
</p>
<pre>$ nvidia-settings --assign CurrentMetaMode="DP-2: nvidia-auto-select +0+0 {ForceCompositionPipeline=On}, DP-4: nvidia-auto-select +3840+0 {ForceCompositionPipeline=On}"
</pre>
<p>Without doing this, the <code>nvidia-settings</code> command will disable your secondary display.
</p>
<p>You can get the current screen names and offsets using <code>--query</code>:
</p>
<pre>$ nvidia-settings --query CurrentMetaMode
</pre>
<p>The above line is for two 3840x2160 monitors connected to DP-2 and DP-4. You will need to read the correct <code>CurrentMetaMode</code> by exporting <code>xorg.conf</code> and append <code>ForceCompositionPipeline</code> to each of your displays. Setting <code>ForceCompositionPipeline</code> only affects the targeted display. 
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Multi monitor setups using different model monitors may have slightly different refresh rates. If vsync is enabled by the driver it will sync to only one of these refresh rates which can cause the appearance of screen tearing on incorrectly synced monitors. Select to sync the display device which is the primarily used monitor as others will not sync properly. This is configurable in <code>~/.nvidia-settings-rc</code> as <code>0/XVideoSyncToDisplayID=</code> or by installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia-settings">nvidia-settings</a></span> and using the graphical configuration options.</div>
<h3>
<span id="Avoid_screen_tearing_in_KDE_.28KWin.29"></span><span class="mw-headline" id="Avoid_screen_tearing_in_KDE_(KWin)">Avoid screen tearing in KDE (KWin)</span>
</h3>
<p>The problem is caused by incorrect assumption by the KDE devs about the behaviour of <code>glXSwapBuffers</code> and should be fixed in <b>Plasma 5.12</b>, <b>Plasma 5.15</b>, <b>Plasma 5.16</b> <a rel="nofollow"  href="https://phabricator.kde.org/D19867">[2]</a>. Additionally, <a href="..//Usage/Configuration/N/NVIDIA.html#DRM_kernel_mode_setting" title="NVIDIA">NVIDIA#DRM kernel mode setting</a> may be required. 
</p>
<h4><span class="mw-headline" id="Legacy_solutions">Legacy solutions</span></h4>
<p>For posterity, these are the legacy workarounds. Do <b>not</b> apply both workarounds because this may lead to high CPU load <a rel="nofollow"  href="https://bugs.kde.org/show_bug.cgi?id=322060">[3]</a>.
</p>
<h5><span class="mw-headline" id="1._GL_threads">1. GL threads</span></h5>
<p>Set GL threads to sleep by exporting <code>__GL_YIELD="USLEEP"</code> to just <code>kwin_x11</code>. Unlike setting up a global environment variable, this affects only KWin. It should also have the advantage over other workarounds, like forcing triple buffering or forcing composition pipeline in the driver, that it doesn't introduce additional stuttering when scrolling in Firefox or moving windows.
</p>
<p>The script can be executed automatically at login with an autostart script:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/autostart-scripts/kwin.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

(sleep 2s &amp;&amp; __GL_YIELD="USLEEP" kwin_x11 --replace)
</pre>
<p>Flag the script as executable.
</p>
<p>The <code>sleep</code> argument helps to prevent issues when KWin is restarted/hanging after logging in, you might need to increase this time.
</p>
<h5><span class="mw-headline" id="2._Use_TripleBuffering">2. Use TripleBuffering</span></h5>
<p>Make sure <code>TripleBuffering</code> has been enabled for the driver, see <a href="#Avoid_screen_tearing">#Avoid screen tearing</a>.
</p>
<p>Create the <code>/etc/profile.d/kwin.sh</code> file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/profile.d/kwin.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">export KWIN_TRIPLE_BUFFER=1</pre>
<p>Use <b>OpenGL 2.0 or later</b> as rendering backend under <i>System Settings &gt; Display and Monitor &gt; Compositor</i>.
</p>
<h2>
<span id="Modprobe_Error:_.22Could_not_insert_.27nvidia.27:_No_such_device.22_on_linux_.3E.3D4.8"></span><span class="mw-headline" id="Modprobe_Error:_&quot;Could_not_insert_'nvidia':_No_such_device&quot;_on_linux_&gt;=4.8">Modprobe Error: "Could not insert 'nvidia': No such device" on linux-tos&gt;=4.8</span>
</h2>
<p>With linux-tos4.8, one can get the following errors when trying to use the discrete card:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ modprobe nvidia -vv</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">modprobe: INFO: custom logging function 0x409c10 registered
modprobe: INFO: Failed to insert module '/lib/modules/4.8.6-1-ARCH/extramodules/nvidia.ko.gz': No such device
modprobe: ERROR: could not insert 'nvidia': No such device
modprobe: INFO: context 0x24481e0 released
insmod /lib/modules/4.8.6-1-ARCH/extramodules/nvidia.ko.gz 
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ dmesg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
NVRM: The NVIDIA GPU 0000:01:00.0 (PCI ID: 10de:139b)
NVRM: installed in this system is not supported by the 370.28
NVRM: NVIDIA Linux driver release.  Please see 'Appendix
NVRM: A - Supported NVIDIA GPU Products' in this release's
NVRM: README, available on the Linux driver download page
NVRM: at www.nvidia.com.
...
</pre>
<p>This problem is caused by bad commits pertaining to PCIe power management in the Linux Kernel (as documented in <a rel="nofollow"  href="https://devtalk.nvidia.com/default/topic/971733/-370-28-with-kernel-4-8-on-gt-2015-machines-driver-claims-card-not-supported-if-nvidia-is-not-primary-card/">this NVIDIA DevTalk thread</a>). 
</p>
<p>The workaround is to add <code>pcie_port_pm=off</code> to your <a href="..//Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>. Note that this disables PCIe power management for all devices.
</p>
<h2><span class="mw-headline" id="Poor_performance_after_resuming_from_suspend">Poor performance after resuming from suspend</span></h2>
<p>If you are getting poor performance after resuming from suspend, you need to register the nvidia kernel module with the ACPI subsystem. This can be done by <a href="..//Usage/Configuration/K/Kernel_module.html#Setting_module_options" class="mw-redirect" title="Kernel modules">loading</a> the <code>nvidia</code> module with the <code>NVreg_RegisterForACPIEvents=1 NVreg_EnableMSI=1</code> options.
</p>
<p>This also seems to fix issues with corruption to the desktop background on resume with GNOME.
</p>
<h2><span class="mw-headline" id="CPU_spikes_with_400_series_cards">CPU spikes with 400 series cards</span></h2>
<p>If you are experiencing intermittent CPU spikes with a 400 series card, it may be caused by PowerMizer constantly changing the GPU's clock frequency. Switching PowerMizer's setting from Adaptive to Performance, add the following to the <code>Device</code> section of your Xorg configuration:
</p>
<pre> Option "RegistryDwords" "PowerMizerEnable=0x1; PerfLevelSrc=0x3322; PowerMizerDefaultAC=0x1"
</pre>
<h2><span class="mw-headline" id="Full_system_freeze_or_crashes_when_using_Flash">Full system freeze or crashes when using Flash</span></h2>
<p>If you experience occasional full system freezes using <a href="..//Usage/Configuration/B/Browser_plugins.html#Flash_players" class="mw-redirect" title="Flash">Flash</a>, a possible workaround is to disable Hardware Acceleration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/adobe/mms.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">EnableLinuxHWVideoDecode=0</pre>
<p>Or, if you want to keep Hardware acceleration enabled but allowing a higher chance of screen tearing, you may try to before starting a browser:
</p>
<pre>export VDPAU_NVIDIA_NO_OVERLAY=1
</pre>
<h2>
<span id="Laptops:_X_hangs_on_login.2Fout.2C_worked_around_with_Ctrl.2BAlt.2BBackspace"></span><span class="mw-headline" id="Laptops:_X_hangs_on_login/out,_worked_around_with_Ctrl+Alt+Backspace">Laptops: X hangs on login/out, worked around with Ctrl+Alt+Backspace</span>
</h2>
<p>If, while using the legacy NVIDIA drivers, Xorg hangs on login and logout (particularly with an odd screen split into two black and white/gray pieces), but logging in is still possible via <code>Ctrl+Alt+Backspace</code> (or whatever the new "kill X" key binding is), try adding this in <code>/etc/modprobe.d/modprobe.conf</code>:
</p>
<pre>options nvidia NVreg_Mobile=1
</pre>
<p>One user had luck with this instead, but it makes performance drop significantly for others:
</p>
<pre>options nvidia NVreg_DeviceFileUID=0 NVreg_DeviceFileGID=33 NVreg_DeviceFileMode=0660 NVreg_SoftEDIDs=0 NVreg_Mobile=1
</pre>
<p>Note that <code>NVreg_Mobile</code> needs to be changed according to the laptop:
</p>
<ul>
<li>1 for Dell laptops.</li>
<li>2 for non-Compal Toshiba laptops.</li>
<li>3 for other laptops.</li>
<li>4 for Compal Toshiba laptops.</li>
<li>5 for Gateway laptops.</li>
</ul>
<p>See <a rel="nofollow"  href="ftp://download.nvidia.com/XFree86/Linux-x86/355.11/README/README.txt">NVIDIA Driver's README: Appendix K</a> for more information.
</p>
<h2>
<span id="Screen.28s.29_found.2C_but_none_have_a_usable_configuration"></span><span class="mw-headline" id="Screen(s)_found,_but_none_have_a_usable_configuration">Screen(s) found, but none have a usable configuration</span>
</h2>
<p>Sometimes NVIDIA and X have trouble finding the active screen. If your graphics card has multiple outputs try plugging your monitor into the other ones. On a laptop it may be because your graphics card has VGA/TV out. Xorg.0.log will provide more info.
</p>
<p>Another thing to try is adding invalid <code>"ConnectedMonitor" Option</code> to <code>Section "Device"</code>
to force Xorg throws error and shows you how correct it.
<a rel="nofollow"  href="ftp://download.nvidia.com/XFree86/Linux-x86/355.11/README/xconfigoptions.html">Here</a>
more about ConnectedMonitor setting.
</p>
<p>After re-run X see Xorg.0.log to get valid CRT-x,DFP-x,TV-x values.
</p>
<p><code>nvidia-xconfig --query-gpu-info</code> could be helpful.
</p>
<h2>
<span id="Blackscreen_at_X_startup_.2F_Machine_poweroff_at_X_shutdown"></span><span class="mw-headline" id="Blackscreen_at_X_startup_/_Machine_poweroff_at_X_shutdown">Blackscreen at X startup / Machine poweroff at X shutdown</span>
</h2>
<p>If you have installed an update of Nvidia and your screen stays black after launching Xorg, or if shutting down Xorg causes a machine poweroff, try the below workarounds:
</p>
<ul><li>Prepend "xrandr --auto" to your xinitrc</li></ul>
<ul><li>Use the <code>rcutree.rcu_idle_gp_delay=1</code> <a href="..//Usage/Configuration/K/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>.</li></ul>
<ul><li>You can also try to add the <code>nvidia</code> module directly to your <a href="..//Usage/Configuration/M/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a> config file.</li></ul>
<ul><li>If the screen still stays black with <b>both</b> the <code>rcutree.rcu_idle_gp_delay=1</code> <a href="..//Usage/Configuration/K/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> and the <code>nvidia</code> module directly in the <a href="..//Usage/Configuration/M/Mkinitcpio.html" title="Mkinitcpio">mkinitcpio</a> config file, try re-installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia">nvidia</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia-utils">nvidia-utils</a></span> in that order, and finally reload the driver:</li></ul>
<pre># modprobe nvidia
</pre>
<h2><span class="mw-headline" id="Backlight_is_not_turning_off_in_some_occasions">Backlight is not turning off in some occasions</span></h2>
<p>By default, DPMS should turn off backlight with the timeouts set or by running xset. However, probably due to a bug in the proprietary Nvidia drivers the result is a blank screen with no powersaving whatsoever. To workaround it, until the bug has been fixed you can use the <code>vbetool</code> as root.
</p>
<p>Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=vbetool">vbetool</a></span> package.
</p>
<p>Turn off your screen on demand and then by pressing a random key backlight turns on again:
</p>
<pre>vbetool dpms off &amp;&amp; read -n1; vbetool dpms on
</pre>
<p>Alternatively, xrandr is able to disable and re-enable monitor outputs without requiring root.
</p>
<pre>xrandr --output DP-1 --off; read -n1; xrandr --output DP-1 --auto
</pre>
<h3><span class="mw-headline" id="Driver_415:_HardDPMS">Driver 415: HardDPMS</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Add references for the "user reports". (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:NVIDIA/Troubleshooting">Talk:NVIDIA/Troubleshooting#</a>)</div>
</div>
<p>Proprietary driver 415 includes a new feature called HardDPMS. This is reported by some users to solve the issues with suspending monitors connected over DisplayPort.
It is reported to become the default in a future driver version, but for now, the <code>HardDPMS</code> option can be set in the <code>Device</code> or <code>Screen</code> sections. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-nvidia.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
    ...
    Option         "HardDPMS" "true"    
    ...
EndSection

Section "Screen"
    ...
    Option         "HardDPMS" "true"
    ...
EndSection
</pre>
<p><code>HardDPMS</code> will trigger on screensaver settings like <code>BlankTime</code>. The following <code>ServerFlags</code> will set your monitor(s) to suspend after 10 minutes of inactivity:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-nvidia.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "ServerFlags"
    Option     "BlankTime" "10"
EndSection
</pre>
<h2><span class="mw-headline" id="Xorg_fails_to_load_or_Red_Screen_of_Death">Xorg fails to load or Red Screen of Death</span></h2>
<p>If you get a red screen and use GRUB, disable the GRUB framebuffer by editing <code>/etc/default/grub</code> and uncomment <code>GRUB_TERMINAL_OUTPUT=console</code>. For more information see <a href="..//Usage/Configuration/G/GRUB/Tips_and_tricks.html#Disable_framebuffer" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Disable framebuffer</a>.
</p>
<h2><span class="mw-headline" id="Black_screen_on_systems_with_Intel_integrated_GPU">Black screen on systems with Intel integrated GPU</span></h2>
<p>If you have an Intel CPU with an integrated GPU (e.g. Intel HD 4000) and have installed the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia">nvidia</a></span> package, you may experience a black screen on boot, when changing virtual terminal, or when exiting an X session. This may be caused by a conflict between the graphics modules. This is solved by blacklisting the Intel GPU modules. Create the file <code>/etc/modprobe.d/blacklist.conf</code> and prevent the <i>i915</i> and <i>intel_agp</i> modules from loading on boot:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/blacklist.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">install i915 /usr/bin/false
install intel_agp /usr/bin/false
</pre>
<h2><span class="mw-headline" id="No_audio_over_HDMI">No audio over HDMI</span></h2>
<p>Sometimes nvidia HDMI audio devices are not shown when you do
</p>
<pre>aplay -l
</pre>
<p>For whatever reason on some new machines, the audio chip on the nvidia GPU is disabled at boot. Read more <a rel="nofollow"  href="https://devtalk.nvidia.com/default/topic/1024022/linux/gtx-1060-no-audio-over-hdmi-only-hda-intel-detected-azalia/?offset=4">here</a> and <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=230125">here</a>
</p>
<p>You need to reload the nvidia device with audio enabled. In order to do that make sure that your GPU is on (in case of laptops/Bumblebee) and that you are not running X on it, because it's going to reset:
</p>
<pre># setpci -s 01:00.0 0x488.l=0x2000000:0x2000000
# rmmod nvidia-drm nvidia-modeset nvidia
# echo 1 &gt; /sys/bus/pci/devices/0000:01:00.0/remove
# echo 1 &gt; /sys/bus/pci/devices/0000:00:01.0/rescan
# modprobe nvidia-drm
# xinit -- -retro
</pre>
<p>If you are running your TTY on nvidia, put the lines in a script so you don't end up with no screen.
</p>
<h2><span class="mw-headline" id="Black_screen_on_systems_with_VIA_integrated_GPU">Black screen on systems with VIA integrated GPU</span></h2>
<p>As above, blacklisting the <i>viafb</i> module may resolve conflicts with NVIDIA drivers:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/blacklist.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">install viafb /usr/bin/false
</pre>
<h2>
<span id="X_fails_with_.22no_screens_found.22_when_using_Multiple_GPUs"></span><span class="mw-headline" id='X_fails_with_"no_screens_found"_when_using_Multiple_GPUs'>X fails with "no screens found" when using Multiple GPUs</span>
</h2>
<p>In situations where you might have multiple GPUs on a system and X fails to start with:
</p>
<pre>[ 76.633] (EE) No devices detected.
[ 76.633] Fatal server error:
[ 76.633] no screens found
</pre>
<p>then you need to add your discrete card's BusID to your X configuration. This can happen on systems with an Intel CPU and an integrated GPU or if you have more than one Nvidia card connected. Find your BusID:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># lspci | grep VGA</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">00:02.0 VGA compatible controller: Intel Corporation Xeon E3-1200 v2/3rd Gen Core processor Graphics Controller (rev 09)
01:00.0 VGA compatible controller: NVIDIA Corporation GK107 [GeForce GTX 650] (rev a1)
</pre>
<p>then you fix it by adding it to the card's Device section in your X configuration. In my case:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/10-nvidia.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
    Identifier     "Device0"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
    BusID          "PCI:1:0:0"
EndSection
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> BusID formatting is important!</div>
<p>In the example above <code>01:00.0</code> is stripped to be written as <code>1:0:0</code>, however come conversions can be more complicated. <code>lspci</code> output is in hex format, but in config files the BusID's are in decimal format! This means that in cases where the BusID is greater than 9 you will need to convert it to decimal! 
</p>
<p>ie: <code>5e:00.0</code> from lspci becomes <code>PCI:94:0:0</code>.
</p>
<h2>
<span id="Xorg_fails_during_boot.2C_but_otherwise_starts_fine"></span><span class="mw-headline" id="Xorg_fails_during_boot,_but_otherwise_starts_fine">Xorg fails during boot, but otherwise starts fine</span>
</h2>
<p>On very fast booting systems, systemd may attempt to start the display manager before the NVIDIA driver has fully initialized. You will see a message like the following in your logs only when Xorg runs during boot.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/log/Xorg.0.log</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[     1.807] (EE) NVIDIA(0): Failed to initialize the NVIDIA kernel module. Please see the
[     1.807] (EE) NVIDIA(0):     system's kernel log for additional error messages and
[     1.808] (EE) NVIDIA(0):     consult the NVIDIA README for details.
[     1.808] (EE) NVIDIA(0):  *** Aborting ***</pre>
<p>In this case you will need to establish an ordering dependency from the display manager to the DRI device. First create device units for DRI devices by creating a new udev rules file.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/99-systemd-dri-devices.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ACTION=="add", KERNEL=="card*", SUBSYSTEM=="drm", TAG+="systemd"</pre>
<p>Then create dependencies from the display manager to the device(s).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/display-manager.service.d/10-wait-for-dri-devices.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Wants=dev-dri-card0.device
After=dev-dri-card0.device</pre>
<p>If you have additional cards needed for the desktop then list them in Wants and After seperated by spaces.
</p>
<h2><span class="mw-headline" id="xrandr_BadMatch">xrandr BadMatch</span></h2>
<p>If you are trying to configure a WQHD monitor such as DELL U2515H using <a href="..//Usage/Configuration/X/Xrandr.html" title="Xrandr">xrandr</a> and <code>xrandr --addmode</code> gives you the error <code>X Error of failed request: BadMatch</code>, it might be because the proprietary NVIDIA driver clips the pixel clock maximum frequency of HDMI output to 225 MHz or lower. To set the monitor to maximum resolution you have to install <a href="..//Usage/Configuration/N/Nouveau.html" title="Nouveau">nouveau</a> drivers. You can force nouveau to use a specific pixel clock frequency by setting <code>nouveau.hdmimhz=297</code> (or <code>330</code>) in your <a href="..//Usage/Configuration/K/Kernel_parameters.html" title="Kernel parameters">Kernel parameters</a>.
</p>
<p>Alternatively, it may be that your monitor's EDID is incorrect. See <a href="#Override_EDID">#Override EDID</a>.
</p>
<p>Another reason could be that per default current NVidia drivers will only allow modes explicitly reported by EDID; but sometimes refresh rates and/or resolutions are desired which are not reported by the monitor (although the EDID information is correct; it's just that current NVidia drivers are too restrictive).
</p>
<p>If this happens, you may want to add an option to <code>/etc/X11/xorg.conf.d/</code> to allow non-EDID modes:
</p>
<pre>Section "Device"
    Identifier     "Device0"
    Driver         "nvidia"
    VendorName     "NVIDIA Corporation"
...
    Option         "ModeValidation" "AllowNonEdidModes"
...
EndSection
</pre>
<p>This can be set per-output. See NVidia driver readme (Appendix B. X Config Options) for more information.
</p>
<h2><span class="mw-headline" id="Override_EDID">Override EDID</span></h2>
<p>See <a href="..//Usage/Configuration/K/Kernel_mode_setting.html#Forcing_modes_and_EDID" title="Kernel mode setting">Kernel mode setting#Forcing modes and EDID</a>, <a href="..//Usage/Configuration/X/Xrandr.html#Troubleshooting" title="Xrandr">Xrandr#Troubleshooting</a> and  <a href="..//Usage/Configuration/Q/Qnix_QX2710.html#Fixing_X11_with_Nvidia" title="Qnix QX2710">Qnix QX2710#Fixing X11 with Nvidia</a>.
</p>
<h2><span class="mw-headline" id="Overclocking_with_nvidia-settings_GUI_not_working">Overclocking with nvidia-settings GUI not working</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-edit-clear.png" ><img alt="Tango-edit-clear.png" src="../../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="..//Usage/Configuration/H/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../../File:Tango-edit-clear.png" ><img alt="Tango-edit-clear.png" src="../../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Duplication, vague "not working" (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:NVIDIA/Troubleshooting">Talk:NVIDIA/Troubleshooting#</a>)</div>
</div>
<p>Workaround is to use nvidia-settings CLI to query and set certain variables after enabling overclocking (as explained in <a href="..//Usage/Configuration/N/NVIDIA/Tips_and_tricks.html#Enabling_overclocking" title="NVIDIA/Tips and tricks">NVIDIA/Tips and tricks#Enabling overclocking</a>, see <span class="plainlinks archwiki-template-man" title="$ man 1 nvidia-settings"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/nvidia-settings.1">nvidia-settings(1)</a></span> for more information).
</p>
<p>Example to query all variables:
</p>
<pre> nvidia-settings -q all
</pre>
<p>Example to set PowerMizerMode to prefer performance mode:
</p>
<pre> nvidia-settings -a [gpu:0]/GPUPowerMizerMode=1
</pre>
<p>Example to set fan speed to fixed 21%:
</p>
<pre>nvidia-settings -a [gpu:0]/GPUFanControlState=1 -a [fan:0]/GPUTargetFanSpeed=21
</pre>
<p>Example to set multiple variables at once (overclock GPU by 50MHz, overclock video memory by 50MHz, increase GPU voltage by 100mV):
</p>
<pre> nvidia-settings -a GPUGraphicsClockOffsetAllPerformanceLevels=50 -a GPUMemoryTransferRateOffsetGPUGraphicsClockOffsetAllPerformanceLevels=50 -a GPUOverVoltageOffset=100
</pre>
<h2><span class="mw-headline" id="Overclocking_not_working_with_Unknown_Error">Overclocking not working with Unknown Error</span></h2>
<p>If you're running Xorg as a non-root user and trying to overclock your NVIDIA GPU, you will get an error similar to this one:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ nvidia-settings -a "[gpu:0]/GPUGraphicsClockOffset[3]=10"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ERROR: Error assigning value 10 to attribute 'GPUGraphicsClockOffset' (trinity-zero:1[gpu:0]) as specified in assignment
        '[gpu:0]/GPUGraphicsClockOffset[3]=10' (Unknown Error).</pre>
<p>To avoid this issue, Xorg has to be run as the root user. See <a href="..//Usage/Configuration/X/Xorg.html#Rootless_Xorg" title="Xorg">Xorg#Rootless Xorg</a> for details.
</p>
<h2><span class="mw-headline" id="System_will_not_boot_after_driver_was_installed">System will not boot after driver was installed</span></h2>
<p>If after installing the <a href="..//Usage/Configuration/N/NVIDIA.html" title="NVIDIA">NVIDIA</a> driver your system becomes stuck before reaching the display manager, try to <a href="..//Usage/Configuration/K/Kernel_mode_setting.html#Disabling_modesetting" title="Kernel mode setting">disable kernel mode setting</a>.
</p>
<h2>
<span id="X_fails_with_.22Failing_initialization_of_X_screen.22"></span><span class="mw-headline" id='X_fails_with_"Failing_initialization_of_X_screen"'>X fails with "Failing initialization of X screen"</span>
</h2>
<p>If <code>/var/log/Xorg.0.log</code> says X server fails to initialize screen
</p>
<pre>(EE) NVIDIA(G0): GPU screens are not yet supported by the NVIDIA driver
(EE) NVIDIA(G0): Failing initialization of X screen
</pre>
<p>and nvidia-smi says <code>No running processes found</code>
</p>
<p>The solution is at first reinstall latest <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nvidia-utils">nvidia-utils</a></span>, and then copy <code>/usr/share/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</code> to <code>/etc/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</code>, and then edit <code>/etc/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</code> and add the line <code>Option "PrimaryGPU" "yes"</code>. Restart the computer. The problem will be fixed.
</p>
<h2><span class="mw-headline" id="System_does_not_return_from_suspend">System does not return from suspend</span></h2>
<p>What you see in the log:
</p>
<pre>kernel: nvidia-modeset: ERROR: GPU:0: Failed detecting connected display devices
kernel: nvidia-modeset: ERROR: GPU:0: Failed detecting connected display devices
kernel: nvidia-modeset: WARNING: GPU:0: Failure processing EDID for display device DELL U2412M (DP-0).
kernel: nvidia-modeset: WARNING: GPU:0: Unable to read EDID for display device DELL U2412M (DP-0)
kernel: nvidia-modeset: ERROR: GPU:0: Failure reading maximum pixel clock value for display device DELL U2412M (DP-0).
</pre>
<p>A possible solution based on <a rel="nofollow"  href="https://forums.developer.nvidia.com/t/solution-for-nvidia-sleep-wake-issue-in-linux/110911">[4]</a>:
</p>
<p>Run this command to get the <code><i>version</i></code> string:
</p>
<pre># strings /sys/firmware/acpi/tables/DSDT | grep -i 'windows ' | sort | tail -1
</pre>
<p>Add the <code>acpi_osi=! "acpi_osi=<i>version</i>"</code> <a href="..//Usage/Configuration/K/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> to your <a href="..//Usage/Configuration/T/TOS_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a> configuration.
</p>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="..//Usage/Configuration/C/Category:Graphics.html" title="Category:Graphics">Graphics</a></li>
<li><a href="..//Usage/Configuration/C/Category:X_server.html" title="Category:X server">X server</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=NVIDIA/Troubleshooting&amp;oldid=615947">https://wiki.archlinux.org/index.php?title=NVIDIA/Troubleshooting&amp;oldid=615947</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 26 May 2020, at 12:44.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">PulseAudio/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p>See <a href="..//Usage/Configuration/P/PulseAudio.html" title="PulseAudio">PulseAudio</a> for the main article.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Volume"><span >1</span> <span >Volume</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Auto-Mute_Mode"><span >1.1</span> <span >Auto-Mute Mode</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Muted_audio_device"><span >1.2</span> <span >Muted audio device</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Output_stuck_muted_while_Master_is_toggled"><span >1.3</span> <span >Output stuck muted while Master is toggled</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Muted_application"><span >1.4</span> <span >Muted application</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Volume_adjustment_does_not_work_properly"><span >1.5</span> <span >Volume adjustment does not work properly</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Per-application_volumes_change_when_the_Master_volume_is_adjusted"><span >1.6</span> <span >Per-application volumes change when the Master volume is adjusted</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Volume_gets_louder_every_time_a_new_application_is_started"><span >1.7</span> <span >Volume gets louder every time a new application is started</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Sound_output_is_only_mono_on_M-Audio_Audiophile_2496_sound_card"><span >1.8</span> <span >Sound output is only mono on M-Audio Audiophile 2496 sound card</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#No_sound_below_a_volume_cutoff_or_Clipping_on_a_particular_output_device"><span >1.9</span> <span >No sound below a volume cutoff or Clipping on a particular output device</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Low_volume_for_internal_microphone"><span >1.10</span> <span >Low volume for internal microphone</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Clients_alter_master_output_volume_(a.k.a._volume_jumps_to_100%_after_running_application)"><span >1.11</span> <span >Clients alter master output volume (a.k.a. volume jumps to 100% after running application)</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#No_sound_after_resume_from_suspend"><span >1.12</span> <span >No sound after resume from suspend</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#ALSA_channels_mute_when_headphones_are_plugged/unplugged_improperly"><span >1.13</span> <span >ALSA channels mute when headphones are plugged/unplugged improperly</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Volume_resets_to_50%_every_few_seconds"><span >1.14</span> <span >Volume resets to 50% every few seconds</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Volume_low/too_quiet_on_analog_headphones/speakers"><span >1.15</span> <span >Volume low/too quiet on analog headphones/speakers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#Microphone"><span >2</span> <span >Microphone</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Microphone_not_detected_by_PulseAudio"><span >2.1</span> <span >Microphone not detected by PulseAudio</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#PulseAudio_uses_wrong_microphone"><span >2.2</span> <span >PulseAudio uses wrong microphone</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#No_microphone_on_ThinkPad_T400/T500/T420"><span >2.3</span> <span >No microphone on ThinkPad T400/T500/T420</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#No_microphone_input_on_Acer_Aspire_One_and_Lenovo_Ideapad-310-15ISK"><span >2.4</span> <span >No microphone input on Acer Aspire One and Lenovo Ideapad-310-15ISK</span></a></li>
<li class="toclevel-2 tocsection-22">
<a href="#Static_noise_in_microphone_recording"><span >2.5</span> <span >Static noise in microphone recording</span></a>
<ul>
<li class="toclevel-3 tocsection-23"><a href="#Determine_sound_cards_in_the_system_(1/5)"><span >2.5.1</span> <span >Determine sound cards in the system (1/5)</span></a></li>
<li class="toclevel-3 tocsection-24"><a href="#Determine_sampling_rate_of_the_sound_card_(2/5)"><span >2.5.2</span> <span >Determine sampling rate of the sound card (2/5)</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#Setting_the_sound_card's_sampling_rate_into_PulseAudio_configuration_(3/5)"><span >2.5.3</span> <span >Setting the sound card's sampling rate into PulseAudio configuration (3/5)</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#Restart_PulseAudio_to_apply_the_new_settings_(4/5)"><span >2.5.4</span> <span >Restart PulseAudio to apply the new settings (4/5)</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Finally_check_by_recording_and_playing_it_back_(5/5)"><span >2.5.5</span> <span >Finally check by recording and playing it back (5/5)</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Another_Possible_Cause"><span >2.5.6</span> <span >Another Possible Cause</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#If_using_a_USB_microphone"><span >2.5.7</span> <span >If using a USB microphone</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-30"><a href="#No_microphone_on_Steam_or_Skype_with_enable-remixing_=_no"><span >2.6</span> <span >No microphone on Steam or Skype with enable-remixing = no</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Microphone_distorted_due_to_automatic_adjustment"><span >2.7</span> <span >Microphone distorted due to automatic adjustment</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Microphone_crackling_with_Realtek_ALC892"><span >2.8</span> <span >Microphone crackling with Realtek ALC892</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Microphone_crackling_with_Azalia_chipsets"><span >2.9</span> <span >Microphone crackling with Azalia chipsets</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Echo_test"><span >2.10</span> <span >Echo test</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-35">
<a href="#Audio_quality"><span >3</span> <span >Audio quality</span></a>
<ul>
<li class="toclevel-2 tocsection-36">
<a href="#Enable_Echo/Noise-Cancellation"><span >3.1</span> <span >Enable Echo/Noise-Cancellation</span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="#Possible_'aec_args'_for_'aec_method=webrtc'"><span >3.1.1</span> <span >Possible 'aec_args' for 'aec_method=webrtc'</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Disable_audio_post_processing_in_certain_applications"><span >3.1.2</span> <span >Disable audio post processing in certain applications</span></a></li>
<li class="toclevel-3 tocsection-39"><a href="#Script_for_reloading_module-echo-cancel"><span >3.1.3</span> <span >Script for reloading module-echo-cancel</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-40"><a href="#Glitches,_skips_or_crackling"><span >3.2</span> <span >Glitches, skips or crackling</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Static_noise_when_using_headphones"><span >3.3</span> <span >Static noise when using headphones</span></a></li>
<li class="toclevel-2 tocsection-42">
<a href="#Setting_the_default_fragment_number_and_buffer_size_in_PulseAudio"><span >3.4</span> <span >Setting the default fragment number and buffer size in PulseAudio</span></a>
<ul>
<li class="toclevel-3 tocsection-43"><a href="#Disabling_timer-based_scheduling_(0/4)"><span >3.4.1</span> <span >Disabling timer-based scheduling (0/4)</span></a></li>
<li class="toclevel-3 tocsection-44"><a href="#Decide_on_audio_device_parameters_(1/4)"><span >3.4.2</span> <span >Decide on audio device parameters (1/4)</span></a></li>
<li class="toclevel-3 tocsection-45"><a href="#Modify_PulseAudio's_configuration_file_(2/4)"><span >3.4.3</span> <span >Modify PulseAudio's configuration file (2/4)</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#Restart_the_PulseAudio_daemon_(3/4)"><span >3.4.4</span> <span >Restart the PulseAudio daemon (3/4)</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#See_if_it_helps_(4/4)"><span >3.4.5</span> <span >See if it helps (4/4)</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-48"><a href="#Choppy_sound_with_analog_surround_sound_setup"><span >3.5</span> <span >Choppy sound with analog surround sound setup</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Laggy_sound"><span >3.6</span> <span >Laggy sound</span></a></li>
<li class="toclevel-2 tocsection-50"><a href="#Choppy/distorted_sound"><span >3.7</span> <span >Choppy/distorted sound</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#Sound_stuttering_when_streaming_over_network"><span >3.8</span> <span >Sound stuttering when streaming over network</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#Pops_when_starting_and_stopping_playback"><span >3.9</span> <span >Pops when starting and stopping playback</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-53">
<a href="#Hardware_and_Cards"><span >4</span> <span >Hardware and Cards</span></a>
<ul>
<li class="toclevel-2 tocsection-54"><a href="#No_HDMI_sound_output_after_some_time_with_the_monitor_turned_off"><span >4.1</span> <span >No HDMI sound output after some time with the monitor turned off</span></a></li>
<li class="toclevel-2 tocsection-55"><a href="#No_HDMI_sound_using_a_headless_server"><span >4.2</span> <span >No HDMI sound using a headless server</span></a></li>
<li class="toclevel-2 tocsection-56"><a href="#No_cards"><span >4.3</span> <span >No cards</span></a></li>
<li class="toclevel-2 tocsection-57"><a href="#Starting_an_application_interrupts_other_app's_sound"><span >4.4</span> <span >Starting an application interrupts other app's sound</span></a></li>
<li class="toclevel-2 tocsection-58"><a href="#The_only_device_shown_is_%22dummy_output%22_or_newly_connected_cards_are_not_detected"><span >4.5</span> <span >The only device shown is "dummy output" or newly connected cards are not detected</span></a></li>
<li class="toclevel-2 tocsection-59"><a href="#No_HDMI_5/7.1_Selection_for_Device"><span >4.6</span> <span >No HDMI 5/7.1 Selection for Device</span></a></li>
<li class="toclevel-2 tocsection-60"><a href="#Failed_to_create_sink_input:_sink_is_suspended"><span >4.7</span> <span >Failed to create sink input: sink is suspended</span></a></li>
<li class="toclevel-2 tocsection-61"><a href="#Simultaneous_output_to_multiple_sound_cards_/_devices"><span >4.8</span> <span >Simultaneous output to multiple sound cards / devices</span></a></li>
<li class="toclevel-2 tocsection-62"><a href="#Simultaneous_output_to_multiple_sinks_on_the_same_sound_card_not_working"><span >4.9</span> <span >Simultaneous output to multiple sinks on the same sound card not working</span></a></li>
<li class="toclevel-2 tocsection-63"><a href="#Some_profiles_like_SPDIF_are_not_enabled_by_default_on_the_card"><span >4.10</span> <span >Some profiles like SPDIF are not enabled by default on the card</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#Only_S/PDIF_output_available"><span >4.11</span> <span >Only S/PDIF output available</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-65">
<a href="#Bluetooth"><span >5</span> <span >Bluetooth</span></a>
<ul>
<li class="toclevel-2 tocsection-66"><a href="#Disable_Bluetooth_support"><span >5.1</span> <span >Disable Bluetooth support</span></a></li>
<li class="toclevel-2 tocsection-67"><a href="#Bluetooth_headset_replay_problems"><span >5.2</span> <span >Bluetooth headset replay problems</span></a></li>
<li class="toclevel-2 tocsection-68"><a href="#Automatically_switch_to_Bluetooth_or_USB_headset"><span >5.3</span> <span >Automatically switch to Bluetooth or USB headset</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#My_Bluetooth_device_is_paired_but_does_not_play_any_sound"><span >5.4</span> <span >My Bluetooth device is paired but does not play any sound</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-70">
<a href="#Applications"><span >6</span> <span >Applications</span></a>
<ul>
<li class="toclevel-2 tocsection-71"><a href="#Flash_content"><span >6.1</span> <span >Flash content</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#Permission_errors_bug"><span >6.2</span> <span >Permission errors bug</span></a></li>
<li class="toclevel-2 tocsection-73"><a href="#Audacity"><span >6.3</span> <span >Audacity</span></a></li>
<li class="toclevel-2 tocsection-74"><a href="#OpenAL"><span >6.4</span> <span >OpenAL</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-75">
<a href="#Other_Issues"><span >7</span> <span >Other Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-76"><a href="#Bad_configuration_files"><span >7.1</span> <span >Bad configuration files</span></a></li>
<li class="toclevel-2 tocsection-77"><a href="#Cannot_update_configuration_of_sound_device_in_pavucontrol"><span >7.2</span> <span >Cannot update configuration of sound device in pavucontrol</span></a></li>
<li class="toclevel-2 tocsection-78"><a href="#Failed_to_create_sink_input:_sink_is_suspended_2"><span >7.3</span> <span >Failed to create sink input: sink is suspended</span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#Pulse_overwrites_ALSA_settings"><span >7.4</span> <span >Pulse overwrites ALSA settings</span></a></li>
<li class="toclevel-2 tocsection-80"><a href="#Prevent_Pulse_from_restarting_after_being_killed"><span >7.5</span> <span >Prevent Pulse from restarting after being killed</span></a></li>
<li class="toclevel-2 tocsection-81">
<a href="#Daemon_startup_failed"><span >7.6</span> <span >Daemon startup failed</span></a>
<ul>
<li class="toclevel-3 tocsection-82"><a href="#Outputs_by_PulseAudio_error_status_check_utilities"><span >7.6.1</span> <span >Outputs by PulseAudio error status check utilities</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-83"><a href="#Daemon_already_running"><span >7.7</span> <span >Daemon already running</span></a></li>
<li class="toclevel-2 tocsection-84"><a href="#Subwoofer_stops_working_after_end_of_every_song"><span >7.8</span> <span >Subwoofer stops working after end of every song</span></a></li>
<li class="toclevel-2 tocsection-85"><a href="#Unable_to_select_surround_configuration_other_than_%22Surround_4.0%22"><span >7.9</span> <span >Unable to select surround configuration other than "Surround 4.0"</span></a></li>
<li class="toclevel-2 tocsection-86"><a href="#Realtime_scheduling"><span >7.10</span> <span >Realtime scheduling</span></a></li>
<li class="toclevel-2 tocsection-87"><a href="#pactl_%22invalid_option%22_error_with_negative_percentage_arguments"><span >7.11</span> <span >pactl "invalid option" error with negative percentage arguments</span></a></li>
<li class="toclevel-2 tocsection-88"><a href="#Fallback_device_is_not_respected"><span >7.12</span> <span >Fallback device is not respected</span></a></li>
<li class="toclevel-2 tocsection-89"><a href="#RTP/UDP_packet_flood"><span >7.13</span> <span >RTP/UDP packet flood</span></a></li>
<li class="toclevel-2 tocsection-90"><a href="#New_audio_source_streams_auto-select_to_%22blank%22_stream_instead_of_BT_headphones"><span >7.14</span> <span >New audio source streams auto-select to "blank" stream instead of BT headphones</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Volume">Volume</span></h2>
<p>Here you will find some hints on volume issues and why you may not hear anything.
</p>
<h3><span class="mw-headline" id="Auto-Mute_Mode">Auto-Mute Mode</span></h3>
<p><i>Auto-Mute Mode</i> is a configurable setting from <code>amixer</code>. For more information, see <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html#Disabling_auto_mute_on_startup" class="mw-redirect" title="ALSA">ALSA#Disabling auto mute on startup</a>.
</p>
<h3><span class="mw-headline" id="Muted_audio_device">Muted audio device</span></h3>
<p>If one experiences no audio output via any means while using <a href="..//Usage/Configuration/A/Advanced_Linux_Sound_TOSitecture.html" class="mw-redirect" title="ALSA">ALSA</a>, attempt to unmute the sound card. To do this, launch <code>alsamixer</code> and make sure each column has a green <code>00</code> under it (this can be toggled by pressing <code>m</code>):
</p>
<pre>$ alsamixer -c 0
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> alsamixer will not tell you which output device is set as the default. One possible cause of no sound after install is that PulseAudio detects the wrong output device as a default. Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> and check if there is any output on the pavucontrol panel when playing a <i>.wav</i> file.</div>
<h3><span class="mw-headline" id="Output_stuck_muted_while_Master_is_toggled">Output stuck muted while Master is toggled</span></h3>
<p>In setups with multiple outputs (e.g. 'Headphone' and 'Speaker') using plain amixer to toggle Master can trigger PulseAudio to mute the active output too, but it does not necessarily unmute it when Master is toggled back to be unmuted. <a rel="nofollow"  href="https://lists.freedesktop.org/archives/pulseaudio-discuss/2015-December/025062.html">[1]</a> To resolve this, amixer must have the device flag set to 'pulse':
</p>
<pre>$ amixer -D pulse sset Master toggle
</pre>
<p>This will cause amixer to ask PulseAudio to do the toggling rather than toggling it directly.
Because of this, PulseAudio will correctly unmute Master as well as any applicable output.
</p>
<h3><span class="mw-headline" id="Muted_application">Muted application</span></h3>
<p>If a specific application is muted or low while all else seems to be in order, it may be due to individual <code>sink-input</code> settings. With the offending application playing audio, run:
</p>
<pre>$ pacmd list-sink-inputs
</pre>
<p>Find and make note of the <code>index</code> of the corresponding <code>sink input</code>. The <code>properties:</code> <code>application.name</code> and <code>application.process.binary</code>, among others, should help here. Ensure sane settings are present, specifically those of <code>muted</code> and <code>volume</code>.
If the sink is muted, it can be unmuted by:
</p>
<pre>$ pacmd set-sink-input-mute &lt;index&gt; false
</pre>
<p>If the volume needs adjusting, it can be set to 100% by:
</p>
<pre>$ pacmd set-sink-input-volume &lt;index&gt; 0x10000
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If <code>pacmd</code> reports <code>0 sink input(s)</code>, double-check that the application is playing audio. If it is still absent, verify that other applications show up as sink inputs.</div>
<h3><span class="mw-headline" id="Volume_adjustment_does_not_work_properly">Volume adjustment does not work properly</span></h3>
<p>Check <code>/usr/share/pulseaudio/alsa-mixer/paths/analog-output.conf.common</code>.
</p>
<p>If the volume does not appear to increment/decrement properly using <code>alsamixer</code> or <code>amixer</code>, it may be due to PulseAudio having a larger number of increments (65537 to be exact). Try using larger values when changing volume (e.g. <code>amixer set Master 655+</code>).
</p>
<h3><span class="mw-headline" id="Per-application_volumes_change_when_the_Master_volume_is_adjusted">Per-application volumes change when the Master volume is adjusted</span></h3>
<p>This is because PulseAudio uses flat volumes by default, instead of relative volumes, relative to an absolute master volume. If this is found to be inconvenient, asinine, or otherwise undesireable, relative volumes can be enabled by disabling flat volumes in the PulseAudio daemon's configuration file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf or ~/.config/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">flat-volumes = no</pre>
<p>and then restarting PulseAudio by executing
</p>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<h3><span class="mw-headline" id="Volume_gets_louder_every_time_a_new_application_is_started">Volume gets louder every time a new application is started</span></h3>
<p>Per default, it seems as if changing the volume in an application sets the global system volume to that level instead of only affecting the respective application. Applications setting their volume on startup will therefore cause the system volume to "jump".
</p>
<p>Fix this by disabling flat volumes, as demonstrated in the previous section. When Pulse comes back after a few seconds, applications will not alter the global system volume anymore but have their own volume level again.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> A previously installed and removed pulseaudio-equalizer may leave behind remnants of the setup in <code>~/.config/pulse/default.pa</code> or <code>~/.pulse/default.pa</code> which can also cause maximized volume trouble. Comment that out as needed.</div>
<h3><span class="mw-headline" id="Sound_output_is_only_mono_on_M-Audio_Audiophile_2496_sound_card">Sound output is only mono on M-Audio Audiophile 2496 sound card</span></h3>
<p>Add the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulseaudio/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-alsa-sink sink_name=delta_out device=hw:M2496 format=s24le channels=10 channel_map=left,right,aux0,aux1,aux2,aux3,aux4,aux5,aux6,aux7
load-module module-alsa-source source_name=delta_in device=hw:M2496 format=s24le channels=12 channel_map=left,right,aux0,aux1,aux2,aux3,aux4,aux5,aux6,aux7,aux8,aux9
set-default-sink delta_out
set-default-source delta_in</pre>
<h3><span class="mw-headline" id="No_sound_below_a_volume_cutoff_or_Clipping_on_a_particular_output_device">No sound below a volume cutoff or Clipping on a particular output device</span></h3>
<p>Known issue (will not fix): <a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/223133">https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/223133</a>
</p>
<p>If sound does not play when PulseAudio's volume is set below a certain level, or if you hear clipping on output even at low volume (including bluetooth devices), try setting <code>ignore_dB=1</code> in <code>/etc/pulse/default.pa</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-udev-detect ignore_dB=1</pre>
<p>However, be aware that it may cause another bug preventing PulseAudio to unmute speakers when headphones or other audio devices are unplugged.
</p>
<h3><span class="mw-headline" id="Low_volume_for_internal_microphone">Low volume for internal microphone</span></h3>
<p>If you experience low volume on internal notebook microphone, try setting:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set-source-volume 1 300000</pre>
<h3>
<span id="Clients_alter_master_output_volume_.28a.k.a._volume_jumps_to_100.25_after_running_application.29"></span><span class="mw-headline" id="Clients_alter_master_output_volume_(a.k.a._volume_jumps_to_100%_after_running_application)">Clients alter master output volume (a.k.a. volume jumps to 100% after running application)</span>
</h3>
<p>If changing the volume in specific applications or simply running an application changes the master output volume this is likely due to flat volumes mode of pulseaudio. Before disabling it, KDE users should try lowering their system notifications volume in <i>System Settings -&gt; Application and System Notifications -&gt; Manage Notifications</i> under the <i>Player Settings</i> tab to something reasonable. Changing the <i>Event Sounds</i> volume in KMix or another volume mixer application will not help here. This should make the flat-volumes mode work out as intended, if it does not work, some other application is likely requesting 100% volume when its playing something. If all else fails, you can try to disable flat-volumes:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">flat-volumes = no</pre>
<p>Then restart PulseAudio daemon:
</p>
<pre># pulseaudio -k
# pulseaudio --start
</pre>
<h3><span class="mw-headline" id="No_sound_after_resume_from_suspend">No sound after resume from suspend</span></h3>
<p>If audio generally works, but stops after resume from suspend, try "reloading" PulseAudio by executing:
</p>
<pre>$ /usr/bin/pasuspender /bin/true
</pre>
<p>This is better than completely killing and restarting it (<code>pulseaudio -k</code> followed by <code>pulseaudio --start</code>), because it does not break already running applications.
</p>
<p>If the above fixes your problem, you may wish to automate it, by creating a systemd service file.
</p>
<p>1. Create the template service file in <code>/etc/systemd/system/resume-fix-pulseaudio@.service</code>:
</p>
<pre>[Unit]
Description=Fix PulseAudio after resume from suspend
After=suspend.target

[Service]
User=%I
Type=oneshot
Environment="XDG_RUNTIME_DIR=/run/user/%U"
ExecStart=/usr/bin/pasuspender /bin/true

[Install]
WantedBy=suspend.target
</pre>
<p>2. Enable it for your user account
</p>
<pre># systemctl enable resume-fix-pulseaudio@<i>YOUR_USERNAME_HERE</i>.service
</pre>
<p>3. Reload systemd
</p>
<pre># systemctl --system daemon-reload
</pre>
<h3>
<span id="ALSA_channels_mute_when_headphones_are_plugged.2Funplugged_improperly"></span><span class="mw-headline" id="ALSA_channels_mute_when_headphones_are_plugged/unplugged_improperly">ALSA channels mute when headphones are plugged/unplugged improperly</span>
</h3>
<p>If when you unplug your headphones or plug them in the audio remains muted in alsamixer on the wrong channel due to it being set to 0%, you may be able to fix it by opening <code>/etc/pulse/default.pa</code> and commenting out the line:
</p>
<pre>load-module module-switch-on-port-available
</pre>
<h3>
<span id="Volume_resets_to_50.25_every_few_seconds"></span><span class="mw-headline" id="Volume_resets_to_50%_every_few_seconds">Volume resets to 50% every few seconds</span>
</h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=alsa-tools">alsa-tools</a></span> and use:
</p>
<pre>$ hdajackretask
</pre>
<p>Set "Not Connected" to everything but the ports you are using. It seems the other unused audio ports on the motherboard interfere with the used ones.
Then if you want use the Boot Override to save this change between reboots. There is a possibility it is the Front Green Headphone that is causing the bug, if you need it override the Front Microphone to Headphone and the Front Green Headphone to "Not Connected" and use the Front Microphone port as your headphone port.
</p>
<p>More info about this problem: <a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/1585084">[2]</a>.
</p>
<h3>
<span id="Volume_low.2Ftoo_quiet_on_analog_headphones.2Fspeakers"></span><span class="mw-headline" id="Volume_low/too_quiet_on_analog_headphones/speakers">Volume low/too quiet on analog headphones/speakers</span>
</h3>
<p>If you added the <code>ignore_dB=1</code> option earlier to the <code>load-module module-udev-detect</code> line in your <code>/etc/pulse/default.pa</code>, try removing it.
</p>
<h2><span class="mw-headline" id="Microphone">Microphone</span></h2>
<h3><span class="mw-headline" id="Microphone_not_detected_by_PulseAudio">Microphone not detected by PulseAudio</span></h3>
<p>Determine the card and device number of your mic:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ arecord -l</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">**** List of CAPTURE Hardware Devices ****
card 0: PCH [HDA Intel PCH], device 0: ALC269VC Analog [ALC269VC Analog]
Subdevices: 1/1
Subdevice #0: subdevice #0
</pre>
<p>In <code>hw:<i>CARD</i>,<i>DEVICE</i></code> notation, you would specify the above device as <code>hw:0,0</code>.
</p>
<p>Then, edit <code>/etc/pulse/default.pa</code> and insert a <code>load-module</code> line specifying your device as follows:
</p>
<pre>load-module module-alsa-source device=hw:0,0
# the line above should be somewhere before the line below
.ifexists module-udev-detect.so
</pre>
<p>Finally, restart pulseaudio to apply the new settings:
</p>
<pre>$ pulseaudio -k ; pulseaudio -D
</pre>
<p>If everything worked correctly, you should now see your mic show up when running <code>pavucontrol</code> (under the <code>Input Devices</code> tab).
</p>
<h3><span class="mw-headline" id="PulseAudio_uses_wrong_microphone">PulseAudio uses wrong microphone</span></h3>
<p>If PulseAudio uses the wrong microphone, and changing the Input Device with Pavucontrol did not help, take a look at alsamixer. It seems that Pavucontrol does not always set the input source correctly.
</p>
<pre>$ alsamixer
</pre>
<p>Press <code>F6</code> and choose your sound card, e.g. HDA Intel. Now press <code>F5</code> to display all items. Try to find the item: <code>Input Source</code>. With the up/down arrow keys you are able to change the input source.
</p>
<p>Now try if the correct microphone is used for recording.
</p>
<h3>
<span id="No_microphone_on_ThinkPad_T400.2FT500.2FT420"></span><span class="mw-headline" id="No_microphone_on_ThinkPad_T400/T500/T420">No microphone on ThinkPad T400/T500/T420</span>
</h3>
<p>Run:
</p>
<pre>$ alsamixer -c 0
</pre>
<p>Unmute and maximize the volume of the "Internal Mic".
</p>
<p>Once you see the device with:
</p>
<pre>$ arecord -l
</pre>
<p>you might still need to adjust the settings. The microphone and the audio jack are duplexed. Set the configuration of the internal audio in pavucontrol to <i>Analog Stereo Duplex</i>.
</p>
<h3><span class="mw-headline" id="No_microphone_input_on_Acer_Aspire_One_and_Lenovo_Ideapad-310-15ISK">No microphone input on Acer Aspire One and Lenovo Ideapad-310-15ISK</span></h3>
<p>Install pavucontrol, unlink the microphone channels and turn down the left one to 0.
</p>
<h3><span class="mw-headline" id="Static_noise_in_microphone_recording">Static noise in microphone recording</span></h3>
<p>If we are getting static noise in Skype, gnome-sound-recorder, arecord, etc.'s recordings, then the sound card sample rate is incorrect. That is why there is static noise in Linux microphone recordings. To fix this, we need to set the sampling rate in <code>/etc/pulse/daemon.conf</code> for the sound hardware.
</p>
<p>In addition to the guide below, since <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/11.0/">PulseAudio 11</a> it is possible to set <code>avoid-resampling = yes</code> in <a href="..//Usage/Configuration/P/PulseAudio.html#daemon.conf" title="PulseAudio">daemon.conf</a>.
</p>
<h4>
<span id="Determine_sound_cards_in_the_system_.281.2F5.29"></span><span class="mw-headline" id="Determine_sound_cards_in_the_system_(1/5)">Determine sound cards in the system (1/5)</span>
</h4>
<p>This requires <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=alsa-utils">alsa-utils</a></span> and related packages to be installed:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ arecord --list-devices</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">**** List of CAPTURE Hardware Devices ****
card 0: Intel [HDA Intel], device 0: ALC888 Analog [ALC888 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
card 0: Intel [HDA Intel], device 2: ALC888 Analog [ALC888 Analog]
  Subdevices: 1/1
  Subdevice #0: subdevice #0
</pre>
<p>The sound card is <code>hw:<i>x</i>,<i>y</i></code> where <code><i>x</i></code> is the card number and <code><i>y</i></code> is the device number. In the above example, it is <code>hw:0,0</code>.
</p>
<h4>
<span id="Determine_sampling_rate_of_the_sound_card_.282.2F5.29"></span><span class="mw-headline" id="Determine_sampling_rate_of_the_sound_card_(2/5)">Determine sampling rate of the sound card (2/5)</span>
</h4>
<p>We aim to find the highest sample rate supported by the <code>hw:0,0</code> sound card using a <i>trial-and-error</i> procedure starting from a low value. When the top value is reached, we got a warning message:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">arecord -f dat -r 60000 -D hw:0,0 -d 5 test.wav</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">"Recording WAVE 'test.wav' : Signed 16 bit Little Endian, Rate 60000 Hz, Stereo
Warning: rate is not accurate (requested = 60000Hz, <b>got = 44100Hz</b>)
please, try the plug plugin</pre>
<p>observe, the <code>got = 44100Hz</code>. This is the maximum sampling rate of our card.
</p>
<h4>
<span id="Setting_the_sound_card.27s_sampling_rate_into_PulseAudio_configuration_.283.2F5.29"></span><span class="mw-headline" id="Setting_the_sound_card's_sampling_rate_into_PulseAudio_configuration_(3/5)">Setting the sound card's sampling rate into PulseAudio configuration (3/5)</span>
</h4>
<p>The default sampling rate in PulseAudio:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ grep "default-sample-rate" /etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">; default-sample-rate = 48000</pre>
<p><code>48000</code> is disabled and needs to be changed to <code>44100</code>:
</p>
<pre># sed 's/; default-sample-rate = 48000/default-sample-rate = 44100/g' -i /etc/pulse/daemon.conf
</pre>
<h4>
<span id="Restart_PulseAudio_to_apply_the_new_settings_.284.2F5.29"></span><span class="mw-headline" id="Restart_PulseAudio_to_apply_the_new_settings_(4/5)">Restart PulseAudio to apply the new settings (4/5)</span>
</h4>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<h4>
<span id="Finally_check_by_recording_and_playing_it_back_.285.2F5.29"></span><span class="mw-headline" id="Finally_check_by_recording_and_playing_it_back_(5/5)">Finally check by recording and playing it back (5/5)</span>
</h4>
<p>Let us record some voice using a microphone for, say, 10 seconds. Make sure the microphone is not muted and all
</p>
<pre>$ arecord -f cd -d 10 test-mic.wav
</pre>
<p>After 10 seconds, let us play the recording...
</p>
<pre>$ aplay test-mic.wav
</pre>
<p>Now hopefully, there is no static noise in microphone recording anymore.
</p>
<h4><span class="mw-headline" id="Another_Possible_Cause">Another Possible Cause</span></h4>
<p>Another possible cause is that your mic has two channels but only one channel can provide a valid sound signal. Some information can be found <a rel="nofollow"  href="https://github.com/MaartenBaert/ssr/issues/323#issuecomment-268230548">here</a>. The solution is to remap the stereo input to a mono input:
</p>
<p>1. Find your source name from the following command; mine is <code>alsa_input.pci-0000_00_1f.3.analog-stereo</code>
</p>
<pre>pacmd list-sources | grep 'name:.*input'
</pre>
<p>2. Edit <code>/etc/pulse/default.pa</code> and add the following lines, where INPUT_NAME is name of the input source from above step:
</p>
<pre>load-module module-remap-source source_name=record_mono master=INPUT_NAME master_channel_map=front-left channel_map=mono
set-default-source record_mono
</pre>
<p>3. Restart PulseAudio:
</p>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<p>Now <code>arecord</code> hopefully works. You may still need to change the <code>RecordStream from</code> setting to <code>Remapped Built-in Audio Analog Stereo</code> of a specific application in the <code>Recording</code> tab of <code>pavucontrol</code>.
</p>
<h4><span class="mw-headline" id="If_using_a_USB_microphone">If using a USB microphone</span></h4>
<p>Try plugging it into a different port (eg: ports at the back rather than front).
</p>
<h3>
<span id="No_microphone_on_Steam_or_Skype_with_enable-remixing_.3D_no"></span><span class="mw-headline" id="No_microphone_on_Steam_or_Skype_with_enable-remixing_=_no">No microphone on Steam or Skype with enable-remixing = no</span>
</h3>
<p>When you set <code>enable-remixing = no</code> on <code>/etc/pulse/daemon.conf</code> you may find that your microphone has stopped working on certain applications like Skype or Steam. This happens because these applications capture the microphone as mono only and because remixing is disabled, Pulseaudio will no longer remix your stereo microphone to mono.
</p>
<p>To fix this you need to tell Pulseaudio to do this for you:
</p>
<p>1. Find the name of the source 
</p>
<pre># pacmd list-sources
</pre>
<p>Example output edited for brevity, the name you need is in bold:
</p>
<pre>   index: 2
       name: &lt;<b>alsa_input.pci-0000_00_14.2.analog-stereo</b>&gt;
       driver: &lt;module-alsa-card.c&gt;
       flags: HARDWARE HW_MUTE_CTRL HW_VOLUME_CTRL DECIBEL_VOLUME LATENCY DYNAMIC_LATENCY
</pre>
<p>2. Add a remap rule to <code>/etc/pulse/default.pa</code>, use the name you found with the previous command, here we will use <b>alsa_input.pci-0000_00_14.2.analog-stereo</b> as an example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Remap microphone to mono
load-module module-remap-source master=alsa_input.pci-0000_00_14.2.analog-stereo master_channel_map=front-left,front-right channels=2 channel_map=mono,mono</pre>
<p>3. Restart Pulseaudio
</p>
<pre># pulseaudio -k
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Pulseaudio may fail to start if you do not exit a program that was using the microphone (e.g. if you tested on Steam before modifying the file), in which case you should exit the application and manually start Pulseaudio</div>
<pre># pulseaudio --start
</pre>
<h3><span class="mw-headline" id="Microphone_distorted_due_to_automatic_adjustment">Microphone distorted due to automatic adjustment</span></h3>
<p>If your microphone volume creeps up automatically and causes the sound to be distorted, you can fix it by disabling mic boost:
</p>
<p>In all files <code>/usr/share/pulseaudio/alsa-mixer/paths/analog-input*.conf</code>,
</p>
<ul>
<li>Under <code>[Element Capture]</code> set <code>volume</code> to <code>zero</code>
</li>
<li>Under <code>[Element Internal Mic Boost]</code> set <code>volume</code> to <code>zero</code>.</li>
<li>Under <code>[Element Int Mic Boost]</code> set <code>volume</code>  to <code>zero</code>.</li>
<li>Under <code>[Element Mic Boost]</code> set <code>volume</code>  to <code>zero</code>.</li>
</ul>
<p>including all variations such as <code>[Element Headphone Mic Boost]</code> and <code>[Element Mic Boost (+20dB)]</code>
</p>
<p>Then restart PulseAudio:
</p>
<pre># pulseaudio -k
</pre>
<h3><span class="mw-headline" id="Microphone_crackling_with_Realtek_ALC892">Microphone crackling with Realtek ALC892</span></h3>
<p>Sometimes ALC892 chips have crackling sound while recording using a microphone. Some Pulseaudio config changes may help:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">resample-method = src-sinc-best-quality
default-sample-format = s16le
default-sample-rate = 48000</pre>
<p>and add the <code>use_ucm</code> option to
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-udev-detect use_ucm=0 tsched=0</pre>
<p>then restart pulseaudio.
</p>
<h3><span class="mw-headline" id="Microphone_crackling_with_Azalia_chipsets">Microphone crackling with Azalia chipsets</span></h3>
<p>Some Azalia based chips have popping/crackling noise and distortion while recording using a microphone with PulseAudio. This can be fixed by loading the <code>snd-hda-intel</code> module with <code>position_fix</code> set to an appropriate value. This tells the module to use various DMA pointer fixes. Use trial and error to determine which value works for you. (<a rel="nofollow"  href="https://wiki.sabayon.org/index.php?title=HOWTO:_Resolve_Problems_with_HDA-Intel_Sound_Cards">source</a>)
</p>
<p>Create a new <code>modprobe.d</code> config:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/azalia-microphone.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options snd-hda-intel position_fix=1</pre>
<p>Valid values for <code>position_fix</code> are:
</p>
<ul>
<li>
<code>0</code> = Auto</li>
<li>
<code>1</code> = None</li>
<li>
<code>2</code> = POSBUF</li>
<li>
<code>3</code> = FIFO size</li>
</ul>
<p>then reload your modules.
</p>
<h3><span class="mw-headline" id="Echo_test">Echo test</span></h3>
<p>If you are unsure about your microphone setup, you can hear the input from the microphone in real-time by enabling the <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/User/Modules/#index57h3">loopback module</a> (<a rel="nofollow"  href="https://answers.launchpad.net/ubuntu/+source/pulseaudio/+question/83742">source</a>):
</p>
<pre>$ pactl load-module module-loopback
</pre>
<p>The module will show up in the <b>Recording</b> tab of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> program, where the source and volume can be configured. While latency should be low, it should be sufficient to get a feeling of the sound quality as you will hear yourself speak in the microphone. To make the change permanent, add the following pulseaudio configuration:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-loopback</pre>
<p>Watch out for feedback! Be ready to lower all volumes in case the microphone picks up the output from the loudspeakers. Naturally, it is better to run such a test with headphones.
</p>
<h2><span class="mw-headline" id="Audio_quality">Audio quality</span></h2>
<h3>
<span id="Enable_Echo.2FNoise-Cancellation"></span><span class="mw-headline" id="Enable_Echo/Noise-Cancellation">Enable Echo/Noise-Cancellation</span>
</h3>
<p>TOS does not load the Pulseaudio Echo-Cancellation module by default, therefore, we have to add it in <code>/etc/pulse/default.pa</code>. First you can test if the module is present with <code>pacmd</code> and entering <code>list-modules</code>. If you cannot find a line showing <code>name: &lt;module-echo-cancel&gt;</code> you have to add 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Enable Echo/Noise-Cancellation
load-module module-echo-cancel use_master_format=1 aec_method=webrtc aec_args="analog_gain_control=0\ digital_gain_control=1" source_name=echoCancel_source sink_name=echoCancel_sink
set-default-source echoCancel_source
set-default-sink echoCancel_sink</pre>
<p>then restart Pulseaudio
</p>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<p>and check if the module is activated by starting <code>pavucontrol</code>. Under <code>Recording</code> the input device should show <code>Echo-Cancel Source Stream from"</code>.
</p>
<p>Turning on <code>beamforming=1</code> in the aec_args can also significantly reduce background noise if you have more than one microphone (which is common on many new laptops). However, beamforming requires specifying your <code>mic_geometry</code> (see below).
</p>
<p>If you want existing streams to be automatically moved to the new sink and source, you have to load the <a href="#Automatically_switch_to_Bluetooth_or_USB_headset">module-switch-on-connect</a> with <code>ignore_virtual=no</code> before.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you plug in a USB sound card or headset, or you have for example a 5.1 Speaker configuration and plug in a headset on your front audio connectors after you have loaded the <code>module-echo-cancel</code>, you have to manually unload and load the <code>module-echo-cancel</code> again, because unfortunately there is no way to tell the module that it should automatically switch to the new default 'source_master' and 'source_sink'. See <a rel="nofollow"  href="https://gitlab.freedesktop.org/pulseaudio/pulseaudio/issues/196">[3]</a>.</div>
<h4>
<span id="Possible_.27aec_args.27_for_.27aec_method.3Dwebrtc.27"></span><span class="mw-headline" id="Possible_'aec_args'_for_'aec_method=webrtc'">Possible 'aec_args' for 'aec_method=webrtc'</span>
</h4>
<p>Here is a list of possible 'aec_args' for 'aec_method=webrtc' with their default values <a rel="nofollow"  href="https://github.com/pulseaudio/pulseaudio/blob/master/src/modules/echo-cancel/webrtc.cc">[4]</a><a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/User/Modules/#index45h3">[5]</a>:
</p>
<ul>
<li>
<code>analog_gain_control=1</code> - Analog AGC - 'Automatic Gain Control' done over changing the volume directly - Will most likely lead to <a href="#Microphone_distorted_due_to_automatic_adjustment">distortions</a>.</li>
<li>
<code>digital_gain_control=0</code> - Digital AGC - 'Automatic Gain Control' done in post processing (higher CPU load).</li>
<li>
<code>experimental_agc=0</code> - Allow enabling of the webrtc experimental AGC mechanism.</li>
<li>
<code>agc_start_volume=85</code> - Initial volume when using AGC - Possible values 0-255 - A too low initial volume may prevent the AGC algorithm from ever raising the volume high enough <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/9.0/">[6]</a>.</li>
<li>
<code>high_pass_filter=1</code> - ?</li>
<li>
<code>noise_suppression=1</code> - Noise suppression.</li>
<li>
<code>voice_detection=1</code> - VAD - Voice activity detection.</li>
<li>
<code>extended_filter=0</code> - The extended filter is more complex and less sensitive to incorrect delay reporting from the hardware than the regular filter. The extended filter mode is disabled by default, because it seemed produce worse results during double-talk <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/9.0/">[7]</a>.</li>
<li>
<code>intelligibility_enhancer=0</code> - Some bits for webrtc intelligibility enhancer.</li>
<li>
<code>drift_compensation=0</code> - Drift compensation to allow echo cancellation between different devices (such as speakers on your laptop and the microphone on your USB webcam). - only possible with "mobile=0".</li>
<li>
<code>beamforming=0</code> - This can significantly reduce background noise. See <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/User/Modules/#index45h3">[8]</a><a rel="nofollow"  href="https://arunraghavan.net/2016/06/beamforming-in-pulseaudio/">[9]</a>
<ul>
<li>
<code>mic_geometry=x1,y1,z1,x2,y2,z2</code> - Only with "beamforming=1".</li>
<li>
<code>target_direction=a,e,r</code> - Only with "beamforming=1". Note: If the module does not want to load with this argument, set azimuth (a) to the desired value, but set elevation (e) and radius (r) to 0.</li>
</ul>
</li>
<li>
<code>mobile=0</code> - ?
<ul>
<li>
<code>routing_mode=speakerphone</code> - Possible Values "quiet-earpiece-or-headset,earpiece,loud-earpiece,speakerphone,loud-speakerphone" - only valid with "mobile=1".</li>
<li>
<code>comfort_noise=1</code> - ? - only valid with "mobile=1".</li>
</ul>
</li>
</ul>
<h4><span class="mw-headline" id="Disable_audio_post_processing_in_certain_applications">Disable audio post processing in certain applications</span></h4>
<p>If you are using the <a href="#Enable_Echo/Noise-Cancellation">module-echo-cancel</a>, you probably do not want other applications to do additional audio post processing. Here is a list for disabling audio post processing in following applications:
</p>
<ul>
<li>Mumble:
<ol>
<li>Configure -&gt; Settings -&gt; Check 'Advanced' check box -&gt; Audio Input</li>
<li>Echo: Select 'Disabled'</li>
<li>Noise Suppression: Set slider to 'Off'</li>
<li>Max. Aplification: Set slider to '1.0'</li>
</ol>
</li>
<li>TeamSpeak:
<ol>
<li>Tools -&gt; Options -&gt; Capture</li>
<li>Uncheck: 'Typing attenuation', 'Remove background noise', 'Echo cancellation' and 'Echo reduction (Ducking)'</li>
</ol>
</li>
<li>Firefox: see <a href="..//Usage/Configuration/F/Firefox/Tweaks.html#Disable_WebRTC_audio_post_processing" class="mw-redirect" title="Firefox tweaks">Firefox tweaks#Disable WebRTC audio post processing</a>
</li>
<li>Steam:
<ol>
<li>In window "Friends List" -&gt; Manage friends list settings (gear symbol) -&gt; VOICE -&gt; Show Advanced Settings</li>
<li>Set the following sliders to "OFF": "Echo cancellation", "Noise cancellation", "Automatic volume/gain control"</li>
</ol>
</li>
<li>Skype:
<ol><li>Tools -&gt; Settings... -&gt; Audio &amp; Video -&gt; Microphone -&gt; Automatically adjust microphone settings -&gt; off</li></ol>
</li>
</ul>
<h4><span class="mw-headline" id="Script_for_reloading_module-echo-cancel">Script for reloading module-echo-cancel</span></h4>
<p>Since the module-echo-cancel is not always needed, or must be reloaded if the source_master or sink_master has changed, it is nice to have a easy way to load or reload the module-echo-cancel.
</p>
<p><a href="..//Usage/Configuration/H/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Create">Create</a> the following script and make it <a href="..//Usage/Configuration/H/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">echoCancelEnable.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
aecArgs="$*"
# If no "aec_args" are passed on to the script, use this "aec_args" as default:
[ -z "$aecArgs" ] &amp;&amp; aecArgs="analog_gain_control=0 digital_gain_control=1"
newSourceName="echoCancelSource"
newSinkName="echoCancelSink"

# "module-switch-on-connect" with "ignore_virtual=no" (needs PulseAudio 12 or higher) is needed to automatically move existing streams to a new (virtual) default source and sink.
if ! pactl list modules short | grep "module-switch-on-connect.*ignore_virtual=no" &gt;/dev/null 2&gt;&amp;1; then
	echo Load module \"module-switch-on-connect\" with \"ignore_virtual=no\"
	pactl unload-module module-switch-on-connect 2&gt;/dev/null
	pactl load-module module-switch-on-connect ignore_virtual=no
fi

# Reload "module-echo-cancel"
echo Reload \"module-echo-cancel\" with \"aec_args=$aecArgs\"
pactl unload-module module-echo-cancel 2&gt;/dev/null
if pactl load-module module-echo-cancel use_master_format=1 aec_method=webrtc aec_args=\"$aecArgs\" source_name=$newSourceName sink_name=$newSinkName; then
	# Set a new default source and sink, if module-echo-cancel has loaded successfully.
	pacmd set-default-source $newSourceName
	pacmd set-default-sink $newSinkName
fi
</pre>
<p>To run the script easily from the graphical environment, you can create a <a href="..//Usage/Configuration/D/Desktop_entries.html" class="mw-redirect" title="Desktop launcher">desktop launcher</a> for it.
</p>
<h3>
<span id="Glitches.2C_skips_or_crackling"></span><span class="mw-headline" id="Glitches,_skips_or_crackling">Glitches, skips or crackling</span>
</h3>
<p>The newer implementation of the PulseAudio sound server uses timer-based audio scheduling instead of the traditional, interrupt-driven approach. 
</p>
<p>Timer-based scheduling may expose issues in some ALSA drivers. On the other hand, other drivers might be glitchy without it on, so check to see what works on your system. 
</p>
<p>To turn timer-based scheduling off add <code>tsched=0</code> in <code>/etc/pulse/default.pa</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-udev-detect tsched=0</pre>
<p>Then restart the PulseAudio server:
</p>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<p>Do the reverse to enable timer-based scheduling, if not already enabled by default.
</p>
<p>If you are using Intel's <a href="https://en.wikipedia.org/wiki/IOMMU"  title="wikipedia:IOMMU">IOMMU</a> and experience glitches and/or skips, add <code>intel_iommu=igfx_off</code> to your kernel command line.
</p>
<p>Some Intel audio cards using the <code>snd-hda-intel</code> module need the otions <code>vid=8086 pid=8ca0 snoop=0</code>. In order to set them permanently, create/modify the following file including the line below.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/sound.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options snd-hda-intel vid=8086 pid=8ca0 snoop=0</pre>
<p>Please report any such cards to <a rel="nofollow"  href="http://www.freedesktop.org/wiki/Software/PulseAudio/Backends/ALSA/BrokenDrivers/">PulseAudio Broken Sound Driver page</a>
</p>
<h3><span class="mw-headline" id="Static_noise_when_using_headphones">Static noise when using headphones</span></h3>
<p>Time-based scheduling may be causing this, disable it as explained in <a href="#Glitches,_skips_or_crackling">#Glitches, skips or crackling</a>.
</p>
<p>Another reason you are encountering static noise in your headphone jack could be ALSA's loopback mixing.
</p>
<p>Make sure you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=alsa-utils">alsa-utils</a></span> installed, launch <code>alsamixer</code>, then select your audio device (pressing <code>F6</code>}), navigate all the way left using the <code>left arrow</code>, and stop on <b>Loopback</b>, if <b>Enabled</b> disable it using the <code>down arrow</code>. This should not impact audio playback or microphone recording negatively, unless you require loopback mixing.
</p>
<p>Some notebook models, like Dell XPS 13 9360, suffer from <a href="..//Usage/Configuration/D/Dell_XPS_13_(9360).html#Continuous_hissing_sound_with_headphones" title="Dell XPS 13 (9360)">continuous hissing sound</a> when a headphone is plugged in.
</p>
<p>Yet another reason for this symptom could be the power-saving mode of your audio device.<a rel="nofollow"  href="https://askubuntu.com/a/534082">[10]</a> If you followed <a href="..//Usage/Configuration/P/Power_management.html#Audio" title="Power management">Power management#Audio</a>, revert the changes and check if it solves the problem.
</p>
<h3><span class="mw-headline" id="Setting_the_default_fragment_number_and_buffer_size_in_PulseAudio">Setting the default fragment number and buffer size in PulseAudio</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-edit-clear.png" ><img alt="Tango-edit-clear.png" src="../../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="..//Usage/Configuration/H/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../../File:Tango-edit-clear.png" ><img alt="Tango-edit-clear.png" src="../../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Copied from Linux mint topic with few additions (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:PulseAudio/Troubleshooting">Talk:PulseAudio/Troubleshooting#</a>)</div>
</div>
<h4>
<span id="Disabling_timer-based_scheduling_.280.2F4.29"></span><span class="mw-headline" id="Disabling_timer-based_scheduling_(0/4)">Disabling timer-based scheduling (0/4)</span>
</h4>
<p>By default, PulseAudio uses timer-based scheduling. In this mode, fixed-size fragments are not used at all, and so the default-fragments and default-fragment-size-msec parameters are ignored.
To turn timer-based scheduling off add <code>tsched=0</code> in <code>/etc/pulse/default.pa</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-udev-detect tsched=0</pre>
<h4>
<span id="Decide_on_audio_device_parameters_.281.2F4.29"></span><span class="mw-headline" id="Decide_on_audio_device_parameters_(1/4)">Decide on audio device parameters (1/4)</span>
</h4>
<p>Instructions below will cause PulseAudio to use a fixed size and number for audio fragments. These settings directly affect latency and power consumption. The latency is determined as <code>default-fragments * default-fragment-size-msec</code>, and the interrupt rate (i.e. how often the application is notified that some sound has indeed been played) is <code>1000 / default-fragment-size-msec</code>. The considerations are:
</p>
<ul>
<li>The total number of fragments must be within the limits accepted by the hardware. Most sound cards are OK with two or more fragments, but some require three or more.</li>
<li>Giving the sound card more fragments than strictly necessary increases the latency, does not change power consumption, and does not remove the load from the scheduler. Therefore, it is advised only in the cases when the interrupts are not reliably delivered to the CPU, and one extra fragment beyond the minimum required should always be enough.</li>
<li>Giving the sound card bigger fragments increases latency and decreases power consumption.</li>
<li>Some applications (games and VoIP) request low latency and produce glitches when PulseAudio cannot fulfill their request.</li>
<li>Setting the latency too low will put a lot of stress on the scheduler, also resulting in glitches.</li>
</ul>
<p>If one doesn't care about excessive power consumption, then 2 or 3 fragments, 5 ms each, are a reasonable choice.
</p>
<h4>
<span id="Modify_PulseAudio.27s_configuration_file_.282.2F4.29"></span><span class="mw-headline" id="Modify_PulseAudio's_configuration_file_(2/4)">Modify PulseAudio's configuration file (2/4)</span>
</h4>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">default-fragments = <b>3</b>
default-fragment-size-msec = <b>5</b></pre>
<h4>
<span id="Restart_the_PulseAudio_daemon_.283.2F4.29"></span><span class="mw-headline" id="Restart_the_PulseAudio_daemon_(3/4)">Restart the PulseAudio daemon (3/4)</span>
</h4>
<pre>$ systemctl --user restart pulseaudio.service
</pre>
<h4>
<span id="See_if_it_helps_.284.2F4.29"></span><span class="mw-headline" id="See_if_it_helps_(4/4)">See if it helps (4/4)</span>
</h4>
<p>Run your applications, listen to the sounds they produce, inspect the journal.
</p>
<p>If the skips/pops/glitches are occasional and mostly correlated to the system being highly loaded: this is a scheduler problem, the latency needs to be increased.
</p>
<p>If there is metallic sound with the wrong speed from all applications: the most common reason is that you are trying to configure the fragment size which is way too small, like 1 ms. Don't do this.
</p>
<p>If some, but not all, applications produce a constant stream of glitches: this is an application that assumes a low-latency setup. So the fragment size must be decreased so that the application request becomes valid.
</p>
<h3><span class="mw-headline" id="Choppy_sound_with_analog_surround_sound_setup">Choppy sound with analog surround sound setup</span></h3>
<p>The low-frequency effects (LFE) or Subwoofer channel is not remixed per default. To enable it the following needs to be set in <code>/etc/pulse/daemon.conf</code> :
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">enable-lfe-remixing = yes</pre>
<p>You should also consider to set a proper crossover frequency for the LFE- channel.
The crossover frequency is the frequency up to which the audio signal is rerouted to the LFE sink.
The optimal crossover frequency in Hz depends on the size of all your speakers.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">lfe-crossover-freq = &lt;40-200&gt;</pre>
<h3><span class="mw-headline" id="Laggy_sound">Laggy sound</span></h3>
<p>This issue is due to incorrect buffer sizes. First verify that the variables <code>default-fragments</code> and <code>default-fragment-size-msec</code> are not being set to non default values in the file <code>/etc/pulse/daemon.conf</code>. If the issue is still present, try setting them to the following values:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">default-fragments = 5
default-fragment-size-msec = 2</pre>
<h3>
<span id="Choppy.2Fdistorted_sound"></span><span class="mw-headline" id="Choppy/distorted_sound">Choppy/distorted sound</span>
</h3>
<p>This can result from an incorrectly set sample rate. Try the following setting:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/daemon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">avoid-resampling = yes #(Needs <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/11.0/">PA11</a> or higher)
default-sample-rate = 48000</pre>
<p>and restart the PulseAudio server.
</p>
<p>If one experiences choppy sound in applications using <a href="https://en.wikipedia.org/wiki/OpenAL"  title="wikipedia:OpenAL">OpenAL</a>, change the sample rate in <code>/etc/openal/alsoft.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/openal/alsoft.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">frequency = 48000</pre>
<p>Setting the PCM volume above 0 dB can cause <a href="https://en.wikipedia.org/wiki/Clipping_(audio)"  title="wikipedia:Clipping (audio)">clipping</a>. Running <code>alsamixer</code> will allow you to see if this is the problem and if so fix it. Note that ALSA may not <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/User/PulseAudioStoleMyVolumes/">correctly export</a> the dB information to PulseAudio. Try the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-udev-detect ignore_dB=1</pre>
<p>and restart the PulseAudio server. See also <a href="#No_sound_below_a_volume_cutoff">#No sound below a volume cutoff</a><sup>[<a href="..//Usage/Configuration/T/TOS Wiki:Requests.html#Broken_section_links" class="mw-redirect" title="TOS Wiki:Requests">broken link</a>: invalid section]</sup>.
</p>
<h3><span class="mw-headline" id="Sound_stuttering_when_streaming_over_network">Sound stuttering when streaming over network</span></h3>
<p>When streaming over Wi-Fi using module-native-protocol-tcp you can experience periodic sound stuttering with buffer underruns. As a workaround you can try to use rtp protocol. On sender side create rtp sink:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-null-sink sink_name=rtp
load-module module-rtp-send source=rtp.monitor</pre>
<p>and switch to it:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set-default-sink rtp</pre>
<p>On receiver side load rtp module:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-rtp-recv</pre>
<h3><span class="mw-headline" id="Pops_when_starting_and_stopping_playback">Pops when starting and stopping playback</span></h3>
<p>PulseAudio can suspend sinks after a period of inactivity. This can make an audible noise (like a crack/pop/scratch). Sometimes even when move the slider volume, or open and close windows (KDE4). This behavior is enabled in default configuration files:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-suspend-on-idle</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/system.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-suspend-on-idle</pre>
<p>Commenting that line in relevant file fixes that issue. A better solution is to add the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.include /etc/pulse/default.pa
unload-module module-suspend-on-idle</pre>
<h2><span class="mw-headline" id="Hardware_and_Cards">Hardware and Cards</span></h2>
<h3><span class="mw-headline" id="No_HDMI_sound_output_after_some_time_with_the_monitor_turned_off">No HDMI sound output after some time with the monitor turned off</span></h3>
<p>The monitor is connected via HDMI/DisplayPort, and the audio jack is plugged in the headphone jack of the monitor, but PulseAudio insists that it is unplugged:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pactl list sinks</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
hdmi-output-0: HDMI / DisplayPort (priority: 5900, not available)
...
</pre>
<p>This leads to no sound coming from HDMI output. A workaround for this is to switch to another VT and back again. If that does not work, try: turn off your monitor, switch to another VT, turn on your monitor, and switch back. This problem has been reported by ATI/Nvidia/Intel users.
</p>
<p>Another workaround could be to disable the switch-on-port-available module by commenting it in /etc/pulse/default.pa <a rel="nofollow"  href="https://bugs.freedesktop.org/show_bug.cgi?id=93946#c36">[11]</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
### Should be after module-*-restore but before module-*-detect
#load-module module-switch-on-port-available
...
</pre>
<h3><span class="mw-headline" id="No_HDMI_sound_using_a_headless_server">No HDMI sound using a headless server</span></h3>
<p>You might want to use HDMI audio with your a/v receiver but no display. HDMI requires a video signal, which we have from the virtual terminal. 
</p>
<p>By default, this signal is turned off after 600 seconds, thus the audio sink gets lost as well.
</p>
<p>To prevent screen blanking, add <code>consoleblank=0</code> to the kernel command line.
</p>
<h3><span class="mw-headline" id="No_cards">No cards</span></h3>
<p>If PulseAudio starts, run <code>pacmd list</code>. If no cards are reported, make sure that the ALSA devices are not in use:
</p>
<pre>$ fuser -v /dev/snd/*
$ fuser -v /dev/dsp
</pre>
<p>Make sure any applications using the pcm or dsp files are shut down before restarting PulseAudio.
</p>
<h3>
<span id="Starting_an_application_interrupts_other_app.27s_sound"></span><span class="mw-headline" id="Starting_an_application_interrupts_other_app's_sound">Starting an application interrupts other app's sound</span>
</h3>
<p>If you have trouble with some applications (such as TeamSpeak or Mumble) interrupting sound output of already running applications (such as Deadbeaf), you can solve this by commenting out the line <code>load-module module-role-cork</code> in <code>/etc/pulse/default.pa</code> like shown below:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Cork music/video streams when a phone stream is active
# load-module module-role-cork
</pre>
<p>Then restart pulseaudio by using your normal user account with
</p>
<pre>$ pulseaudio -k
$ pulseaudio --start
</pre>
<h3>
<span id="The_only_device_shown_is_.22dummy_output.22_or_newly_connected_cards_are_not_detected"></span><span class="mw-headline" id='The_only_device_shown_is_"dummy_output"_or_newly_connected_cards_are_not_detected'>The only device shown is "dummy output" or newly connected cards are not detected</span>
</h3>
<p>If the only playback device is the Dummy Output, PulseAudio cannot access your sound devices. It is possible there is an issue with logind giving permissions, see <a href="..//Usage/Configuration/G/General_troubleshooting.html#Session_permissions" title="General troubleshooting">General troubleshooting#Session permissions</a> for more information.
</p>
<p>An application might also not have been configured to work with PulseAudio. This happens with <a href="..//Usage/Configuration/F/FluidSynth.html#Conflicting_with_PulseAudio" title="FluidSynth">FluidSynth</a> for example. To see which application is responsible for a direct access to the sound card via alsa, run the following command:
</p>
<pre># fuser -v /dev/snd/*
</pre>
<p>Try to close these applications. pulseaudio, if running, should take again precedence over these applications and all the applications relying on pulseaudio should work again like expected.
</p>
<h3>
<span id="No_HDMI_5.2F7.1_Selection_for_Device"></span><span class="mw-headline" id="No_HDMI_5/7.1_Selection_for_Device">No HDMI 5/7.1 Selection for Device</span>
</h3>
<p>If you are unable to select 5/7.1 channel output for a working HDMI device, then turning off "stream device reading" in <code>/etc/pulse/default.pa</code> might help. 
</p>
<p>See <a href="#Fallback_device_is_not_respected">#Fallback device is not respected</a>.
</p>
<h3><span class="mw-headline" id="Failed_to_create_sink_input:_sink_is_suspended">Failed to create sink input: sink is suspended</span></h3>
<p>If you do not have any output sound and receive dozens of errors related to a suspended sink in your <code>journalctl -b</code> log, then backup first and then delete your user-specific pulse folders:
</p>
<pre>$ rm -r ~/.pulse ~/.pulse-cookie ~/.config/pulse
</pre>
<h3>
<span id="Simultaneous_output_to_multiple_sound_cards_.2F_devices"></span><span class="mw-headline" id="Simultaneous_output_to_multiple_sound_cards_/_devices">Simultaneous output to multiple sound cards / devices</span>
</h3>
<p>Simultaneous output to two different devices can be very useful. For example, being able to send audio to your A/V receiver via your graphics card's HDMI output, while also sending the same audio through the analogue output of your motherboard's built-in audio. This is much less hassle than it used to be (in this example, we are using GNOME desktop).
</p>
<p>Using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=paprefs">paprefs</a></span>, simply select "Add virtual output device for simultaneous output on all local sound cards" from under the "Simultaneous Output" tab. Then, under GNOME's "sound settings", select the simultaneous output you have just created.
</p>
<p>If this does not work, try adding the following to <code>~/.asoundrc</code>:
</p>
<pre>pcm.dsp {
   type plug
   slave.pcm "dmix"
}
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Simultaneous output can also be achieved manually using alsamixer. Disable "auto mute" item, then unmute other output sources you want to hear and increase their volume.</div>
<h3><span class="mw-headline" id="Simultaneous_output_to_multiple_sinks_on_the_same_sound_card_not_working">Simultaneous output to multiple sinks on the same sound card not working</span></h3>
<p>This can be useful for users who have multiple sound sources and want to play them on different sinks/outputs. 
An example use-case for this would be if you play music and also voice chat and want to output music to speakers (in this case Digital S/PDIF) and voice to headphones. (Analog)
</p>
<p>This is sometimes auto detected by PulseAudio but not always. If you know that your sound card can output to both Analog and S/PDIF at the same time and PulseAudio does not have this option in its profiles in pavucontrol, or veromix then you probably need to create a configuration file for your sound card.
</p>
<p>More in detail you need to create a profile-set for your specific sound card.
This is done in two steps mostly.
</p>
<ul>
<li>Create udev rule to make PulseAudio choose your PulseAudio configuration file specific to the sound card.</li>
<li>Create the actual configuration.</li>
</ul>
<p>Create a pulseaudio udev rule.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This is only an example for Asus Xonar Essence STX.
Read <a href="..//Usage/Configuration/U/Udev.html" title="Udev">udev</a> to find out the correct values.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Your configuration file should have lower number than the original PulseAudio rule to take effect.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/udev/rules.d/90-pulseaudio-Xonar-STX.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ACTION=="change", SUBSYSTEM=="sound", KERNEL=="card*", \
ATTRS{subsystem_vendor}=="0x1043", ATTRS{subsystem_device}=="0x835c", ENV{PULSE_PROFILE_SET}="asus-xonar-essence-stx.conf" 
</pre>
<p>Now, create a configuration file. If you bother, you can start from scratch and make it saucy. However you can also use the default configuration file, rename it, and then add your profile there that you know works. Less pretty but also faster.
</p>
<p>To enable multiple sinks for Asus Xonar Essence STX you need only to add this in.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>asus-xonar-essence-stx.conf</code> also includes all code/mappings from <code>default.conf</code>.</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/pulseaudio/alsa-mixer/profile-sets/asus-xonar-essence-stx.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Profile analog-stereo+iec958-stereo]
description = Analog Stereo Duplex + Digital Stereo Output
input-mappings = analog-stereo
output-mappings = analog-stereo iec958-stereo
skip-probe = yes
</pre>
<p>This will auto-profile your Asus Xonar Essence STX with default profiles and add your own profile so you can have multiple sinks.
</p>
<p>You need to create another profile in the configuration file if you want to have the same functionality with AC3 Digital 5.1 output.
</p>
<p><a rel="nofollow"  href="http://www.freedesktop.org/wiki/Software/PulseAudio/Backends/ALSA/Profiles/">See PulseAudio article about profiles</a>
</p>
<h3><span class="mw-headline" id="Some_profiles_like_SPDIF_are_not_enabled_by_default_on_the_card">Some profiles like SPDIF are not enabled by default on the card</span></h3>
<p>Some profiles like IEC-958 (i.e. S/PDIF) may not be enabled by default on the selected sink. Each time the system starts up, the card profile is disabled and the pulseaudio daemon cannot select it.
You have to add the profile selection to you default.pa file. 
Verify the card and profile name with :
</p>
<pre>$ pacmd list-cards
</pre>
<p>Then edit the config to add the profile
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">## Replace with your card name and the profile you want to activate
set-card-profile alsa_card.pci-0000_00_1b.0 output:iec958-stereo+input:analog-stereo
</pre>
<p>Pulse audio will add this profile the pool of available profiles
</p>
<h3>
<span id="Only_S.2FPDIF_output_available"></span><span class="mw-headline" id="Only_S/PDIF_output_available">Only S/PDIF output available</span>
</h3>
<p>This might happen if PulseAudio use the wrong output device. Firstly, set up proper card profile:
</p>
<pre>$ pacmd set-card-profile alsa_card.pci-0000_00_1f.3 output:analog-stereo
</pre>
<p>or
</p>
<pre>$ pacmd set-card-profile alsa_card.pci-0000_00_1f.3 output:analog-stereo+input:analog-stereo
</pre>
<p>Replace <code>alsa_card.pci-0000_00_1f.3</code> with your card, and <code>output:analog-stereo</code> or <code>output:analog-stereo+input:analog-stereo</code> with your profile, remember to choose the profile with analog. Using shell auto completion could help you a lot. One could also use check available cards and profiles with:
</p>
<pre>$ pacmd list-cards
</pre>
<p>One might also need to set sink port by:
</p>
<pre>$ pacmd set-sink-port alsa_output.pci-0000_00_1f.3.analog-stereo analog-output-headphones
</pre>
<p>Check available sink ports with:
</p>
<pre>$ pacmd list-sinks
</pre>
<p>To keep these setting, add them to PulseAudio's configuration file <code>default.pa</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.include /etc/pulse/default.pa

set-card-profile alsa_card.pci-0000_00_1f.3 output:analog-stereo+input:analog-stereo
set-sink-port alsa_output.pci-0000_00_1f.3.analog-stereo analog-output-headphones
</pre>
<h2><span class="mw-headline" id="Bluetooth">Bluetooth</span></h2>
<h3><span class="mw-headline" id="Disable_Bluetooth_support">Disable Bluetooth support</span></h3>
<p>If you do not use Bluetooth, you may experience the following error in your journal:
</p>
<pre>bluez5-util.c: GetManagedObjects() failed: org.freedesktop.DBus.Error.ServiceUnknown: The name org.bluez was not provided by any .service files
</pre>
<p>To disable Bluetooth support in PulseAudio, make sure that the following lines are commented out in the configuration file in use (<code>~/.config/pulse/default.pa</code> or <code>/etc/pulse/default.pa</code>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Automatically load driver modules for Bluetooth hardware
#.ifexists module-bluetooth-policy.so
#load-module module-bluetooth-policy
#.endif

#.ifexists module-bluetooth-discover.so
#load-module module-bluetooth-discover
#.endif
</pre>
<h3><span class="mw-headline" id="Bluetooth_headset_replay_problems">Bluetooth headset replay problems</span></h3>
<p>Some user <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=117420">reports</a> huge delays or even no sound when the Bluetooth connection does not send any data. This is due to the <code>module-suspend-on-idle</code> module, which automatically suspends sinks/sources on idle. As this can cause problems with headset, the responsible module can be deactivated.
</p>
<p>To disable loading of the <code>module-suspend-on-idle</code> module, comment out the following line in the configuration file in use (<code>~/.config/pulse/default.pa</code> or <code>/etc/pulse/default.pa</code>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">### Automatically suspend sinks/sources that become idle for too long
#load-module module-suspend-on-idle
</pre>
<p>Finally restart PulseAudio to apply the changes.
</p>
<h3><span class="mw-headline" id="Automatically_switch_to_Bluetooth_or_USB_headset">Automatically switch to Bluetooth or USB headset</span></h3>
<p>Add the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># automatically switch to newly-connected devices
load-module module-switch-on-connect
# or switch also to newly-connected virtual devices
load-module module-switch-on-connect ignore_virtual=no</pre>
<p>Since <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/11.0/">PulseAudio 11</a> USB and bluetooth devices are preferred over internal sound cards by default, but as in the above link described, you still need module-switch-on-connect to also moves existing streams to the new sink.
</p>
<p>Since <a rel="nofollow"  href="https://www.freedesktop.org/wiki/Software/PulseAudio/Notes/12.0/">PulseAudio 12</a> virtual devices are ignored by default.
If you do not want this behavior because you want to move existing streams to freshly loaded <a href="#Enable_Echo/Noise-Cancellation">module-echo-cancel</a> for example, you have to add <code>ignore_virtual=no</code>.
</p>
<h3><span class="mw-headline" id="My_Bluetooth_device_is_paired_but_does_not_play_any_sound">My Bluetooth device is paired but does not play any sound</span></h3>
<p><a href="..//Usage/Configuration/B/Bluetooth_headset.html#A2DP_not_working_with_PulseAudio" title="Bluetooth headset">See the article in Bluetooth headset section</a>
</p>
<p>Starting from PulseAudio 2.99 and bluez 4.101 you should <b>avoid</b> using Socket interface. Do NOT use:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/bluetooth/audio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
Enable=Socket</pre>
<p>If you face problems with A2DP and PA 2.99 make sure you have <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=sbc">sbc</a></span> library.
</p>
<h2><span class="mw-headline" id="Applications">Applications</span></h2>
<h3><span class="mw-headline" id="Flash_content">Flash content</span></h3>
<p>Since Adobe Flash does not directly support PulseAudio, the recommended way is to <a href="..//Usage/Configuration/P/PulseAudio.html#ALSA" title="PulseAudio">configure ALSA to use the virtual PulseAudio sound card</a>.
</p>
<p>If Flash audio is lagging, you may try to have Flash access ALSA directly. See <a href="..//Usage/Configuration/P/PulseAudio.html#ALSA/dmix_without_grabbing_hardware_device" title="PulseAudio">PulseAudio#ALSA/dmix without grabbing hardware device</a> for details.
</p>
<h3><span class="mw-headline" id="Permission_errors_bug">Permission errors bug</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pulseaudio --start</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">E: [autospawn] core-util.c: Failed to create secure directory (/run/user/1000/pulse): Operation not permitted
W: [autospawn] lock-autospawn.c: Cannot access autospawn lock.
E: [pulseaudio] main.c: Failed to acquire autospawn lock
</pre>
<p>Known programs that changes permissions for <code>/run/user/<i>user id</i>/pulse</code> when using <a href="..//Usage/Configuration/P/Polkit.html" title="Polkit">Polkit</a> for root elevation:
</p>
<ul><li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/sakis3g/">sakis3g</a></span><sup><small>AUR</small></sup>
</li></ul>
<p>As a workaround, include <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=kdesu">kdesu</a></span> in a <a href="..//Usage/Configuration/D/Desktop_entries.html" class="mw-redirect" title="Desktop entry">desktop entry</a>, or add <code><i>username</i> ALL=NOPASSWD: /usr/bin/<i>program_name</i></code> to <a href="..//Usage/Configuration/S/Sudo.html#Configuration" class="mw-redirect" title="Sudoers">sudoers</a> to run it with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=sudo">sudo</a></span> without a password.
</p>
<p>The other workaround is to uncomment and set <code>daemonize = yes</code> in the <code>/etc/pulse/daemon.conf</code>.
</p>
<p>See also <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?id=135955">[12]</a>.
</p>
<h3><span class="mw-headline" id="Audacity">Audacity</span></h3>
<p>To work with PulseAudio, Audacity requires the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pulseaudio-alsa">pulseaudio-alsa</a></span> is installed. This provides the <code>pulse:...</code> playback and recording devices.
</p>
<p>When starting Audacity you may find that your headphones no longer work. This can be because Audacity is trying to use them as a recording device. To fix this, open Audacity, then set its recording device to <code>pulse:Internal Mic:0</code>.
</p>
<p>Under some circumstances, playback may be distorted, very fast, or freeze, as discussed in the <a rel="nofollow"  href="http://wiki.audacityteam.org/wiki/Linux_Issues#ALSA_and_other_sound_systems">Audacity Wiki's Linux Issues page</a>.
</p>
<p>The solution proposed in this page may work: start Audacity with:
</p>
<pre>$ env PULSE_LATENCY_MSEC=30 audacity
</pre>
<p>If the solution above does not fix this issue, one may wish to temporarily disable pulseaudio while running Audacity by using the <code>pasuspender</code> command:
</p>
<pre>$ pasuspender -- audacity
</pre>
<p>Then, be sure to select the appropriate ALSA input and output devices in Audacity.
</p>
<p>See also <a href="#Setting_the_default_fragment_number_and_buffer_size_in_PulseAudio">#Setting the default fragment number and buffer size in PulseAudio</a>.
</p>
<h3><span class="mw-headline" id="OpenAL">OpenAL</span></h3>
<p>Some games may prevent you from switching the output device. Trying to move the sink with <code>pactl</code> gives the following error:
</p>
<pre>pactl move-sink-input 11 alsa_output.pci-0000_01_00.1.hdmi-stereo-extra1
Failure: Invalid argument
</pre>
<p>OpenAL needs to be configured to allow moving the sink:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.alsoftrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[pulse]
allow-moves = true</pre>
<h2><span class="mw-headline" id="Other_Issues">Other Issues</span></h2>
<h3><span class="mw-headline" id="Bad_configuration_files">Bad configuration files</span></h3>
<p>After starting PulseAudio, if the system outputs no sound, it may be necessary to delete the contents of <code>~/.config/pulse</code> and/or <code>~/.pulse</code>. PulseAudio will automatically create new configuration files on its next start.
</p>
<h3><span class="mw-headline" id="Cannot_update_configuration_of_sound_device_in_pavucontrol">Cannot update configuration of sound device in pavucontrol</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> is a handy GUI utility for configuring PulseAudio. Under its 'Configuration' tab, you can select different profiles for each of your sound devices e.g. analogue stereo, digital output (IEC958), HDMI 5.1 Surround etc.
</p>
<p>However, you may run into an instance where selecting a different profile for a card results in the pulse daemon crashing and auto restarting without the new selection "sticking". If this occurs, use the other useful GUI tool, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=paprefs">paprefs</a></span>, to check under the "Simultaneous Output" tab for a virtual simultaneous device. If this setting is active (checked), it will prevent you changing any card's profile in pavucontrol. Uncheck this setting, then adjust your profile in pavucontrol prior to re-enabling simultaneous output in paprefs.
</p>
<h3><span class="mw-headline" id="Failed_to_create_sink_input:_sink_is_suspended_2">Failed to create sink input: sink is suspended</span></h3>
<p>If you do not have any output sound and receive dozens of errors related to a suspended sink in your <code>journalctl -b</code> log, then backup first and then delete your user-specific pulse folders:
</p>
<pre>$ rm -r ~/.pulse ~/.pulse-cookie ~/.config/pulse
</pre>
<h3><span class="mw-headline" id="Pulse_overwrites_ALSA_settings">Pulse overwrites ALSA settings</span></h3>
<p>PulseAudio usually overwrites the ALSA settings — for example set with alsamixer — at start-up, even when the ALSA daemon is loaded. Since there seems to be no other way to restrict this behaviour, a workaround is to restore the ALSA settings again after PulseAudio has started. Add the following command to <code>.xinitrc</code> or <code>.bash_profile</code> or any other <a href="..//Usage/Configuration/A/Autostarting.html" class="mw-redirect" title="Autostart">autostart</a> file:
</p>
<pre>restore_alsa() {
 while [ -z "$(pidof pulseaudio)" ]; do
  sleep 0.5
 done
 alsactl -f /var/lib/alsa/asound.state restore 
}
restore_alsa &amp;
</pre>
<h3><span class="mw-headline" id="Prevent_Pulse_from_restarting_after_being_killed">Prevent Pulse from restarting after being killed</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-edit-cut.png" ><img alt="Tango-edit-cut.png" src="../../File:Tango-edit-cut.png" decoding="async" width="48" height="48"></a><b>This section is being considered for removal.</b><a href="../../File:Tango-edit-cut.png" ><img alt="Tango-edit-cut.png" src="../../File:Tango-edit-cut.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Obsolete due to <a href="..//Usage/Configuration/P/PulseAudio.html#Running" title="PulseAudio">PulseAudio#Running</a>. Controlling systemd units is explained in <a href="..//Usage/Configuration/S/Systemd.html#Using_units" title="Systemd">systemd#Using units</a>. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:PulseAudio/Troubleshooting">Talk:PulseAudio/Troubleshooting#</a>)</div>
</div>
<p>Sometimes you may wish to temporarily disable Pulse. In order to do so you will have to prevent Pulse from restarting after being killed. To disable autospawning you can <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?pid=1807567#p1807567">issue</a>:
</p>
<pre>$ systemctl --user mask pulseaudio.socket
$ systemctl --user stop pulseaudio
</pre>
<p>To re-enable autospawning:
</p>
<pre>$ systemctl --user unmask pulseaudio.socket
</pre>
<p>On older systems you could set this option:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/pulse/client.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Disable autospawning the PulseAudio daemon
autospawn = no</pre>
<h3><span class="mw-headline" id="Daemon_startup_failed">Daemon startup failed</span></h3>
<p>Try resetting PulseAudio:
</p>
<pre>$ rm -rf /tmp/pulse* ~/.pulse* ~/.config/pulse
$ pulseaudio -k
$ pulseaudio --start
</pre>
<ul>
<li>Check that options for sinks are set up correctly.</li>
<li>If you configured in default.pa to load and use the OSS modules then check with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=lsof">lsof</a></span> that <code>/dev/dsp</code> device is not used by another application.</li>
<li>Set a preferred working resample method. Use <code>pulseaudio --dump-resample-methods</code> to see a list with all available resample methods you can use.</li>
<li>To get details about currently appeared unfixed errors or just get status of daemon use commands like <code>pax11publish -d</code> and <code>pulseaudio -v</code> where <code>v</code> option can be used multiple time to set verbosity of log output equal to the <code>--log-level[=LEVEL]</code> option where LEVEL is from 0 to 4. See the <a href="#Outputs_by_PulseAudio_error_status_check_utilities">#Outputs by PulseAudio error status check utilities</a> section.</li>
</ul>
<p>See also man pages for <span class="plainlinks archwiki-template-man" title="$ man 1 pax11publish"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/pax11publish.1">pax11publish(1)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 1 pulseaudio"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/pulseaudio.1">pulseaudio(1)</a></span> for more details.
</p>
<h4><span class="mw-headline" id="Outputs_by_PulseAudio_error_status_check_utilities">Outputs by PulseAudio error status check utilities</span></h4>
<p>If the <code>pax11publish -d</code> shows error like:
</p>
<pre>N: [pulseaudio] main.c: User-configured server at "user", refusing to start/autospawn.
</pre>
<p>then run <code>pax11publish -r</code> command then could be also good to logout and login again.
</p>
<p>If the <code>pulseaudio -vvvv</code> command shows error like:
</p>
<pre>E: [pulseaudio] module-udev-detect.c: You apparently ran out of inotify watches, probably because Tracker/Beagle took them all away. I wished people would do their homework first and fix inotify before using it for watching whole directory trees which is something the current inotify is certainly not useful for. Please make sure to drop the Tracker/Beagle guys a line complaining about their broken use of inotify.
</pre>
<p>This can be resolved temporary by:
</p>
<pre>$ echo 100000 &gt; /proc/sys/fs/inotify/max_user_watches
</pre>
<p>For permanent use save settings in the <i>99-sysctl.conf</i> file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/99-sysctl.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Increase inotify max watchs per user
fs.inotify.max_user_watches = 100000</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> It may cause much bigger consumption of memory by kernel.</div>
<p><b>See also</b> 
</p>
<ul>
<li>
<a rel="nofollow"  href="http://www.linuxinsight.com/proc_sys_fs_inotify.html">proc_sys_fs_inotify</a><sup title="Last check status: domain name not resolved">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot"  title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-01 ⓘ]</sup> and <a rel="nofollow"  href="http://lwn.net/Articles/604686/">dnotify, inotify</a>- more details about <i>inotify/max_user_watches</i>
</li>
<li><a rel="nofollow"  href="http://stackoverflow.com/questions/535768/what-is-a-reasonable-amount-of-inotify-watches-with-linux?answertab=votes#tab-top">reasonable amount of inotify watches with Linux</a></li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 7 inotify"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/inotify.7">inotify(7)</a></span> - man page</li>
</ul>
<h3><span class="mw-headline" id="Daemon_already_running">Daemon already running</span></h3>
<p>On some systems, PulseAudio may be started multiple times. journalctl will report:
</p>
<pre>[pulseaudio] pid.c: Daemon already running.
</pre>
<p>Make sure to use only one method of autostarting applications. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pulseaudio">pulseaudio</a></span> includes these files:
</p>
<ul>
<li><code>/etc/X11/xinit/xinitrc.d/pulseaudio</code></li>
<li><code>/etc/xdg/autostart/pulseaudio.desktop</code></li>
<li><code>/etc/xdg/autostart/pulseaudio-kde.desktop</code></li>
</ul>
<p>Also check user autostart files and directories, such as <a href="..//Usage/Configuration/X/Xinit.html#xinitrc" class="mw-redirect" title="Xinitrc">xinitrc</a>, <code>~/.config/autostart/</code> etc.
</p>
<h3><span class="mw-headline" id="Subwoofer_stops_working_after_end_of_every_song">Subwoofer stops working after end of every song</span></h3>
<p>Known issue: <a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/494099">https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/494099</a>
</p>
<p>To fix this, <code>enable-lfe-remixing = yes</code> must be set as described in <a href="#Choppy_sound_with_analog_surround_sound_setup">#Choppy sound with analog surround sound setup</a>.
</p>
<h3>
<span id="Unable_to_select_surround_configuration_other_than_.22Surround_4.0.22"></span><span class="mw-headline" id='Unable_to_select_surround_configuration_other_than_"Surround_4.0"'>Unable to select surround configuration other than "Surround 4.0"</span>
</h3>
<p>If you are unable to set 5.1 surround output in pavucontrol because it only shows "Analog Surround 4.0 Output", open the ALSA mixer and change the output configuration there to 6 channels. Then restart pulseaudio, and pavucontrol will list many more options.
</p>
<h3><span class="mw-headline" id="Realtime_scheduling">Realtime scheduling</span></h3>
<p>If rtkit does not work, you can manually set up your system to run PulseAudio with real-time scheduling, which can help performance. To do this, add the following lines to <code>/etc/security/limits.conf</code>:
</p>
<pre>@pulse-rt - rtprio 9
@pulse-rt - nice -11
</pre>
<p>Afterwards, you need to add your user to the <code>pulse-rt</code> group:
</p>
<pre># gpasswd -a &lt;user&gt; pulse-rt
</pre>
<h3>
<span id="pactl_.22invalid_option.22_error_with_negative_percentage_arguments"></span><span class="mw-headline" id='pactl_"invalid_option"_error_with_negative_percentage_arguments'>pactl "invalid option" error with negative percentage arguments</span>
</h3>
<p><code>pactl</code> commands that take negative percentage arguments will fail with an 'invalid option' error. Use the standard shell '--' pseudo argument
to disable argument parsing before the negative argument. <i>e.g.</i> <code>pactl set-sink-volume 1 -- -5%</code>.
</p>
<h3><span class="mw-headline" id="Fallback_device_is_not_respected">Fallback device is not respected</span></h3>
<p>PulseAudio does not have a true default device. Instead it uses a <a rel="nofollow"  href="http://www.freedesktop.org/wiki/Software/PulseAudio/Documentation/User/DefaultDevice/">"fallback"</a>, which only applies to new sound streams. This means previously run applications are not affected by the newly set fallback device.
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=gnome-control-center">gnome-control-center</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=mate-media">mate-media</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/paswitch/">paswitch</a></span><sup><small>AUR</small></sup> handle this gracefully. Alternatively: 
</p>
<p>1. Move the old streams in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> manually to the new sound card.
</p>
<p>2. Stop Pulse, erase the "stream-volumes" in <code>~/.config/pulse</code> and/or <code>~/.pulse</code> and restart Pulse. This also resets application volumes.
</p>
<p>3. Disable stream device reading. This may be not wanted when using different soundcards with different applications.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/default.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">load-module module-stream-restore restore_device=false</pre>
<h3>
<span id="RTP.2FUDP_packet_flood"></span><span class="mw-headline" id="RTP/UDP_packet_flood">RTP/UDP packet flood</span>
</h3>
<p>In some cases the default configuration might flood the network with UDP packets.<a rel="nofollow"  href="https://gitlab.freedesktop.org/pulseaudio/pulseaudio/issues/505">[13]</a> 
To fix this problem, launch <code>paprefs</code> and disable "Multicast/RTP Sender".<a rel="nofollow"  href="https://bugs.launchpad.net/ubuntu/+source/pulseaudio/+bug/411688/comments/36">[14]</a>
</p>
<p><br>
</p>
<h3>
<span id="New_audio_source_streams_auto-select_to_.22blank.22_stream_instead_of_BT_headphones"></span><span class="mw-headline" id='New_audio_source_streams_auto-select_to_"blank"_stream_instead_of_BT_headphones'>New audio source streams auto-select to "blank" stream instead of BT headphones</span>
</h3>
<p>Example scenario: Restarting, stopping, fast forwarding a Youtube video on Firefox 68.0.1 on KDE + TOS might set the "sink" associated with it in PulseAudio to a blank state, and then output sound over laptop speakers. Inconsistently reproducible on Dell 9360. 
</p>
<p>Fix seems to be to kill and restart <code>pulseaudio</code>.
</p>
<pre>pulseaudio -k
pulseaudio --start
</pre>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Sound.html" title="Category:Sound">Sound</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="..//Usage/Configuration/C/Category:Sections_flagged_with_Template:Remove.html" title="Category:Sections flagged with Template:Remove">Sections flagged with Template:Remove</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=PulseAudio/Troubleshooting&amp;oldid=613495">https://wiki.archlinux.org/index.php?title=PulseAudio/Troubleshooting&amp;oldid=613495</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 16 May 2020, at 14:45.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



<!--
    title: Troubleshooting
    description: Migration of Troubleshooting from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">NFS/Troubleshooting</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"><span >&lt; <a href="..//Usage/Configuration/N/NFS.html" title="NFS">NFS</a></span></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="..//Usage/Configuration/N/NFS.html" title="NFS">NFS</a></li>
</ul>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../../File:Tango-view-refresh-red.png" ><img alt="Tango-view-refresh-red.png" src="../../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Not all sections are up-to-date with NFSv4 changes. (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:NFS/Troubleshooting">Talk:NFS/Troubleshooting#</a>)</div>
</div>
<p>Dedicated article for common problems and solutions.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Server-side_issues"><span >1</span> <span >Server-side issues</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#exportfs:_/etc/exports:2:_syntax_error:_bad_option_list"><span >1.1</span> <span >exportfs: /etc/exports:2: syntax error: bad option list</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Group/GID_permissions_issues"><span >1.2</span> <span >Group/GID permissions issues</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%22Permission_denied%22_when_trying_to_write_files_as_root"><span >1.3</span> <span >"Permission denied" when trying to write files as root</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%22RPC:_Program_not_registered%22_when_showmount_-e_command_issued"><span >1.4</span> <span >"RPC: Program not registered" when showmount -e command issued</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#UDP_mounts_not_working"><span >1.5</span> <span >UDP mounts not working</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Client-side_issues"><span >2</span> <span >Client-side issues</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#mount.nfs4:_No_such_device"><span >2.1</span> <span >mount.nfs4: No such device</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#mount.nfs4:_Invalid_argument"><span >2.2</span> <span >mount.nfs4: Invalid argument</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#mount.nfs4:_Network_is_unreachable"><span >2.3</span> <span >mount.nfs4: Network is unreachable</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#mount.nfs4:_an_incorrect_mount_option_was_specified"><span >2.4</span> <span >mount.nfs4: an incorrect mount option was specified</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Unable_to_connect_from_OS_X_clients"><span >2.5</span> <span >Unable to connect from OS X clients</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Unreliable_connection_from_OS_X_clients"><span >2.6</span> <span >Unreliable connection from OS X clients</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Intermittent_client_freezes_when_copying_large_files"><span >2.7</span> <span >Intermittent client freezes when copying large files</span></a></li>
<li class="toclevel-2 tocsection-15">
<a href="#mount.nfs:_Operation_not_permitted"><span >2.8</span> <span >mount.nfs: Operation not permitted</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#NFSv4"><span >2.8.1</span> <span >NFSv4</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#NFSv3_and_earlier"><span >2.8.2</span> <span >NFSv3 and earlier</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#mount.nfs:_Protocol_not_supported"><span >2.9</span> <span >mount.nfs: Protocol not supported</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Permissions_issues"><span >2.10</span> <span >Permissions issues</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Problems_with_Vagrant_and_synced_folders"><span >2.11</span> <span >Problems with Vagrant and synced_folders</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21">
<a href="#Performance_issues"><span >3</span> <span >Performance issues</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Diagnose_the_problem"><span >3.1</span> <span >Diagnose the problem</span></a></li>
<li class="toclevel-2 tocsection-23">
<a href="#Close-to-open/flush-on-close"><span >3.2</span> <span >Close-to-open/flush-on-close</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#The_nocto_mount_option"><span >3.2.1</span> <span >The nocto mount option</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#The_async_export_option"><span >3.2.2</span> <span >The async export option</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#Buffer_cache_size_and_MTU"><span >3.3</span> <span >Buffer cache size and MTU</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27">
<a href="#Debugging"><span >4</span> <span >Debugging</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#Using_rpcdebug"><span >4.1</span> <span >Using rpcdebug</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Using_mountstats"><span >4.2</span> <span >Using mountstats</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Kernel_Interfaces"><span >4.3</span> <span >Kernel Interfaces</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#NFSD_debug_flags"><span >4.4</span> <span >NFSD debug flags</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#NFS_debug_flags"><span >4.5</span> <span >NFS debug flags</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#NLM_debug_flags"><span >4.6</span> <span >NLM debug flags</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#RPC_debug_flags"><span >4.7</span> <span >RPC debug flags</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#References"><span >4.8</span> <span >References</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Server-side_issues">Server-side issues</span></h2>
<h3>
<span id="exportfs:_.2Fetc.2Fexports:2:_syntax_error:_bad_option_list"></span><span class="mw-headline" id="exportfs:_/etc/exports:2:_syntax_error:_bad_option_list">exportfs: /etc/exports:2: syntax error: bad option list</span>
</h3>
<p>Delete all space from the option list in <code>/etc/exports</code>
</p>
<h3>
<span id="Group.2FGID_permissions_issues"></span><span class="mw-headline" id="Group/GID_permissions_issues">Group/GID permissions issues</span>
</h3>
<p>If NFS shares mount fine, and are fully accessible to the owner, but not to group members; check the number of groups that user belongs to. NFS has a limit of 16 on the number of groups a user can belong to. If you have users with more than this, you need to enable the <code>manage_gids</code> start-up flag on the NFS server:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nfs.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[mountd]
manage_gids=y</pre>
<h3>
<span id=".22Permission_denied.22_when_trying_to_write_files_as_root"></span><span class="mw-headline" id='"Permission_denied"_when_trying_to_write_files_as_root'>"Permission denied" when trying to write files as root</span>
</h3>
<ul><li>If you need to mount shares as root, and have full r/w access from the client, add the no_root_squash option to the export in <code>/etc/exports</code>:</li></ul>
<pre>/var/cache/pacman/pkg 192.168.1.0/24(rw,no_subtree_check,no_root_squash)
</pre>
<ul><li>You must also add no_root_squash to the first line in <code>/etc/exports</code>:</li></ul>
<pre>/ 192.168.1.0/24(rw,fsid=root,no_root_squash,no_subtree_check)
</pre>
<h3>
<span id=".22RPC:_Program_not_registered.22_when_showmount_-e_command_issued"></span><span class="mw-headline" id='"RPC:_Program_not_registered"_when_showmount_-e_command_issued'>"RPC: Program not registered" when showmount -e command issued</span>
</h3>
<p>Make sure that <code>nfs-server.service</code> and <code>rpcbind.service</code> are running on the server site, see <a href="..//Usage/Configuration/S/Systemd.html" title="Systemd">systemd</a>. If they are not, start and enable them.
</p>
<p>Also make sure NFSv3 is enabled. <i>showmount</i> does <b>not</b> work with NFSv4-only servers.
</p>
<h3><span class="mw-headline" id="UDP_mounts_not_working">UDP mounts not working</span></h3>
<p><i>nfs-utils</i> disabled serving NFS over UDP in version 2.2.1. TOS core updated to 2.3.1 on 21 Dec 2017 (skipping over 2.2.1.) If UDP stopped working then, add <code>udp=y</code> under <code>[nfsd]</code> in <code>/etc/nfs.conf</code>. Then restart <code>nfs-server.service</code>.
</p>
<h2><span class="mw-headline" id="Client-side_issues">Client-side issues</span></h2>
<h3><span class="mw-headline" id="mount.nfs4:_No_such_device">mount.nfs4: No such device</span></h3>
<p>Make sure the <code>nfsd</code> <a href="..//Usage/Configuration/K/Kernel_module.html" title="Kernel module">kernel module</a> has been loaded.
</p>
<h3><span class="mw-headline" id="mount.nfs4:_Invalid_argument">mount.nfs4: Invalid argument</span></h3>
<p><a href="..//Usage/Configuration/S/Systemd.html#Using_units" class="mw-redirect" title="Enable">Enable</a> and <a href="..//Usage/Configuration/S/Systemd.html#Using_units" class="mw-redirect" title="Start">start</a> <code>nfs-client.target</code> and make sure the appropriate daemons (nfs-idmapd, rpc-gssd, etc) are running on the server.
</p>
<h3><span class="mw-headline" id="mount.nfs4:_Network_is_unreachable">mount.nfs4: Network is unreachable</span></h3>
<p>Users making use of <a href="..//Usage/Configuration/S/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a> or <a href="..//Usage/Configuration/N/NetworkManager.html" title="NetworkManager">NetworkManager</a> might notice <a href="..//Usage/Configuration/N/NFS.html" title="NFS">NFS</a> mounts are not mounted when booting.
</p>
<p>Force the network to be completely configured by <a href="..//Usage/Configuration/S/Systemd.html#Using_units" class="mw-redirect" title="Enabling">enabling</a> <code>systemd-networkd-wait-online.service</code> or <code>NetworkManager-wait-online.service</code>. This may slow down the boot-process because less services run in parallel.
</p>
<h3><span class="mw-headline" id="mount.nfs4:_an_incorrect_mount_option_was_specified">mount.nfs4: an incorrect mount option was specified</span></h3>
<p>This can happen if using the <code>sec=krb5</code> option without <code>nfs-client.service</code> and/or <code>rpc-gssd.service</code> running. Starting and enabling those services should resolve the issue.
</p>
<h3><span class="mw-headline" id="Unable_to_connect_from_OS_X_clients">Unable to connect from OS X clients</span></h3>
<p>When trying to connect from an OS X client, you will see that everything is ok in the server logs, but OS X will refuse to mount your NFS share. You can do one of two things to fix this:
</p>
<ul><li>On the NFS server, add the <code>insecure</code> option to the share in <code>/etc/exports</code> and re-run <code>exportfs -r</code>.</li></ul>
<p>... <b>OR</b> ...
</p>
<ul><li>On the OS X client, add the <code>resvport</code> option to the <code>mount</code> command line. You can also set <code>resvport</code> as a default client mount option in <code>/etc/nfs.conf</code>:</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nfs.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">nfs.client.mount.options = resvport
</pre>
<p>Using the default client mount option should also affect mounting the share from Finder via "Connect to Server...".
</p>
<h3><span class="mw-headline" id="Unreliable_connection_from_OS_X_clients">Unreliable connection from OS X clients</span></h3>
<p>OS X's NFS client is optimized for OS X Servers and might present some issues with Linux servers. If you are experiencing slow performance, frequent disconnects and problems with international characters edit the default mount options by adding the line <code>nfs.client.mount.options = intr,locallocks,nfc</code> to <code>/etc/nfs.conf</code> on your Mac client. More information about the mount options can be found in the OS X <a rel="nofollow"  href="https://developer.apple.com/legacy/library/documentation/Darwin/Reference/ManPages/man8/mount_nfs.8.html">mount_nfs man page</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot"  title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-01 ⓘ]</sup>.
</p>
<h3><span class="mw-headline" id="Intermittent_client_freezes_when_copying_large_files">Intermittent client freezes when copying large files</span></h3>
<p>If you copy large files from your client machine to the NFS server, the transfer speed is <i>very</i> fast, but after some seconds the speed drops and your client machine intermittently locks up completely for some time until the transfer is finished.
</p>
<p>Try adding <tt>sync</tt> as a mount option on the client (e.g. in <tt>/etc/fstab</tt>) to fix this problem.
</p>
<h3><span class="mw-headline" id="mount.nfs:_Operation_not_permitted">mount.nfs: Operation not permitted</span></h3>
<h4><span class="mw-headline" id="NFSv4">NFSv4</span></h4>
<p>If you use <a href="..//Usage/Configuration/K/Kerberos.html" title="Kerberos">Kerberos</a> (sec=krb5*), make sure the client and server clocks are correct. Using <a href="..//Usage/Configuration/N/Network_Time_Protocol_daemon.html" class="mw-redirect" title="Ntpd">ntpd</a> or <a href="..//Usage/Configuration/S/Systemd-timesyncd.html" title="Systemd-timesyncd">systemd-timesyncd</a> is recommended.
</p>
<h4><span class="mw-headline" id="NFSv3_and_earlier">NFSv3 and earlier</span></h4>
<p><i>nfs-utils</i> versions 1.2.1-2 or higher use NFSv4 by default, resulting in NFSv3 shares failing on upgrade. The problem can be solved by using either mount option <code>'vers=3'</code> or <code>'nfsvers=3'</code> on the command line: 
</p>
<pre># mount.nfs <i>remote target</i> <i>directory</i> -o ...,vers=3,...
# mount.nfs <i>remote target</i> <i>directory</i> -o ...,nfsvers=3,...
</pre>
<p>or in <code>/etc/fstab</code>:
</p>
<pre><i>remote target</i> <i>directory</i> nfs ...,vers=3,... 0 0
<i>remote target</i> <i>directory</i> nfs ...,nfsvers=3,... 0 0
</pre>
<h3><span class="mw-headline" id="mount.nfs:_Protocol_not_supported">mount.nfs: Protocol not supported</span></h3>
<p>This error occurs when you include the export root in the path of the NFS source.
For example:
</p>
<pre># mount SERVER:/srv/nfs4/media /mnt
mount.nfs4: Protocol not supported
</pre>
<p>Use the relative path instead:
</p>
<pre># mount SERVER:/media /mnt
</pre>
<h3><span class="mw-headline" id="Permissions_issues">Permissions issues</span></h3>
<p>If you find that you cannot set the permissions on files properly, make sure the <a href="..//Usage/Configuration/U/Users_and_groups.html" class="mw-redirect" title="User">user</a>/<a href="..//Usage/Configuration/U/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a> are <b>both</b> on the client and server.
</p>
<p>If all your files are owned by <code>nobody</code>, and you are using NFSv4, on both the client and server, you should ensure that the <code>nfs-idmapd.service</code> has been started.
</p>
<p>On some systems detecting the domain from FQDN minus hostname does not seem to work reliably. If files are still showing as <code>nobody</code> after the above changes, edit <code>/etc/idmapd.conf</code>, ensure that <code>Domain</code> is set to <code>FQDN minus hostname</code>. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/idmapd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
Domain = <i>domain.ext</i>

[Mapping]

Nobody-User = nobody
Nobody-Group = nobody

[Translation]

Method = nsswitch</pre>
<h3><span class="mw-headline" id="Problems_with_Vagrant_and_synced_folders">Problems with Vagrant and synced_folders</span></h3>
<p>If you get an error about unuspported protocol, you need to enable NFS over UDP on your host (or make Vagrant use NFS over TCP.) See <a href="#UDP_mounts_not_working">#UDP mounts not working</a>.
</p>
<p>If Vagrant scripts are unable to mount folders over NFS, installing the <i>net-tools</i> package may solve the issue.
</p>
<h2><span class="mw-headline" id="Performance_issues">Performance issues</span></h2>
<p>This <a rel="nofollow"  href="http://nfs.sourceforge.net/nfs-howto/ar01s05.html">NFS Howto page</a> has some useful information regarding performance.  Here are some further tips:
</p>
<h3><span class="mw-headline" id="Diagnose_the_problem">Diagnose the problem</span></h3>
<ul>
<li>
<b>Htop</b> should be your first port of call.  The most obvious symptom will be a maxed-out CPU.</li>
<li>Press F2, and under "Display options", enable "Detailed CPU time".  Press F1 for an explanation of the colours used in the CPU bars.  In particular, is the CPU spending most of its time responding to IRQs, or in Wait-IO (wio)?</li>
</ul>
<h3>
<span id="Close-to-open.2Fflush-on-close"></span><span class="mw-headline" id="Close-to-open/flush-on-close">Close-to-open/flush-on-close</span>
</h3>
<p><b>Symptoms:</b> Your clients are writing many small files.  The server CPU is not maxed out, but there is very high wait-IO, and the server disk seems to be churning more than you might expect.
</p>
<p>In order to ensure data consistency across clients, the NFS protocol requires that the client's cache is flushed (all data is pushed to the server) whenever a file is closed after writing.  Because the server is not allowed to buffer disk writes (if it crashes, the client won't realise the data wasn't written properly), the data is written to disk immediately before the client's request is completed.  When you're writing lots of small files from the client, this means that the server spends most of its time waiting for small files to be written to its disk, which can cause a significant reduction in throughput.
</p>
<p>See <a rel="nofollow"  href="http://docstore.mik.ua/orelly/networking_2ndEd/nfs/ch07_04.htm">this excellent article</a> or the <b>nfs</b> manpage for more details on the close-to-open policy.  There are several approaches to solving this problem:
</p>
<h4><span class="mw-headline" id="The_nocto_mount_option">The nocto mount option</span></h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The Linux kernel does not seem to honor this option properly. Files are still flushed when they're closed.</div>
<p>If all of the following conditions are satisfied:
</p>
<ul>
<li>The export you have mounted on the client is only going to be used by the one client.</li>
<li>It doesn't matter too much if a file written on one client doesn't immediately appear on other clients.</li>
<li>It doesn't matter if after a client has written a file, and the client thinks the file has been saved, and then the client crashes, the file may be lost.</li>
</ul>
<p>Use the <b>nocto</b> mount option, which will disable the close-to-open behavior.
</p>
<h4><span class="mw-headline" id="The_async_export_option">The async export option</span></h4>
<p>Does your situation match these conditions?
</p>
<ul>
<li>It's important that when a file is closed after writing on one client, it is:
<ul>
<li>Immediately visible on all the other clients.</li>
<li>Safely stored on the server, even if the client crashes immediately after closing the file.</li>
</ul>
</li>
<li>It's not important to you that if the server crashes:
<ul>
<li>You may lose the files that were most recently written by clients.</li>
<li>When the server is restarted, the clients will believe their recent files exist, even though they were actually lost.</li>
</ul>
</li>
</ul>
<p>In this situation, you can use <code>async</code> instead of <code>sync</code> in the server's <code>/etc/exports</code> file for those specific exports.  See the <b>exports</b> manual page for details.  In this case, it does not make sense to use the <code>nocto</code> mount option on the client.
</p>
<h3><span class="mw-headline" id="Buffer_cache_size_and_MTU">Buffer cache size and MTU</span></h3>
<p><b>Symptoms:</b> High kernel or IRQ CPU usage, a very high packet count through the network card.
</p>
<p>This is a trickier optimisation. Make sure this is definitely the problem before spending too much time on this. The default values are usually fine for most situations.
</p>
<p>See <a rel="nofollow"  href="http://docstore.mik.ua/orelly/networking_2ndEd/nfs/ch07_03.htm">this article</a> for information about I/O buffering in NFS. Essentially, data is accumulated into buffers before being sent. The size of the buffer will affect the way data is transmitted over the network. The Maximum Transmission Unit (MTU) of the network equipment will also affect throughput, as the buffers need to be split into MTU-sized chunks before they're sent over the network. If your buffer size is too big, the kernel or hardware may spend too much time splitting it into MTU-sized chunks. If the buffer size is too small, there will be overhead involved in sending a very large number of small packets. You can use the <b>rsize</b> and <b>wsize</b> mount options on the client to alter the buffer cache size. To achieve the best throughput, you need to experiment and discover the best values for your setup.
</p>
<p>It is possible to change the MTU of many network cards. If your clients are on a separate subnet (e.g. for a Beowulf cluster), it may be safe to configure all of the network cards to use a high MTU. This should be done in very-high-bandwidth environments.
</p>
<p>See <a href="..//Usage/Configuration/N/NFS.html#Performance_tuning" title="NFS">NFS#Performance tuning</a> for more information.
</p>
<h2><span class="mw-headline" id="Debugging">Debugging</span></h2>
<h3><span class="mw-headline" id="Using_rpcdebug">Using rpcdebug</span></h3>
<p>Using <code>rpcdebug</code> is the easiest way to manipulate the kernel interfaces in place of echoing bitmasks to /proc.
</p>
<table >

<tbody>
<tr>
<th>Option</th>
<th>Description
</th>
</tr>
<tr>
<td>-c</td>
<td>Clear the given debug flags
</td>
</tr>
<tr>
<td>-s</td>
<td>Set the given debug flags
</td>
</tr>
<tr>
<td>-m <i>module</i>
</td>
<td>Specify which module's flags to set or clear.
</td>
</tr>
<tr>
<td>-v</td>
<td>Increase the verbosity of rpcdebug's output
</td>
</tr>
<tr>
<td>-h</td>
<td>Print a help message and exit. When combined with the -v option, also prints the available debug flags.
</td>
</tr>
</tbody>
</table>
<p>For the <b>-m</b> option, the available modules are:
</p>
<table >

<tbody>
<tr>
<th>Module</th>
<th>Description
</th>
</tr>
<tr>
<td>nfsd</td>
<td>The NFS server
</td>
</tr>
<tr>
<td>nfs</td>
<td>The NFS client
</td>
</tr>
<tr>
<td>nlm</td>
<td>The Network Lock Manager, in either an NFS client or server
</td>
</tr>
<tr>
<td>rpc</td>
<td>The Remote Procedure Call module, in either an NFS client or server
</td>
</tr>
</tbody>
</table>
<p>Examples:
</p>
<pre>rpcdebug -m rpc -s all    # sets all debug flags for RPC
rpcdebug -m rpc -c all    # clears all debug flags for RPC

rpcdebug -m nfsd -s all   # sets all debug flags for NFS Server
rpcdebug -m nfsd -c all   # clears all debug flags for NFS Server
</pre>
<p>Once the flags are set you can tail the journal for the debug output, usually <code>journalctl -fl</code> or similar.
</p>
<h3><span class="mw-headline" id="Using_mountstats">Using mountstats</span></h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=nfs-utils">nfs-utils</a></span> package contains the <code>mountstats</code> tool, which can retrieve a lot of statistics about NFS mounts, including average timings and packet size.
</p>
<pre>$ mountstats 
Stats for example:/tank mounted on /tank:
  NFS mount options: rw,sync,vers=4.2,rsize=524288,wsize=524288,namlen=255,acregmin=3,acregmax=60,acdirmin=30,acdirmax=60,soft,proto=tcp,port=0,timeo=15,retrans=2,sec=sys,clientaddr=xx.yy.zz.tt,local_lock=none
  NFS server capabilities: caps=0xfbffdf,wtmult=512,dtsize=32768,bsize=0,namlen=255
  NFSv4 capability flags: bm0=0xfdffbfff,bm1=0x40f9be3e,bm2=0x803,acl=0x3,sessions,pnfs=notconfigured
  NFS security flavor: 1  pseudoflavor: 0

NFS byte counts:
  applications read 248542089 bytes via read(2)
  applications wrote 0 bytes via write(2)
  applications read 0 bytes via O_DIRECT read(2)
  applications wrote 0 bytes via O_DIRECT write(2)
  client read 171375125 bytes via NFS READ
  client wrote 0 bytes via NFS WRITE

RPC statistics:
  699 RPC requests sent, 699 RPC replies received (0 XIDs not found)
  average backlog queue length: 0

READ:
	338 ops (48%) 
	avg bytes sent per op: 216	avg bytes received per op: 507131
	backlog wait: 0.005917 	RTT: 548.736686 	total execute time: 548.775148 (milliseconds)
GETATTR:
	115 ops (16%) 
	avg bytes sent per op: 199	avg bytes received per op: 240
	backlog wait: 0.008696 	RTT: 15.756522 	total execute time: 15.843478 (milliseconds)
ACCESS:
	93 ops (13%) 
	avg bytes sent per op: 203	avg bytes received per op: 168
	backlog wait: 0.010753 	RTT: 2.967742 	total execute time: 3.032258 (milliseconds)
LOOKUP:
	32 ops (4%) 
	avg bytes sent per op: 220	avg bytes received per op: 274
	backlog wait: 0.000000 	RTT: 3.906250 	total execute time: 3.968750 (milliseconds)
OPEN_NOATTR:
	25 ops (3%) 
	avg bytes sent per op: 268	avg bytes received per op: 350
	backlog wait: 0.000000 	RTT: 2.320000 	total execute time: 2.360000 (milliseconds)
CLOSE:
	24 ops (3%) 
	avg bytes sent per op: 224	avg bytes received per op: 176
	backlog wait: 0.000000 	RTT: 30.250000 	total execute time: 30.291667 (milliseconds)
DELEGRETURN:
	23 ops (3%) 
	avg bytes sent per op: 220	avg bytes received per op: 160
	backlog wait: 0.000000 	RTT: 6.782609 	total execute time: 6.826087 (milliseconds)
READDIR:
	4 ops (0%) 
	avg bytes sent per op: 224	avg bytes received per op: 14372
	backlog wait: 0.000000 	RTT: 198.000000 	total execute time: 198.250000 (milliseconds)
SERVER_CAPS:
	2 ops (0%) 
	avg bytes sent per op: 172	avg bytes received per op: 164
	backlog wait: 0.000000 	RTT: 1.500000 	total execute time: 1.500000 (milliseconds)
FSINFO:
	1 ops (0%) 
	avg bytes sent per op: 172	avg bytes received per op: 164
	backlog wait: 0.000000 	RTT: 2.000000 	total execute time: 2.000000 (milliseconds)
PATHCONF:
	1 ops (0%) 
	avg bytes sent per op: 164	avg bytes received per op: 116
	backlog wait: 0.000000 	RTT: 1.000000 	total execute time: 1.000000 (milliseconds)
</pre>
<h3><span class="mw-headline" id="Kernel_Interfaces">Kernel Interfaces</span></h3>
<p>A bitmask of the debug flags can be echoed into the interface to enable output to syslog; 0 is the default:
</p>
<pre>/proc/sys/sunrpc/nfsd_debug
/proc/sys/sunrpc/nfs_debug
/proc/sys/sunrpc/nlm_debug
/proc/sys/sunrpc/rpc_debug
</pre>
<p>Sysctl controls are registered for these interfaces, so they can be used instead of echo:
</p>
<pre>sysctl -w sunrpc.rpc_debug=1023
sysctl -w sunrpc.rpc_debug=0

sysctl -w sunrpc.nfsd_debug=1023
sysctl -w sunrpc.nfsd_debug=0</pre>
<p>At runtime the server holds information that can be examined:
</p>
<pre>grep . /proc/net/rpc/*/content
cat /proc/fs/nfs/exports
cat /proc/net/rpc/nfsd
ls -l /proc/fs/nfsd
</pre>
<p>A rundown of <code>/proc/net/rpc/nfsd</code> (the userspace tool <code>nfsstat</code> pretty-prints this info):
</p>
<pre>* rc (reply cache): &lt;hits&gt; &lt;misses&gt; &lt;nocache&gt;
- hits: client it's retransmitting
- misses: a operation that requires caching
- nocache: a operation that no requires caching

* fh (filehandle): &lt;stale&gt; &lt;total-lookups&gt; &lt;anonlookups&gt; &lt;dir-not-in-cache&gt; &lt;nodir-not-in-cache&gt;
- stale: file handle errors
- total-lookups, anonlookups, dir-not-in-cache, nodir-not-in-cache
  . always seem to be zeros

* io (input/output): &lt;bytes-read&gt; &lt;bytes-written&gt;
- bytes-read: bytes read directly from disk
- bytes-written: bytes written to disk

* th (threads): &lt;threads&gt; &lt;fullcnt&gt; &lt;10%-20%&gt; &lt;20%-30%&gt; ... &lt;90%-100%&gt; &lt;100%&gt;
  DEPRECATED:  All fields after &lt;threads&gt; are hard-coded to <code>0</code>
- threads: number of nfsd threads
- fullcnt: number of times that the last 10% of threads are busy
- 10%-20%, 20%-30% ... 90%-100%: 10 numbers representing 10-20%, 20-30% to 100%
  . Counts the number of times a given interval are busy

* ra (read-ahead): &lt;cache-size&gt; &lt;10%&gt; &lt;20%&gt; ... &lt;100%&gt; &lt;not-found&gt;
- cache-size: always the double of number threads
- 10%, 20% ... 100%: how deep it found what was looking for
- not-found: not found in the read-ahead cache

* net: &lt;netcnt&gt; &lt;netudpcnt&gt; &lt;nettcpcnt&gt; &lt;nettcpconn&gt;
- netcnt: counts every read
- netudpcnt: counts every UDP packet it receives
- nettcpcnt: counts every time it receives data from a TCP connection
- nettcpconn: count every TCP connection it receives

* rpc: &lt;rpccnt&gt; &lt;rpcbadfmt+rpcbadauth+rpcbadclnt&gt; &lt;rpcbadfmt&gt; &lt;rpcbadauth&gt; &lt;rpcbadclnt&gt;
- rpccnt: counts all rpc operations
- rpcbadfmt: counts if while processing a RPC it encounters the following errors:
  . err_bad_dir, err_bad_rpc, err_bad_prog, err_bad_vers, err_bad_proc, err_bad
- rpcbadauth: bad authentication
  . does not count if you try to mount from a machine that it's not in your exports file
- rpcbadclnt: unused

* procN (N = vers): &lt;vs_nproc&gt; &lt;null&gt; &lt;getattr&gt; &lt;setattr&gt; &lt;lookup&gt; &lt;access&gt; &lt;readlink&gt; &lt;read&gt; &lt;write&gt; &lt;create&gt; &lt;mkdir&gt; &lt;symlink&gt; &lt;mknod&gt; &lt;remove&gt; &lt;rmdir&gt; &lt;rename&gt; &lt;link&gt; &lt;readdir&gt; &lt;readdirplus&gt; &lt;fsstat&gt; &lt;fsinfo&gt; &lt;pathconf&gt; &lt;commit&gt;
- vs_nproc: number of procedures for NFS version
  . v2: nfsproc.c, 18
  . v3: nfs3proc.c, 22
  - v4, nfs4proc.c, 2
- statistics: generated from NFS operations at runtime

* proc4ops: &lt;ops&gt; &lt;x..y&gt;
- ops: the definition of LAST_NFS4_OP, OP_RELEASE_LOCKOWNER = 39, plus 1 (so 40); defined in nfs4.h
- x..y: the array of nfs_opcount up to LAST_NFS4_OP (nfsdstats.nfs4_opcount[i])</pre>
<h3><span class="mw-headline" id="NFSD_debug_flags">NFSD debug flags</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/include/linux/nfsd/debug.h</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/*
 * knfsd debug flags
 */
#define NFSDDBG_SOCK            0x0001
#define NFSDDBG_FH              0x0002
#define NFSDDBG_EXPORT          0x0004
#define NFSDDBG_SVC             0x0008
#define NFSDDBG_PROC            0x0010
#define NFSDDBG_FILEOP          0x0020
#define NFSDDBG_AUTH            0x0040
#define NFSDDBG_REPCACHE        0x0080
#define NFSDDBG_XDR             0x0100
#define NFSDDBG_LOCKD           0x0200
#define NFSDDBG_ALL             0x7FFF
#define NFSDDBG_NOCHANGE        0xFFFF</pre>
<h3><span class="mw-headline" id="NFS_debug_flags">NFS debug flags</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/include/linux/nfs_fs.h</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/*
 * NFS debug flags
 */
#define NFSDBG_VFS              0x0001
#define NFSDBG_DIRCACHE         0x0002
#define NFSDBG_LOOKUPCACHE      0x0004
#define NFSDBG_PAGECACHE        0x0008
#define NFSDBG_PROC             0x0010
#define NFSDBG_XDR              0x0020
#define NFSDBG_FILE             0x0040
#define NFSDBG_ROOT             0x0080
#define NFSDBG_CALLBACK         0x0100
#define NFSDBG_CLIENT           0x0200
#define NFSDBG_MOUNT            0x0400
#define NFSDBG_FSCACHE          0x0800
#define NFSDBG_PNFS             0x1000
#define NFSDBG_PNFS_LD          0x2000
#define NFSDBG_STATE            0x4000
#define NFSDBG_ALL              0xFFFF</pre>
<h3><span class="mw-headline" id="NLM_debug_flags">NLM debug flags</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/include/linux/lockd/debug.h</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/*
 * Debug flags
 */
#define NLMDBG_SVC		0x0001
#define NLMDBG_CLIENT		0x0002
#define NLMDBG_CLNTLOCK		0x0004
#define NLMDBG_SVCLOCK		0x0008
#define NLMDBG_MONITOR		0x0010
#define NLMDBG_CLNTSUBS		0x0020
#define NLMDBG_SVCSUBS		0x0040
#define NLMDBG_HOSTCACHE	0x0080
#define NLMDBG_XDR		0x0100
#define NLMDBG_ALL		0x7fff</pre>
<h3><span class="mw-headline" id="RPC_debug_flags">RPC debug flags</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/include/linux/sunrpc/debug.h</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/*
 * RPC debug facilities
 */
#define RPCDBG_XPRT             0x0001
#define RPCDBG_CALL             0x0002
#define RPCDBG_DEBUG            0x0004
#define RPCDBG_NFS              0x0008
#define RPCDBG_AUTH             0x0010
#define RPCDBG_BIND             0x0020
#define RPCDBG_SCHED            0x0040
#define RPCDBG_TRANS            0x0080
#define RPCDBG_SVCXPRT          0x0100
#define RPCDBG_SVCDSP           0x0200
#define RPCDBG_MISC             0x0400
#define RPCDBG_CACHE            0x0800
#define RPCDBG_ALL              0x7fff</pre>
<h3><span class="mw-headline" id="References">References</span></h3>
<ul>
<li><a rel="nofollow"  href="https://github.com/torvalds/linux/tree/master/include/linux">https://github.com/torvalds/linux/tree/master/include/linux</a></li>
<li><span class="plainlinks archwiki-template-man" title="$ man 8 rpcdebug"><a rel="nofollow"  href="https://jlk.fjfi.cvut.cz/arch/manpages/man/rpcdebug.8">rpcdebug(8)</a></span></li>
<li><a rel="nofollow"  href="http://utcc.utoronto.ca/~cks/space/blog/linux/NFSClientDebuggingBits">http://utcc.utoronto.ca/~cks/space/blog/linux/NFSClientDebuggingBits</a></li>
<li><a rel="nofollow"  href="http://www.novell.com/support/kb/doc.php?id=7011571">http://www.novell.com/support/kb/doc.php?id=7011571</a></li>
<li><a rel="nofollow"  href="http://stromberg.dnsalias.org/~strombrg/NFS-troubleshooting-2.html">http://stromberg.dnsalias.org/~strombrg/NFS-troubleshooting-2.html</a></li>
<li><a rel="nofollow"  href="http://www.opensubscriber.com/message/nfs@lists.sourceforge.net/7833588.html">http://www.opensubscriber.com/message/nfs@lists.sourceforge.net/7833588.html</a></li>
</ul>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="..//Usage/Configuration/C/Category:Network_sharing.html" title="Category:Network sharing">Network sharing</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="..//Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="..//Usage/Configuration/C/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=NFS/Troubleshooting&amp;oldid=615290">https://wiki.archlinux.org/index.php?title=NFS/Troubleshooting&amp;oldid=615290</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 23 May 2020, at 15:20.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="..//Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="..//Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="..//Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



