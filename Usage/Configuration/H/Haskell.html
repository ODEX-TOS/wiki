<!--
    title: Haskell
    description: Migration of Haskell from the arch Wiki to the TOS Wiki
    published: true
    date: 2020-05-29T19:40:39.000Z
    tags: 
    -->>

<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading"  lang="en">Haskell</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" >From TOS Wiki</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<p><a rel="nofollow"  href="http://www.haskell.org">Haskell</a> is a general purpose, purely functional, programming language.
</p>
<div id="toc" >
<input type="checkbox" role="button" id="toctogglecheckbox"  style="display:none"><div  lang="en" dir="ltr">
<h2>Contents</h2>
<span ><label  for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Installation"><span >1</span> <span >Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Compiler"><span >1.1</span> <span >Compiler</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3">
<a href="#Problems_with_linking"><span >2</span> <span >Problems with linking</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Static_linking"><span >2.1</span> <span >Static linking</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Building_statically_linked_packages_with_Cabal_(without_using_shared_libraries)"><span >2.2</span> <span >Building statically linked packages with Cabal (without using shared libraries)</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Haskell_development_tools"><span >2.3</span> <span >Haskell development tools</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Managing_Haskell_packages"><span >3</span> <span >Managing Haskell packages</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Pros/Cons_of_the_different_methods"><span >3.1</span> <span >Pros/Cons of the different methods</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#cabal-install"><span >3.2</span> <span >cabal-install</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Preparation_and_%24PATH"><span >3.2.1</span> <span >Preparation and $PATH</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Installing_packages_user-wide"><span >3.2.2</span> <span >Installing packages user-wide</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Sandboxes"><span >3.2.3</span> <span >Sandboxes</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Removing_packages"><span >3.2.4</span> <span >Removing packages</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14">
<a href="#Stack"><span >3.3</span> <span >Stack</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#Avoiding_~/.stack_bloat_by_dynamic_linking"><span >3.3.1</span> <span >Avoiding ~/.stack bloat by dynamic linking</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#ghcup"><span >3.4</span> <span >ghcup</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#See_also"><span >4</span> <span >See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>Haskell generates machine code that can be run natively on Linux. There is nothing special required to run a binary (already compiled) software, like the ones provided in the <a href="/Usage/Configuration/O/Official_repositories.html" title="Official repositories">official repositories</a>. On the other side, <a href="/Usage/Configuration/T/TOS_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> packages or source codes requires a compiler to build the software.
</p>
<p>Installing the compiler alone permits to build Haskell source code. A few additional tools are needed for development work.
</p>
<h3><span class="mw-headline" id="Compiler">Compiler</span></h3>
<p>To build a Haskell source code into native code, a compiler must be installed. There are several <a rel="nofollow"  href="http://www.haskell.org/haskellwiki/Implementations">implementations available</a>, but the one used most (which is now <i>de facto</i> the reference) is the GHC (Glasgow Haskell Compiler). It is available in the official repositories as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span>.
</p>
<p>You can try it with the following file:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">Main.hs</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">main = putStrLn "Hello, World"</pre>
<p>and by running:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ghc -dynamic Main.hs
$ ./Main </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Hello, World
</pre>
<h2><span class="mw-headline" id="Problems_with_linking">Problems with linking</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" ><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> What is Cabal? (Discuss in <a rel="nofollow"  href="https://wiki.archlinux.org/index.php/Talk:Haskell">Talk:Haskell#</a>)</div>
</div>
<p>Since version <a rel="nofollow"  href="https://git.archlinux.org/svntogit/community.git/commit/trunk?h=packages/ghc&amp;id=7a948cdfb808afd3ce6f93047ae0dc1778e79f9f">8.0.2-1</a>, the TOS <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span> package no longer installs static versions of the GHC boot libraries by default, nor do any of the <a rel="nofollow"  href="https://www.archlinux.org/packages/?q=haskell">haskell-*</a> packages in <i>community</i>.  Therefore, to link successfully one must pass the <code>-dynamic</code> flag to GHC, as the default is to use static linking.  For Cabal, this amounts to the following configuration:
</p>
<pre>cabal configure --disable-library-vanilla --enable-shared --enable-executable-dynamic --ghc-options=-dynamic</pre>
<ul>
<li>
<code>--disable-library-vanilla</code> suppresses the creation of static libraries (if your project contains a library).</li>
<li>
<code>--enable-shared</code> enables the creation of shared libraries (if your project contains a library).</li>
<li>
<code>--enable-executable-dynamic</code> causes dynamic linking to be used for executables (if your project contains executables).</li>
<li>
<code>--ghc-options=-dynamic</code> adds the <code>-dynamic</code> flag to every invocation of GHC (e.g. if a package has a non-trivial <code>Setup.hs</code>).</li>
</ul>
<p>Note that if you've used <a rel="nofollow"  href="https://github.com/haskell/ghcup">gchup</a> to install cabal, adding these changes to your <code>$HOME/.cabal/config</code> should not be done. This can lead to errors such as <code>dieVerbatim: user error (cabal: '/home/user/.ghcup/bin/ghc'</code>.
</p>
<p>You can also set these flags in <code>~/.cabal/config</code> so that it applies to all projects by default:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.cabal/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">library-vanilla: False
shared: True
executable-dynamic: True
program-default-options
  ghc-options:
    -dynamic
</pre>
<p>Dynamic linking is used for most Haskell modules packaged through <a href="/Usage/Configuration/P/Pacman.html" title="Pacman">pacman</a> and some packages in the <a href="/Usage/Configuration/T/TOS_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>. Since GHC provides no <a href="https://en.wikipedia.org/wiki/Application_binary_interface"  title="w:Application binary interface">ABI</a> compatibility between compiler releases, static linking is often the preferred option for local development outside of the package system.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In the context of this article, static linking does not mean generating completely static ELF binaries. Only Haskell code will be linked statically into a single ELF binary, which may be dynamically linked to other system libraries such as <i>glibc</i>.</div>
<h3><span class="mw-headline" id="Static_linking">Static linking</span></h3>
<p>To use static linking, one must, at minimum, install the static boot libraries through the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc-static">ghc-static</a></span> package.  This would allow you to build projects that depend exclusively on the boot libraries as well as any library that is not installed through the <code>haskell-*</code> packages.
</p>
<p>Unfortunately, if your project depends on any of the <code>haskell-*</code> packages that you have installed, Cabal does not take the absence of static libraries into account during dependency resolution.  As a result, it will try to use the existing <code>haskell-*</code> package and then fail with <a rel="nofollow"  href="https://bugs.archlinux.org/task/54563#comment158808">linker errors</a> when it realizes the static libraries are missing.  Unlike <code>ghc-static</code>, there are no “<code>haskell-*-static</code>” packages to fix this problem.
</p>
<p>To work around this problem, you can install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/ghc-pristine/">ghc-pristine</a></span><sup><small>AUR</small></sup>, which wraps over an existing GHC installation to create a separate GHC distribution in <code>/usr/share/ghc-pristine</code>, with a package database that contains only boot libraries.  Then, to build software with static linking, one simply needs to invoke the wrapped compiler <code>/usr/share/ghc-pristine/bin/ghc</code>.  For Cabal, this amounts to the following configuration:
</p>
<pre>cabal configure --with-compiler=/usr/share/ghc-pristine/bin/ghc</pre>
<p>This can be made permanent by editing <code>~/.cabal/config</code> (it can be created using <code>cabal user-config init</code>).  Be aware that you still need <code>ghc-static</code>.
</p>
<p>Alternatives to <code>ghc-pristine</code>:
</p>
<ul>
<li>One could manually run <code>cabal install --force-reinstalls</code> to shadow the corresponding <code>haskell-*</code> packages.  This can be tedious as you must explicitly enumerate all transitive dependencies that coincide with an existing <code>haskell-*</code> package.</li>
<li>Use a completely separate GHC distribution: download the official Linux binaries for <a rel="nofollow"  href="https://www.haskell.org/ghc/">GHC</a> and <a rel="nofollow"  href="https://www.haskell.org/cabal/download.html">cabal-install</a> and unpack them somewhere else.  This is in effect what <code>ghc-pristine</code> does, but <code>ghc-pristine</code> uses less disk space.</li>
</ul>
<h3>
<span id="Building_statically_linked_packages_with_Cabal_.28without_using_shared_libraries.29"></span><span class="mw-headline" id="Building_statically_linked_packages_with_Cabal_(without_using_shared_libraries)">Building statically linked packages with Cabal (without using shared libraries)</span>
</h3>
<p>This section explains how to install <code>cabal-install</code> but from <a rel="nofollow"  href="https://hackage.haskell.org/package/cabal-install">Hackage</a> instead of the official <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-install">cabal-install</a></span> package from the repositories. This <code>cabal-install</code> will build Haskell packages without using <a rel="nofollow"  href="https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/shared_libs.html">shared libraries</a> unlike the official <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-install">cabal-install</a></span> which requires you to link dynamically.
</p>
<p>In theory with any <code>cabal-install</code> you could choose between both methods, static and dynamic, for linking your Haskell code. In practice because in TOS some basic Haskell libraries (<code>haskell-*</code> packages) are provided as shared objects (<code>.so</code> files) and those libraries are globally registered in Cabal, it has trouble using the same libraries for static linking. To avoid linking <a rel="nofollow"  href="https://bugs.archlinux.org/task/54563#comment158826">errors</a>, it's also especially important to not to mix statically and dynamically Haskell packages installed on the same system, as Cabal doesn't fetch a required package once it has been globally registered (check them with the command <code>ghc-pkg list</code>) in one of its forms and not the other (independently of the linking type of the package that it's needed).
</p>
<p>For these reasons, <b>you have to make sure</b> that the only two related Haskell packages you have installed are <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span>, the compiler, and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc-static">ghc-static</a></span>, the boot libraries on its static form, (not <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=stack">stack</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-helper">cabal-helper</a></span><sup>[<a href="/Usage/Configuration/H/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-install">cabal-install</a></span> and none of the <code>haskell-*</code> dynamic libraries <a rel="nofollow"  href="https://www.archlinux.org/packages/?q=haskell-">available</a> in the official repositories).
</p>
<p>You can also use <a rel="nofollow"  href="https://www.haskellstack.org/">Stack</a> as an alternative build tool for Haskell packages, which will link statically by default. But if you still want to use Cabal to build using static linking, follow the next steps of this section to install your own compiled <code>cabal-install</code> from Hackage. For this purpose we are going to use the tool <a rel="nofollow"  href="https://haskellstack.org/">Stack</a> that will help us fetching all the dependencies required and building your own <code>cabal-install</code>.
</p>
<p>First you have to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/stack-bin/">stack-bin</a></span><sup><small>AUR</small></sup> because you'll use it to bootstrap the compilation of your own Cabal and you don't want to pull as dependencies those packages from the official TOS repositories containing the <code>haskell-*</code> dynamic libraries.
</p>
<p>Then prepare Stack downloading the package index. Stack will be used with the only purpose of bootstrapping the compilation of your own <code>cabal-install</code> but using the already installed <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span> compiler:
</p>
<pre>$ stack setup --system-ghc
</pre>
<p>Now install your own <code>cabal-install</code>:
</p>
<pre>$ stack install --system-ghc cabal-install
</pre>
<p>This newly installed <code>cabal-install</code> has been compiled without shared libraries and won't use them when building packages by default. Also, this <code>cabal-install</code> will use the installed <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span> compiler.
</p>
<p>Alternatively, you can also use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/ghcup-git/">ghcup-git</a></span><sup><small>AUR</small></sup> to install an already compiled <code>cabal-install</code> binary and even a specific version of <code>ghc</code> compiler. See the <a rel="nofollow"  href="https://gitlab.haskell.org/haskell/ghcup#usage">usage section</a> to see the steps to follow.
</p>
<h3><span class="mw-headline" id="Haskell_development_tools">Haskell development tools</span></h3>
<p>To start developing in Haskell easily, one option is the <a rel="nofollow"  href="http://www.haskell.org/platform/">haskell-platform</a> bundle which is described as:
</p>
<dl><dd><i>The easiest way to get started with programming Haskell. It comes with all you need to get up and running. Think of it as "Haskell: batteries included".</i></dd></dl>
<p>The Haskell Platform can be advantageously replaced by <a href="/Usage/Configuration/H/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">installing</a> the <a rel="nofollow"  href="https://bbs.archlinux.org/viewtopic.php?pid=1151382#p1151382">following packages</a> from the <a href="/Usage/Configuration/O/Official_repositories.html" title="Official repositories">official repositories</a>:
</p>
<ul>
<li>ghc (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc">ghc</a></span>) — Compiler, which only comes with dynamic <a rel="nofollow"  href="https://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries">boot libraries</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc-libs">ghc-libs</a></span>).  Static boot libraries (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=ghc-static">ghc-static</a></span>) must be separately installed.</li>
<li>cabal-install (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-install">cabal-install</a></span>) — A build tool focused on dependency resolution and sources packages from Hackage</li>
<li>stack (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=stack">stack</a></span>) — A build tool focused on curated snapshots and sources packages from Stackage</li>
<li>haddock (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=haskell-haddock-library">haskell-haddock-library</a></span>) — Tools for generating documentation</li>
<li>alex (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=alex">alex</a></span>) — Lexical analyzer generator</li>
<li>happy (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=happy">happy</a></span>) — Parser generator</li>
</ul>
<p>Alternatively, you can use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=stack">stack</a></span> to manage your Haskell environment by following the <a rel="nofollow"  href="https://docs.haskellstack.org/wiki/stable/install_and_upgrade/#arch-linux">TOS Linux install instructions</a>.
</p>
<h2><span class="mw-headline" id="Managing_Haskell_packages">Managing Haskell packages</span></h2>
<p>Many Haskell libraries and executables are grouped in packages. They are all available on <a rel="nofollow"  href="http://hackage.haskell.org">Hackage</a>, and a subset of them is curated on <a rel="nofollow"  href="https://www.stackage.org">Stackage</a>. To install and manage these packages, several methods are available:
</p>
<ul>
<li><a href="/Usage/Configuration/O/Official_repositories.html" title="Official repositories">Official repositories</a></li>
<li><a href="#cabal-install">cabal-install</a></li>
<li><a href="#Stack">stack</a></li>
<li><a href="/Usage/Configuration/T/TOS_User_Repository.html" title="TOS User Repository">TOS User Repository</a></li>
</ul>
<p>See <a href="/Usage/Configuration/H/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell package guidelines</a> for more information on <i>creating new</i> Haskell packages.
</p>
<h3>
<span id="Pros.2FCons_of_the_different_methods"></span><span class="mw-headline" id="Pros/Cons_of_the_different_methods">Pros/Cons of the different methods</span>
</h3>
<p>The following table documents the advantages and disadvantages of different package management styles.
</p>
<table >
<tbody>
<tr>
<th>
<b>Method</b>
</th>
<th>
<b>Pros</b>
</th>
<th>
<b>Cons</b>
</th>
</tr>
<tr>
<td><a href="/Usage/Configuration/O/Official_repositories.html" title="Official repositories">Official repositories</a></td>
<td>Provided by TOSLinux developers, consistent versions of packages, already compiled</td>
<td>Only a few packages available, only dynamic libraries available
</td>
</tr>
<tr>
<td><a href="#cabal-install">cabal-install</a></td>
<td>All packages available, root not required</td>
<td>Installed in home directory, <a rel="nofollow"  href="http://www.haskell.org/haskellwiki/Cabal/Survival#What_is_the_difficulty_caused_by_Cabal-install.3F">failures in dependency resolution</a>, difficult to remove specific packages
</td>
</tr>
<tr>
<td><a href="#Stack">stack</a></td>
<td>All packages available (favors Stackage), root not required</td>
<td>Installed in home directory, versions are pinned to snapshot, difficult to remove specific packages
</td>
</tr>
<tr>
<td><a href="/Usage/Configuration/T/TOS_User_Repository.html" title="TOS User Repository">TOS User Repository</a></td>
<td>Simple to get started</td>
<td>Risk of unmaintained or orphaned packages, incompatible versions of packages possible
</td>
</tr>
</tbody>
</table>
<h3><span class="mw-headline" id="cabal-install">cabal-install</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=cabal-install">cabal-install</a></span> is available from the <a href="/Usage/Configuration/O/Official_repositories.html" title="Official repositories">official repositories</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>cabal-install</code> is the package that contains the "cabal" command-line utility, whereas <code>Cabal</code> is the package that provides the "Cabal" library, used by both cabal-install and stack.</div>
<h4>
<span id="Preparation_and_.24PATH"></span><span class="mw-headline" id="Preparation_and_$PATH">Preparation and $PATH</span>
</h4>
<p>To run user-wide executables installed by cabal-install, <code>~/.cabal/bin</code> must be added to the <code>$PATH</code> variable. That can be done by putting the following line in your shell configuration file, for instance <code>~/.bashrc</code> for <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=bash">bash</a></span> or <code>~/.zshrc</code> for <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=zsh">zsh</a></span>:
</p>
<pre>PATH=$PATH:~/.cabal/bin</pre>
<h4><span class="mw-headline" id="Installing_packages_user-wide">Installing packages user-wide</span></h4>
<pre>$ cabal update

$ # Dynamic linking
$ cabal install --disable-library-vanilla --enable-shared --enable-executable-dynamic <i>&lt;pkg&gt;</i>

$ # Static linking (requires ghc-static and ghc-pristine)
$ cabal install --with-compiler=/usr/share/ghc-pristine/bin/ghc <i>&lt;pkg&gt;</i></pre>
<p>It is possible to install a package system-wide with the <code>--global</code> flag, but this is <b>strongly discouraged</b>. With the user-wide install, all files are kept in <code>~/.cabal</code> and libraries are registered to <code>~/.ghc</code>, offering the possibility to do a clean-up easily by simply removing these folders. With system-wide install, the files will be dispersed in the file system and difficult to manage.
</p>
<h4><span class="mw-headline" id="Sandboxes">Sandboxes</span></h4>
<p>Cabal sandboxes provide a <i>consistent</i> local package database and environment (similar to virtual-env in Python or rvm in Ruby).  To create a sandbox in the current directory, run:
</p>
<pre>cabal sandbox init</pre>
<p>
It can be later removed using </p>
<pre>cabal sandbox delete</pre>
<p>By default, if the current directory contains a sandbox, cabal will take advantage of it for installation, so you can follow the same steps as <a href="#Installing_packages_user-wide">#Installing packages user-wide</a>.  If you want to use a sandbox elsewhere, you can – while the current directory contains the sandbox – run <code>cabal exec "$SHELL"</code> to start a sandbox-aware shell.  Then you can change the directory to wherever you want, and cabal will still use the sandbox.  Alternatively, you can pass the <code>--sandbox-config-file=<i>/somewhere</i>/cabal.sandbox.config</code> flag to cabal.
</p>
<p>
To run executables within a cabal sandbox, you must also set </p>
<pre>PATH=$PATH:$PWD/.cabal-sandbox/bin</pre>
<p> or start a local shell with <code>cabal exec "$SHELL"</code>.
</p>
<h4><span class="mw-headline" id="Removing_packages">Removing packages</span></h4>
<p>There is no easy way to do it. Cabal does not have support for this functionality.
</p>
<p>Consider installing to a sandbox instead, which can be deleted without affecting other sandboxes or your user-wide installation.
</p>
<p>One thing to make your life easier is use zsh auto completion to find all the Haskell packages.
</p>
<p>If you want/can fix/reinstall whole user-wide Haskell package system - remove <code>~/.cabal</code> and <code>~/.ghc</code> and start from scratch.  This is often necessary when GHC is upgraded.
</p>
<h3><span class="mw-headline" id="Stack">Stack</span></h3>
<p><a rel="nofollow"  href="https://haskellstack.org">Stack</a> is a build tool that focuses on automatically curated, consistent package sets rather than dependency resolution.  This means it's easy to install a set of packages without concern of version conflicts as long as they coexist within a given Stackage snapshot.  It can be installed through either <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://www.archlinux.org/packages/?name=stack">stack</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/stack-static/">stack-static</a></span><sup><small>AUR</small></sup> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow"  href="https://aur.archlinux.org/packages/stack-bin/">stack-bin</a></span><sup><small>AUR</small></sup>.  The latter provides statically linked binaries, thereby avoiding dozens of <code>haskell-*</code> dependencies.  More information can be found at <a rel="nofollow"  href="https://docs.haskellstack.org/wiki/stable/install_and_upgrade/#arch-linux">§ Install/upgrade # TOS Linux</a>.
</p>
<h4>
<span id="Avoiding_.7E.2F.stack_bloat_by_dynamic_linking"></span><span class="mw-headline" id="Avoiding_~/.stack_bloat_by_dynamic_linking">Avoiding ~/.stack bloat by dynamic linking</span>
</h4>
<p>In default config, <code>stack</code> trades disk space off for build stability. One can easily get <code>~/.stack</code> in <b>tens of GiB</b> — because stack will download multiple GHC versions, snapshots and whatnot, and <a rel="nofollow"  href="https://www.reddit.com/r/haskell/comments/d0vqig/are_all_the_ghctinfo_versions_necessary/">will never clean up</a> anything.
</p>
<p>The GHC version bloat can be mitigated by this snippet in <code>~/.stack/config.yaml</code>:
</p>
<pre># stop downloading GHCs into ~/.stack
install-ghc: false

# allow stack to pick the system ghc (false by default)
system-ghc: true

# allow e.g. GHC 8.8.3 from TOS with Stack Snapshot 8.8.2
compiler-check: newer-minor

# fix "there are files missing" ghc compile errors
ghc-options:
    "$everything": -dynamic

# Ref: <a rel="nofollow"  href="https://docs.haskellstack.org/wiki/stable/yaml_configuration/#system-ghc">https://docs.haskellstack.org/wiki/stable/yaml_configuration/#system-ghc</a>
</pre>
<p><code>stack path --compiler-exe</code> can be used to test whether stack picks <code>/usr/bin/ghc-n.n.n</code> (i.e. the config works) or something else.
</p>
<p>With this config, <a rel="nofollow"  href="https://github.com/haskell/haskell-ide-engine/#installation">installing haskell-ide-engine</a> from source will produce "mere" 1.9 GiB <code>~/.stack</code>. You cannot wipe it now; as <code>ldd $(which hie)</code> shows, roughly half of the 250 libs that <code>~/.local/bin/hie</code> links to come from <code>~/.stack/snapshots</code>.
</p>
<p>Using dynamic linking will be easier on your disk and RAM (by sharing pages between multiple running haskell programs), and will free you from troubleshooting cross-ghc mixing errors. But it has its own disadvantage: <b>all tools you install from source will break</b> on every update of <code>ghc</code>, <code>haskell-*</code> Pacman packages. You'll see <code>libHS... =&gt; not found</code> in <code>ldd</code> output in this cases; or when running broken binary, the usual <code>error while loading shared libraries: libHSfoobar-...-ghc8.8.3.so: cannot open shared object file: No such file or directory</code> error. To fix this, just rebuild and reinstall the broken tool (to relink it to newer libraries).
</p>
<p>Arguably, this "disadvantage" is a feature when updating often: it provides a clear, trivial to diagnose, failure path, when dependencies move away from under dependees. Compare to static linking: tools you built will continue containing stale dependency code, and appear to continue to work — except sometimes, will break, in chaotic and unpredictable ways.
</p>
<h3><span class="mw-headline" id="ghcup">ghcup</span></h3>
<p><a rel="nofollow"  href="https://gitlab.haskell.org/haskell/ghcup">ghcup</a> makes it easy to install specific versions of ghc and can also bootstrap a fresh Haskell developer environment from scratch. It follows the UNIX philosophy of do one thing and do it well. Similar in scope to rustup, pyenv and jenv.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow"  href="http://learnyouahaskell.com/">Learn You a Haskell for Great Good!</a></li>
<li><a rel="nofollow"  href="http://book.realworldhaskell.org/">Real World Haskell</a></li>
</ul>
</div></div>
		
		<div id="catlinks"  data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="/Usage/Configuration/C/Category:Programming_languages.html" title="Category:Programming languages">Programming languages</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/Usage/Configuration/C/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="/Usage/Configuration/C/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
		<div ></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Haskell&amp;oldid=613581">https://wiki.archlinux.org/index.php?title=Haskell&amp;oldid=613581</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 16 May 2020, at 17:53.</li>
								<li id="footer-info-copyright">Content is available under <a  rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="/Usage/Configuration/T/TOS Wiki:Privacy_policy.html" title="TOS Wiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="/Usage/Configuration/T/TOS Wiki:About.html" title="TOS Wiki:About">About TOS Wiki</a></li>
								<li id="footer-places-disclaimer"><a href="/Usage/Configuration/T/TOS Wiki:General_disclaimer.html" title="TOS Wiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" >
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		



